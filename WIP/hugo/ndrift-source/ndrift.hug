! Necrotic Drift
! Robb Sherwin
! January 27th, 2002

! Game Starts January 4th, 2015 (Friday)

$MAXDICT=2048
#version 3.0

				
! Character List
! 1 Jarret Duffy			Lex Gray
! 2 Barnaby Gibs			Steve Oelheim
! 3 Audrey Case				Jamie Byrnes
! 4 Brian Pang				Matthew Davis
! 5 Chet Criswell			Michael Sherwin
! 6 Tericho Briggins			Chris Monahan
! 7 Adrian Bates			Joe Mason 
! 8 Trotskie				Jonathan Blask
! 9 The Zombiebot			Jeff Kyle
!10 Sydney Drieden			Tammy Bancroft
!11 Casey				Jill Leckie
!12 Randolph				Ben Parrish
!13 Skeleton
!14 Ghoul				Mike Sherwin
!15 Shadow				Gerrit Hamilton
!16 Ghast				Ben Parrish
!17 Mummy				Michael Sherwin
!18 Spectre				Bryan Sailer
!19 Vision
!20 Poltergeist
!21 Vampire				Laura Randall
!22 Mallcop Zombie (Zombie2)		Gerrit Hamilton
!23 Leary				Bryan Sailer
!24 Wraith
!25 Lum the Mad				Scott Jennings
!26 Zombiebot2				Jeff Kyle
!27 Revenant				Adam Parcells

!\
Get the jewelrystore01 thing not the big version at work PC

4. Make it so that a banshee appears, and that the nurse is on the other side and that the nurse can be pulped by the banshee's scream
test this: can't "read manual" for the manuals in game store




/***************
! Remember to remove this!!

"No hero available!\n"
"SYSTEM ERROR 3665!\n"


! These line, of course, has to go -- it's only here for testing. 
!if RubbleState[5] = 0
!{
!	RubbleState[5] = 4 
!}
! These line, of course, has to go -- it's only here for testing. 

Correct version number and Hugo number for the graphic for version

****************/

\!


!----------------------------------------------------------------------------

#set VERBSTUBS                          ! include verb stub routines
!#set USE_VEHICLES                       ! from OBJLIB.H
#set USE_ATTACHABLES                    !
#set USE_PLURAL_OBJECTS
$MAXROUTINES=512
!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

constant NUMCHARACTERS	40

array 	GameEvents[100] = 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
			 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 \
			 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
			 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

constant NUMQUIPSKILLER 20

global  QuipsKiller_Timer = 0 
array	QuipsKiller_Char[1] = 0
array	QuipsKiller_Quip[1] = 0
array	QuipsKiller_Set[1]  = 0


! Use this array for non-graphical game states 
!GameEvents[1] = the XYZZY thing 
!GameEvents[2] = the Plugh thing 
!GameEvents[3] = 0 if Audrey can be let into the Living_Room, 1 if not 
!GameEvents[4] = 0 if Gibs quip #1 wasn't taken, 1 if so 
!GameEvents[5] = 1 when Duffy can leave the Emporium
!GameEvents[6] = 1 when the computer was fixed / ghost daemon starts 
!GameEvents[7] = Sydney's state (for descript) 
!GameEvents[8] = 1 originally. 2 when skeleton arrives. 3 when skeleton is defeated. 
!GameEvents[9] = For when Gibs says his bit about the Sporting Goods Store gate being locked 
!GameEvents[10] = 1 after the door is attempted to be opened, 2 after the zombie2 is dead
!GameEvents[11] = 1 when the Zombie2 is dead 
!GameEvents[12] = To stop Audrey from saying the same thing after the boys find Trott
!GameEvents[13] = 1 if Duffy has told Audrey about the mallcop that got turned into a zombie
!GameEvents[14] = Duffy's face shot
!GameEvents[15] = Audrey's line when Duffy_Bedroom is entered with her in it 
!GameEvents[16] = 0 when Duffy can't leave the house, 1 when he can 
!GameEvents[17] = 0 when Trott's 8,11 quip isn't active (for getting the door unlocked)
!GameEvents[18] = controls whether the first zombie gets back up and attacks
!GameEvents[19] = Whether the Zombiebot has attacked the Neon or not 
!GameEvents[20] = Whether Gibs should tell Duffy to ask Trott to raise the gate in Corridor2
!GameEvents[21] = Whether the Activate(Ghoul_Appears) routine has started or not 
!GameEvents[22] = Whether Duffy has left Mallstore2 to the south 
!GameEvents[23] = Whether Audrey has pointed out the Wraith
!GameEvents[24] = Used for the Cold_Counter1 daemon 
!GameEvents[25] = Used to determine whether or not the shadow can appear
!GameEvents[26] = Whether the comb has been grabbed. (2 when the shadow scene completes) 
!GameEvents[27] = Whether the wraith is dead or not 
!GameEvents[28] = Ensure that the Zombiebot's main apres-vie stuff gets run only once 
!GameEvents[29] = Counter for the flip-rack (different pictures)
!GameEvents[30] = Whether the player has seen all the flip-rack contents
!GameEvents[31] = Which Level the Elevator is on, 1 or 2 
!GameEvents[32] = Used to determine if Audrey is in the Living Room due to the Movie Night Script or the Audrey Leaves script 
!GameEvents[33] = 3 if Poltergeist's presence is deduced
!GameEvents[34] = 1 if the ghast has knocked out Barnaby 
!GameEvents[35] = 1 if Duffy defeated the ghast by jumping into the fountain 
!GameEvents[36] = 1 if Duffy has caused the Poltergeist to stop throwing things at him
!GameEvents[37] = 0 for Casey's first pic, 1 for when she's been bitten 
!GameEvents[38] = Determines if the group can leave the mall or not 
!GameEvents[39] = 1 if it's too late for Casey
!GameEvents[40] = Audrey's Kiss variable
!GameEvents[41] = Audrey's Picture variable 
!GameEvents[42] = Random check for the summoning ritual 
!GameEvents[43] = Whether or not to have Gibs mention getting the rifles
!GameEvents[44] = Use this to have Gibs say it's not the right way 
!GameEvents[45] = Set to 1 when "the plan" has been established to go get rifles 
!GameEvents[46] = Duffy shouts for Trott 
!GameEvents[47] = 0 when Duffy can't leave the Back Office Hall 3 just yet 
!GameEvents[48] = Whether or not Trott makes a comment on how the phone can be used 
!GameEvents[49] = Whether ot not to activate the 3,36 quip
!GameEvents[50] = 0 when it's OK for the Zombie2 to emerge from behind the plant 
!GameEvents[51] = 1 for when Criswell and Pang can be hit 
!GameEvents[52] = for the DoVote routine
!GameEvents[53] = This keeps track of whether or not voting can happen in the Living Room 
!GameEvents[54] = To turn off the RubbleState checking 
!GameEvents[55] = So Duffy doesn't mention the garlic thing twice 
!GameEvents[56] = Ensure that the mummy is only raised once 
!GameEvents[57] = After the first vision appears, it's now OK to summon the wraith 
!GameEvents[58] = Don't want the shadow to appear after the wraith appears
!GameEvents[59] = Whether Gibs can be asked how close he is to finishing
!GameEvents[60] = Whether the player knows that Criswell is at the neighbor's house or not 
!GameEvents[61] = 1 if the player awoke the mummy by kicking or hitting the coffin
!GameEvents[62] = 1 after Audrey has exclaimed that Duffy has rot
!GameEvents[63] = Chance of Screech daemon
!GameEvents[64] = If Casey has called Duffy a pussy or not regarding the ghoul
!GameEvents[65] = If the ghast does not follow Duffy, but he wants to talk about it with Audrey
!GameEvents[66] = Stops the same thing from being printed when all the movies are looked at
!GameEvents[67] = To make sure that the out command works right in the Living Room
!GameEvents[68] = To make sure that the pentagram object has the right switch
!GameEvents[69] = For the Skeleton's picture
!GameEvents[70] = For Criswell's other description
!GameEvents[71] = For handing 3,25,1 for Audrey
!GameEvents[72] = For not letting the player back into the rest of the Mall
!GameEvents[73] = For Trott's picture
!GameEvents[74] = For Barnaby's picture
!GameEvents[75] = For Zombie's picture 
!GameEvents[76] = For Audrey's conversation piece in the store
!GameEvents[77] = For Audrey's cold iron conversation 
!GameEvents[78] = For talking to the mummy

! Use this array for the majority of graphic display variables
array 	LocationState[40] = 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

!LocationState[1] = Academy_Videos Graphic Switch
!LocationState[2] = Living_Room
!LocationState[3] = Bead Store
!LocationState[4] = Duffy's Bedroom
!LocationState[5] = Jewelry Store
!LocationState[5] = Food_Court1
!LocationState[6] = Food_Court2
!LocationState[7] = Corridor3
!LocationState[8] = Back Office Hall 3
!LocationState[9] = Nutrition_Store2
!LocationState[10]= Nutrition_Basement4
!LocationState[11]= Choad's Sporting Goods Store
!LocationState[12]= Corridor1
!LocationState[12]= Corridor2  NOTE: they can use the same one 
!LocationState[13]= Security Room 
!LocationState[14]= Mallcop Lounge
!LocationState[15]= Novel Shop
!LocationState[16]= Corridor6 (Fountain)
!LocationState[17]= Food_Court1 Graphic Delimiter
!LocationState[18]= Food_Court2 Graphic Delimiter
!LocationState[19]= Mall_Exit
!LocationState[20]= EpilogueStore


array	RubbleState[10] = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

!RubbleState[1] = 1 for when the posters have been flipped through all the way
!RubbleState[2] = 1 when the book (aged_text) is taken
!RubbleState[3] = 1 when the candle is taken
!RubbleState[4] = 1 when the urn is taken 


array	EndState[10] = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
!EndState[1] = 1 for when the book has been read
!EndState[2] = 1 for when the ghast or ghast head has drunk from the urn
!EndState[3] = 1 for when the candle has been lit 


array ExclaimArray[50] = 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50
array ShoutArray[30]   = 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30

array 	qflag[400]			! Arrays / 8
array 	quips[NUMCHARACTERS] = 0, 0, 70, 70, 10, 10, 10, 10, 30 ,10, 10, 30, 40, 0, 0, 0, 0, 0, 10, 0, 0, 30, 0, 0, 10, 10, 10, 10, 30, 30
array 	tempquip[1] = 0
global 	selected


array Kaos[NUMCHARACTERS] = 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
array HeroesPresent[NUMCHARACTERS]  = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
array VillainsPresent[NUMCHARACTERS]  = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
array AttackLoop[NUMCHARACTERS] = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
array MessageLoop[NUMCHARACTERS]  = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
array EnemyLoop[NUMCHARACTERS]    = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
array FollowingArray[NUMCHARACTERS] = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

CONSTANT SCORE_OPTIONS 60
array ScoreArray[SCORE_OPTIONS] = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
				  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  



! 1: Get movie from rack			1
! 2: Get the nailgun				6
! 3: Entering Main Street			5
! 4: Criswell's 6& 7 quips			5
! 5: Fix the computer				12
! 6: Defeat the skeleton			10	
! 7: Mall zombie dies				15
! 8: Security Room entered			5
! 9: Kill the ghoul				15
!10: Get the perfume				10
!11: Toss perfume off ledge			30
!12: Kill the ghast				31
!13: Get the shades				5
!14: Get the urn				40
!15: Menorah / White Candle			40
!16: Aged text					40
!17: Flip Rack 1				8
!18: Flip Rack 2				8
!19: Flip Rack 4				8
!20: Flip Rack 5				8
!21: Flip Rack 6				8
!22: Flip Rack 7				8
!23: Wraith dies				25
!24: Vampire dies				30
!25: Shadow dies				8
!26: Mummy dies					55
!27: Entering the Sydney Returns function (essentially -- candle has been lit)	5
!28: Getting the blood bag							30
!29: Casey_Lives								10
!30: Switch_Chapter(2) (essentially: driving away)				5
!31: Entering Parking_Lot							10
!32: Jarret just read from the book (CharExclaim 11 for Audrey)			10
!33: After water has been drank							10
!34: After Poltergeist has been defeated (GameEvents[36] = 1)			20
!35: Entering NutritionStore for first time					5
!36: Entering NutritionStoreBasement for the first time				5
!37: Garlic									15
!38: Give bloodbag to Spectre							30	
!39: Zombiebot defeated								5
!40: Get the comb								5

!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

! Verb Definitions
verb "switch_chapter_2"
	*						DoSwitchChapter2

verb "switch_chapter_3"
	*						DoSwitchChapter3

verb "switch_chapter_4"
	*						DoSwitchChapter4

verb "switch_chapter_5"
	*						DoSwitchChapter5

verb "about"
	*						DoAbout

verb "answer"
	*						DoVague
	* answerable					DoAnswer

verb "ask" "tell"
	*						DoAsk
	* object "about" xobject			DoAsk 
	* living "about" object				DoAsk
	* living "about" xobject			DoASk

verb "activate"
	*						DoVague
	* object					DoActivate


verb "apply" "smear" "bedaub" "coat" "cover" "dab" "overlay" "rub" "slop" "spread" "tarnish" "smudge" "spatter"
	*						DoVague
	* object					DoVague
	* object "onto" xobject				DoApply
	* object "on" xobject				DoApply
	* object "over" xobject				DoApply
	* object "to" xobject				DoApply

verb "blow"
	*						DoVague
	* "in" object					DoBlow
	* "through" object				DoBlow
	* "into" object					DoBlow
	* "with" object					DoBlow
	* "chunk"					DoVomit
	* "chunks"					DoVomit

verb "break", "pop"
	*						DoVague
	* object					DoBreak
	* "with" xobject				DoBreak 

verb "buy"
	*						DoVague
	* object					DoBuy

xverb "credits"
	*						DoCredits

verb "diagnose" "health" "status"
	*						DoDiagnose

verb "drive"
	*						DoDriveVague
	* object					DoDrive
	* "over" object					DoSmear
	* "through" object				DoSmear
	* "away"					DoDrive

verb "exits"
	*						YouCanGo

verb "feed"
	*						DoVague
	* object					DoFeed

verb "fix" 
	*						DoVague
	* object					DoFix

verb "fuck"
	*						DoVague 
	* living					DoFuck
	

verb "have"
	*						DoVague
	* "sex" "with" living				DoFuck

verb "hide" "skulk"
	* 						DoHide
	* "in" object					DoHide
	* "under" object				DoHide

verb "hint"
	*						DoHint

verb "hang"
	*						DoVague
	* "up" object					DoHang
	* object					DoHang


verb "identify"
	*						DoVague
	* object					DoIdentify

verb "knock"
	*						DoVague
	* object					DoKnock
	* "on" object					DoKnock 
	* "on" "the" object				DoKnock
	* "on" door					DoKnock
	* "on" "the" door				DoKnock

verb "krips"
	*						DoKrips

verb "lean"
	* "on" object					DoLeanOn

verb "lick" "taste"
	*						DoVague
	* object					DoTaste

verb "lift" "raise"
	*						DoVague
	* object					DoLift

verb "logon" 
	*						DoVague
	* "to" object					DoLogon
	* object					DoLogon

verb "loosen"
	*						DoVague
	* object					DoLoosen

verb "lower"
	*						DoVague
	* object					DoLower

verb "make"
	*						DoVague
	* "love"					DoVague
	* "love" "to" living				DoFuck
	* "love" "with" living				DoFuck
	
verb "play"
	* "with" object
	* object					DoPlay

verb "plug"
	*						DoVague
	* object					DoVague
	* object "into" xobject				DoPlug
	* object "in" xobject				DoPlug
	* object "to" xobject				DoPlug

verb "plugh"
	*						DoPlugh

verb "polish" "clean"
	*						DoVague
	* object					DoPolish

verb "pour"
	*						DoVague 
	* object "onto" xobject				DoPour
	* object "on" xobject				DoPour
	* object "into" xobject 			DoPour
	* object "in" xobject				DoPour
	* object					DoPour


verb "read", "skim", "peruse"
	* 						DoVague
        * "from" readable                               DoRead
        * readable                                      DoRead

verb "rescue"
	*						DoVague
	* living					DoRescue

verb "run" 
	*						DoVague
	* "over" object					DoSmear
	* "through" object				DoSmear

verb "scan"
	*						DoVague
	* object					DoScan


verb "sell"
	*						DoVague
	* object "to" xobject				DoSell
	* "buick"					DoVomit
	* "buicks"					DoVomit

verb "shake"
	*						DoVague
	* "hands" "with" object				DoShake
	* object					DoShake

verb "shoot"
	*						DoVague
	* object					DoShoot
	* object "with" xobject				DoShoot 
	* "at" object "with" xobject			DoShoot 
	* object "anyway"				DoShoot

verb "smear"
	*						DoVague
	* object					DoSmear

verb "snip"
	*						DoVague
	* object					DoCut

verb "spit"
	*						DoVague
	* "off" ledgelike				DoSpitOffLedge
	* "over" ledgelike				DoSpitOffLedge
	* living					DoSpitLiving
	* "on" living					DoSpitLiving
	* "at" living					DoSpitLiving
	* object					DoSpit
	* "on" object					DoSpit
	* "at" object					DoSpit

verb "stand"
	*						DoVague
	* "in" object					DoEnter

verb "strangle"
	*						DoVague
	* object					DoVague
	* object "with" xobject				DoStrangle 

verb "spray"
	*						DoVague
	* object					DoSpray
	* object "at" xobject				DoSprayOn
	* object "on" living				DoSprayOn
	* living "with" object				DoSprayIndirect

verb "start"
	*						DoVague
	* object					DoSwitchOn

verb "swipe"
	*						DoVague
	* object					DoVague
	* object "with" xobject				DoSwipe

verb "technicolor"
	*						DoVague
	* "yawn"					DoVomit

verb "undress"
	*						DoVague
	* object					DoUndress	

verb "unplug"
	*						DoVague
	* object					DoPull
	* object "from" xobject				DoPull 


xverb "version", "ver"
	*						Version

verb "volume"
	*						Set_Volume


verb "vomit", "puke" 
	*						DoVomit

verb "vote"
	*						DoVote
	* "yes"						DoVoteYes
	* "no"						DoVoteNo

verb "wager", "gamble"
	*						DoWager


verb "wipe"
	*						DoVague
	* "off"	object					DoWipeOff

verb "watch"
	*						DoVague
	* object					DoWatch


verb "xyzzy"						
	*						DoXyzzy




!----------------------------------------------------------------------------
!----------------------------------------------------------------------------



#include "verblib.g"
#include "hugolib.h"                    ! standard library routines
#include "contain.h"			! Super Container 
#include "system.h"
#include "window.h"
#include "resource.h"
#include "routines.h"		 	! catch-all routines, basic stuff 
#include "cango.h"
#include "randmove.hug"
#include "acshelp.hug"           	! help system
#include "scenery.hug"           	! scenery for objects and locations...
#include "daemons.h"
#include "fight.hug"			! Fighting Routines 
#include "cscripts.hug"			! character scripts & so forth 



!----------------------------------------------------------------------------
!----------------------------------------------------------------------------



!Global Variables

global	Chapter = 1
global 	tempformat2
global	fight_active = 0
global	rank
global	wound_level

global	canshoot
global	global_gunused

global	inventory_status
global	placegfx


global MUSIC_OFF = FALSE
global SOUND_OFF = FALSE
global sound_volume = 60


global temp_obj_switch

!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

!Split Screen Variables

global current_resource_file
global current_resource

global	DEFAULT_TEXTCOLOR
global	DEFAULT_BGCOLOR


attribute pictured            	  	! i.e., visible in the graphic, so doesn't
					! have to be listed separately
global last_drawn_picture
global force_repaint
property graphic                	! two elements:  resourcefile and picture
property facepic
property opponentpic
property static_occupant       		! someone who's always there
property shooting_descript		! for something that is broken upon being shot at
global objects_detailed         	! for knowing if we have to re-update the
!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

!Attributes

attribute	hero
attribute 	neutral
attribute 	villain 
attribute 	announcing_arrival	! in order to get "silent" entrances 
attribute 	following 
attribute 	breakable 		! Can be destroyed 
attribute	melee_breakable
attribute 	datamedia		! This is "data", like a CD, and should have a data_desc associated with the object 
attribute 	gun
attribute	valuable
attribute	broken 
attribute	talkable		! Used for talking to non-living things 

attribute 	paralyzed
attribute	ledgelike		! Designed to help parser with "drop x off ledge" 
attribute	statuelike
attribute	automobile
attribute	perfumed		! For people who have been perfumed
attribute	candle_type

attribute	melee_weapon
attribute	throwable
attribute	thrown			! Temp flag that denotes a thrown object for one round 
attribute	do_not_drop_off_rail	! Used for objects that are needed before the ledge is dealt with
attribute	mummylike
attribute	rotting
attribute	answerable		! For the door in the Living Room
attribute	bitten			! For Casey
attribute	quiet_bcast
!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

!Strength Table

! 1	Blunt Weapon
! 2	Head Shot Capable 
! 3	Piercing Weapon 
! 4	Silver Weapons 
! 5     Crushing Weapon 
! 6	Holy Water

!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

!Properties

property npc_move		! Used in randmove.hug, which is used for the Spectre

property charnumber
property maxhitpoints
property hitpoints
property worth 
property activetarget 
property armorclass
property attackadjust
property damagepotential
property conscious
property peaceful 
property packing 
property street
property alley 
property ammo 
property real_object            	! i.e., "object" as to "distant_object"
!property real_object alias misc		! object remote_object is the remote twin of
property data_desc			! used for when CD-ROMs or DVD-ROMs play something with the data attribute
property weapon_dam_min
property weapon_dam_max
property strength			! used to determine strength and weakness tables
property weakness
property weight				! for encumberance
property amount_can_carry		! for a character's weight limit 

!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

!Constants

constant	RELEASE "1.03"
!----------------------------------------------------------------------------
!----------------------------------------------------------------------------


routine init
{

	window 0
	system(22)

	display.title_caption = "NECROTIC DRIFT 1.03 by Robb Sherwin"

	MAX_RANK = 10
	MAX_SCORE = 601
	ranking[0] = "Rank1"
	ranking[1] = "Rank1"
	ranking[2] = "Rank1"
	ranking[3] = "Rank1"
	ranking[4] = "Rank1"
	ranking[5] = "Rank1"
	ranking[6] = "Rank1"
	ranking[7] = "Rank1"
	ranking[8] = "Rank1"
	ranking[9] = "Rockbot"
	ranking[10] = "Rank1"

	counter 	= 1
	STATUSTYPE 	= 1			
	TEXTCOLOR 	= BRIGHT_WHITE
	BGCOLOR 	= BLACK
	SL_TEXTCOLOR    = BRIGHT_WHITE
	SL_BGCOLOR      = BLACK

	FORMAT 		= NOINDENT_F !+ LIST_F
!	AFTER_PERIOD 	= " "

	DEFAULT_FONT 	= PROP_ON
	Font(DEFAULT_FONT)

	prompt 		= ">"

	InitPluralObjects()

	color TEXTCOLOR, BGCOLOR

	verbosity = 2


	cls


	!PlayMusic(resourcefile, song, loop, force)

	if MUSIC_OFF = TRUE
	{
	}
	else
	{
		PlayMusic("ndmusic", "Pseudo_Band_-_Track_01", sound_volume, false, true)

	}

	picture "mall", "ndrift-title01"

	pause

	cls

	"My dad came home late one night when I was nine and threw an old copy of the \IMonster Manual\i by Gary Gygax onto
	my bed. He woke me up, stressed and shaking at the humiliation his friends had put him through earlier that evening.\n"

	"He asked me if I wanted the book. I was still groggy, but I picked it up and thumbed through it. \"We didn't play 
	Monopoly tonight, Jarret,\" he told me. \"That's because not a one of them can beat me. Instead, they brought out 
	this... thing. Some 'game of the imagination'.\" He practically spat that last word. \"You can move all you like 
	without throwing any dice, but to actually do anything, you need to throw a handful!!\" I was both reading 
	entries on the different monsters and paying half-attention to his rant. \"Five minutes in, Benson tells me that 
	I come across something called a gorgon. That got me stoned. Why would I play a game that depicted the recreational 
	use of marijuana cigarettes? I got up and left.\"\n"

	"\"They let you read this during play?\" I asked him. He nodded. I turned to page 49. \"I don't think they were 
	supposed to. It says right here that the gorgon can turn you \Bto\b stone. It doesn't \Iget\i you stoned. And right 
	here are all its weaknesses! How did you not see this? Are you stupid or something? Or what?\"\n"

	"My father snatched back the \IMonster Manual.\i He didn't state that what he was going to do was going to hurt him 
	more than it hurt me. (I think all he did say was that he should have left his 'patented Duffy blast' on my mother's face 
	the night I was conceived, which didn't make a whole lot of sense to me then.) He instead just quietly gave me a spanking for 
	back talk. But as that 112 page reference to a modern mythology of villainy struck my bony behind, it was as if he were bonding the pages
	and me for all time. Like directed osmosis through anger or something.\n"
	
	"(Okay, it actually wasn't like osmosis at all, but I've sacrificed knowledge in basic chemistry for additional 
	levels in Modern Mythology, so please cut me some slack on the occasional analogy outside of my experience.)\n"

	"In the week that followed, my father tried to ban Dungeons & Dragons from the house as he had previously 
	banned video games, cursing, Cajun food and music recorded after 1959. I stood up to him on D&D, though, and he caved for the 
	only time in my childhood. Within a week I was running my own games for the kids in my tract. We were creating 
	adventures together with Devils, Demons and Dragons and it was one of the best times of my life. My old man may 
	have never been on the short list for an award from the PTA, but his maniac antics did a better job helping me "; 
	"understand just what I was interested in than the fathers of anyone else I grew up with. And heck, he did 
	have my back that one time I met D&D creator Gary Gygax himself at DragonCon and started kicking him in his bag of magic beans (if
	you're digging my ditch here) in misplaced, latent vengeance due to how hard the board stock was for those manual 
	covers.\n"

	"I don't think you've truly bonded with your father until you've spent 36 consecutive 
	hours in a holding cell mocking and taunting an inmate set consisting of 
	multiple thirty-somethings decked out in homemade hobbit, fairie and chocobo costumes, where the only
	thing the lot of them had in common, aside from a complete lack of human dignity, was relating how difficult
	it was to sleep late when the sump pump went off.\n" 	


	pause

	cls

	picture "mall", "ndrift-title02"

	pause

	cls

	color TEXTCOLOR

	!Version

	set_screen()

!	PictureinText("mall", "version", 50, 10, true)
	Version
	
	"I'm here this evening at an Academy Videos store thirty-five minutes from my home with two of my roommates and my best friend.
	We have to come all the way down here to rent because of the late fees on my memberships at all the video places back in the Fort. 
	I wish I had a good story for why that is the case, but I don't. I'm just poor and had the first \ILord of the Rings\i movie overdue
	for more than two weeks at multiple video chains. I kept it around to mainly prove trivia. (It will probably end up costing me more to
	show my friends that the elf character Legolas was walking \Ion\i, and not \Iin\i the snow, than it did for director Peter Jackson to 
	implement that effect on-screen.)\n"

	"Supposedly, Audrey is dropping by tonight to watch a movie, which is why I'm even here to begin with. In the five years 
	we've been together we've dumped each other a total of nine times. She is currently ahead of me six to three. Her most shallow dumping was when 
	she wanted to exclusively hang around a hardcore goth guy who had somehow managed to finance or lease his own cemetery plot. That guy
	was the black fingernail Alpha male until he missed his first payment. To be fair, mine was when she filled out Student Loan paperwork for
	me without my knowledge or consent and almost enrolled me into classes at the nearby University of Central Hill. She doesn't like the
	fact that I work at the Funtime Teen Mall for $5.51 an hour at age 27.\n"

	"I have to work later tonight, so I guess I'd better pick something and get out of here quickly."

	player 		= Duffy
	location 	= Academy_Videos

 	old_location 	= Academy_Videos

 	move player to Academy_Videos
	move glasses to Player
	glasses is worn

 	FindLight(Academy_Videos)
	Reset_Quips()

	Activate(Academy_Daemon)

	Barnaby is following
	Pang is following
	Criswell is following

	addcontext 0 
	addcontext "Restore Game File"
	addcontext "Save Game File"
	addcontext "Script On"
	addcontext "Script Off"
	addcontext "-"
	addcontext "Music On"
	addcontext "Music Off"
	addcontext "Sound On"
	addcontext "Sound Off"
	addcontext "-"
	addcontext "Help Menu"
	addcontext "About"
	addcontext "Credits"
	addcontext "Hint"
	addcontext "Record"
	addcontext "Record Off"
	addcontext "Playback"
	addcontext "-"



	Activate(Checking_Followers)

	GameEvents[31] = 2		! Set the elevator to level 2
	

!	Anchor

!	Switch_Chapter(3)
!	Enter_Security

!\
!	move phone to duffy
	Goto_BeadStore()
	Switch_Chapter(4)
	Enter_Choad()
	Test_Ghast()
	Enter_Security()
	MovePlayer(Corridor8)
	move xbox1 to Player
	Enter_JewelryStore()
	Before_Elevator()
	Enter_Level_One()
	MovePlayer(MallStore2)
	MovePlayer(Poster_Store)
	Enter_Nutrition()
	Enter_FoodCourt1()


	move lacrosse_stick to Player
	move garlic to Player
	move aged_text to Player
	move urn to Player
	move candle to Player
	move ghast_head to Mall_Exit



!move xbox1 to Player
!switch_chapter(4)
!move lacrosse_stick to Duffy
\!
!	move bloodbag to Spectre
}

routine main
{
	PrintStatusLine
	Counter++

	canshoot = false

	run location.each_turn

	Runevents
	RunScripts()

	set_screen()

	if fight_active = 1
	{
		DoFightLoop()
	}

	if (Duffy.conscious = 0)
		{
			endflag = 2
		}

}

routine Version
{
	color LIGHT_BLUE
	print "\BNecrotic Drift\b"
	color TEXTCOLOR
	print "Interactive Fiction"
	print "Copyright (c) 2004. Written and programmed by Robb Sherwin"
	print "Release 1.03 / Serial number 040623 / Hugo 3.0\n"

}


room LightRoom
{
	is light


cant_go {
		YouCanGo(1)
	}
	
}


room LightRoom2
{
! Should be used when I do not want the YouCanGo(1) function to be called by default. 

	is light


}


character NPC
{
type NPC
is living
peaceful true
maxhitpoints 5
hitpoints 5 
activetarget 100 

	before
	{
		
		object DoLook
		{
		!UpdateFaceWindow(self)

		run self.long_desc
		if (self.conscious = 0) and (self is not female) and (self.hitpoints <= 0) and (self.hitpoints > -100)
		{
			"\n";
			CPronoun(self)
			" is currently knocked out."
		}

		if (self.conscious = 0) and (self is not female) and (self.hitpoints <= -100)
		{
			"\n";
			CPronoun(self)
			" is dead."
		}

		if (self.conscious = 0) and (self is female) and (self.hitpoints <= 0) and (self.hitpoints > -100)
			"\nShe is currently knocked out."

		if (self.conscious = 0) and (self is female) and (self.hitpoints <= -100)
			"\nShe is dead."

		}
		object DoWakeCharacter
		{
			if self.conscious = 1
			{
				"That's not necessary."
			}
			else
			{
				"I try, but I don't get any sort of response back into wakefulness."
			}
		}

		object DoKiss
		{
			"That's not appropriate."
		}
		object DoListen
		{
			"Nothing out of the ordinary."
		}

		object DoRescue
		{
			"Specific violence and conversation are usually the two best ways to go about a rescue, I've found."
		}

		xobject DoGive
		{
			if object is valuable and xobject is hero
			{
				"\"Thanks!\" says ";
				print xobject.name ;
				print "."

				move object to xobject
			}

			else
			{
				"My goodwill is ignored."
			}
		}

		object DoShake
		{
			if object is hero
			{
				"There's no real need to do that."
			}
			elseif object is neutral
			{
				"My intentions towards goodwill are ignored."
			}
			elseif object is villain
			{
				"It's too late for that."
			}
			else
			{
				"Nothing happens."
			}
		}

				

	}

in_scope 
	{ if self in location : return 1
          else : return 0
        }

conscious
	{ if self.hitpoints > 0 : return 1 
	  else : return 0 
	}

}

player_character Duffy "I"
{
charnumber 1
pronoun "I" "me" "my"
nouns "jarret" "duffy" "me" "self"
adjectives "jarret"
capacity 50
maxhitpoints 50
hitpoints 50
armorclass 7
attackadjust 0
damagepotential 4

!amount_can_carry 50

peaceful true
is hero, living

	long_desc
	{
		if Chapter = 5
		{
			"I'm Jarret Duffy, assistant manager at Benji's Old Time Curiosity Shoppe, I'm 5'9\" tall and weigh 153 lbs. I have
			hazel eyes and a rusty mop of hair atop my head."
		}
		else
		{
			"I'm Jarret Duffy, assistant manager of Benji's Gaming and Role-Playing Emporium, at the Funtime Teen Mall. I am
			5'9\" and 155 lbs. I have hazel eyes and a rusty mop of hair atop my head."
		}
	}

	before
	{
		actor
		{
			if parent(object).type = SuperContainer
			{
				if Inlist(parent(object), contents_in, object) and
					parent(object) is not open
				{
					print capital player.pronoun #1;
					MatchPlural(player, "doesn't", "don't")
					" see that."
					return true
				}
			}
			return false
		}
	}

	facepic
	{
		
		select(GameEvents[14])
		case 0,1
			{
				! Smiling; First Pic
				current_resource_file = "mall"
				current_resource = "duffy02"
			}

		case 2
			{
				! Serious #1, default
				current_resource_file = "mall"
				current_resource = "duffy02"
			}
		case 3
			{
				! Serious #2, more temporary 
				current_resource_file = "mall"
				current_resource = "duffy03"
			}

		case 4
			{
				! Confusion
				current_resource_file = "mall"
				current_resource = "duffy05"
			}

		case 5
			{
				! Oncoming Horror due to the wraith
				current_resource_file = "mall"
				current_resource = "duffy_wraith01"
			}

		case 6
			{
				! End Game
				current_resource_file = "mall"
				current_resource = "duffy06"
			}


		case 7
			{
				! Aw shucks (makeup with Audrey pic) 45
				current_resource_file = "mall"
				current_resource = "duffy07"
			}
		case 8
			{
				current_resource_file = "mall"
				current_resource = "duffy08"
			}

		return -1
	}

	conscious
	{ 	
		if self.hitpoints > 0 : return 1 
		else : return 0 
	}
}

LightRoom2 Academy_Videos "Academy Videos"
{
	noun "store"
	parse_rank 10 

	long_desc
	{
		if self is not special
		{
			self is special

			"The inside of the video store looks like it was slapped together in a weekend by enslaved, tool-wielding howler monkeys 
			and routinely cleaned by an anosmic with all the enthusiasm of a man who lost a bet. Rotting floorboards create a random topography that would put
			the landshifts and valleys of the legendary Umar Hills to shame. Faded posters cover much of the surface area of the
			walls, and a few of them have begun peeling or been stricken with graffiti.\n"

			"All the available movies have been shoved into racks labeled with one of four categories: Action, Drama, Fantasy 
			and Horror. Alphabetical order isn't implemented in any of them either, so trying to find a specific movie is often
			futile. It's usually best just to look along the racks and hope something good catches your eye."

			if GameEvents[28] = 1
			{
				"\nThere's an exit east to Main Street."
			}

			
		}
		else
		{
			"The inside of the video store looks like it was slapped together in a weekend by enslaved, tool-wielding howler monkeys 
			and routinely cleaned by an anosmic who lost a bet. Rotting floorboards create a random topography that would put
			the landshifts and valleys of the legendary Umar Hills to shame. Movie posters cover much of the surface area of the
			walls, and a few of them have begun peeling or been stricken with mild graffiti.\n"

			"There are four categories of racks here: Action, Drama, Fantasy and Horror."

			if GameEvents[28] = 1
			{
				"\nThere's an exit east to Main Street."
			}

		}


	}
	before
	{
		location YouCanGo
		{
			"There's an exit out through the door to the street."			
		}
	}
		
		graphic
	{
		select(LocationState[1])
			case 1
			{
				current_resource_file = "mall"
				current_resource = "academy_video01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "academy_video02"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "academy_video03"
			}

			case 4
			{
				current_resource_file = "mall"
				current_resource = "academy_video04"
			}

			case 5
			{
				current_resource_file = "mall"
				current_resource = "ender04"
			}

			case 6
			{
				current_resource_file = "mall"
				current_resource = "academy_video05"
			}

			case 7
			{
				current_resource_file = "mall"
				current_resource = "academy_video06"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "academy_video01"
			}

		return -1
	}

e_to 
	{
		return Academy_door
	}

out_to	{
		return Academy_door
	}

cant_go
	{
		"There's no path that way. There's an exit east, through the door, to Main Street. ";

		if Zombiebot not in location
		{
			"The clerk has barred the door as he doesn't want anyone else entering the store before he closes, though."
		}
		else
		{
			""
		}
	}
}


door Academy_Door "store door"
{
	nouns "door" "lot"
	adjectives "store" "outside" "parking" 
	article "the"
	between Academy_Videos Academy_Outside
	is openable, not open, lockable, not locked, not broken 

	long_desc
	{
		"It's a cheap, board door. ";

		if self is broken
		{
			"And a broken one, too."
		}
		else
		{
			""
		}
	}

	before
	{
		object DoOpen
		{
			if self is open
			{
				
				return 
			}
				
			if location = Academy_Outside
			{
				"It's so beat-up now I don't think I'd ever be able to open it."
			}
			else
			{
				if zombiebot not in location
				{
					"The clerk has barred it so that the flow of customers will cease. He'll open it when he wants us out."
				}
				else
				{
					"It's stuck!!"
				}
			}
		}
	
		object DoLock, DoUnlock
		{
			"I don't have any way to do that to the store door."
		}
	}
}


LightRoom2 Academy_Outside "Main Street"
{
	long_desc
	{
		ScoreArray[3] = 1

		if Zombiebot.conscious = 0
		{
			Academy_Door is not open
			Academy_Door is not openable
			Academy_Door is locked

			"The stench of the city of New Haz hits me like a cruel sucker-punch through the septum. It's a ringing,
			persistent odor. One of sewage mixed with old gasoline. I shift to breathing exclusively through my
			mouth. But fortunately we'll be out of here soon enough (and before the stink can settle on my clothes.)"

			if self is not visited
			{

			"\n\"What the \Ihell\i was that in there?\" asks Pang.\n"
			"\"Who knows?\" says Barnaby. \"Who cares? Let's just go. At least by putting down the homeless 
			guy inside he won't get grime nor slime over Duffy's windshield in some half-assed attempt 
			to clean it.\"\n"

			"\"I thought you knew that guy, Duffy,\" says Criswell, unhelpfully, as if that somehow explains 
			why he was cowering in the corner."
			}
		}

		else
		{
			Academy_Door is not open
			Academy_Door is not openable
			Academy_Door is locked

			if self is not visited
			{
				"We run outside and slam the door shut. Pang gives it an angled kick, 'locking' it the best 
				he can.\n"
				"\"What... what \Ithe hell\i was that?\" asks Pang. I don't have a decent answer for him. 
				I don't know, I don't have any idea.\n"
				"\"There are sometimes bots,\" starts Barnaby, before shutting up. \"Oh, Christ, let's just 
				get the hell out of here before it comes looking for us!\"\n"

				"The stench of New Haz suddenly hits us all like a cruel sucker-punch through the septum. 
				Individually (but within moments, in concert) we all gasp for fresher air. We need to get in 
				my car and get out of here quickly -- both before that \Ithing\i finishes up in the store, 
				and before the city's stink can settle in our clothes."
			}

			else
			{
				"We are outside the Video Store, in the parking lot. The stench of New Haz sits like a 
				repeating sucker-punch to the septum. It's a clear night at this point, with the moon
				hanging low in the sky.\n"

				"We need to get in my car and get out of here quickly -- both before the cops come round
				due to the encounter with that thing in the store, but also before the city's ripe stench
				can settle into our clothes."
			}


		}

		if GameEvents[18] = 0
		{
			GameEvents[18] = 1 
			Activate(Zombie_Gets_Back_Up)
		}

	}
	before
	{

		location YouCanGo
		{
			"Driving my car is the best way to get out of here."			
		}

		location DoSmear
		{
			if object ~= Zombiebot
			{
				"That's more crime than I feel good about committing."
			}
			else
			{
				if Player not in neon
				{
				"(Getting in the car, first...)\n"
				}

				Perform(&DoDrive,Neon)
			}
		}

		location DoDriveVague
		{
			if Player not in neon
			{
			"(Hopping in the car, first...)\n"
			}

			Perform(&DoDrive,Neon)
		}
	}

	graphic "mall", "academy_outside01"

w_to	{
		return Academy_door
	}

n_to
	{
		"The road is closed to the north."

		if self is not special
		{
		self is special

		"\n(This is because of a recent city-wide disaster up that way: the city smells like crap these days due to the sewage
		processing plant that was recently installed right downtown. There had already been plans to bring the Olympic
		Torch through New Haz and when the runner came through... well, you can see where I'm going with this. The 
		atmosphere around the city practically ignited. This road's been closed that while construction crews re-build.)"
		}
	}

}

LightRoom2 Living_Room "Living Room"
{
	prep " my"

	long_desc
	{
		if self is not visited
		{
			"I live in a four-bedroom rented house in a college town we all call 'The Fort.' The exterior to this place was
			kind of beat up when we decided to rent here, and through the last three years we've worked our hardest to
			make the interior nicely match.\n"

			"The other three guys who live here include Pang and Criswell and another guy named Leary who isn't around much. 
			(But then, he's an engineer and the only guy with his life remotely in order.) Criswell found most of our crummy
			furniture when he went Dumpster Diving a while back, and we place blankets over the rotting parts like they were
			giant cloth band-aids to hide their pronounced ghetto factor."

			if Pang in blue_couch
			{
				"\nSitting corpulently in the blue couch is Pang."
			}
		}
			
		else
		{
			"This room is centered around the television, a 32\" Sony that Leary brought when he moved in. The set sits
			on a wooden entertainment center, with 'satellite' speakers all around the room. The tattered white couch is
			perpendicular to the set, and the blue one (where Pang normally situates himself) is eight or nine feet 
			directly across from it."

			if Pang in blue_couch
			{
				"\nSitting corpulently in the blue couch is Pang."
			}

			if GameEvents[3] = 1
			{
				GameEvents[3] = 2 

				"\nI see Audrey for the first time. I probably should have gotten the door for her.\n"

				"\"Thanks for getting the door, jerk,\" she says. Ouch. This isn't good, I've managed
				to come off as irritating before she'd even entered the house. I usually have ten minutes
				of grace period.\n"

				"\"I was in the bathroom, brushing my hair so it would look nice and stylish for you,\" I say
				with a shrug.\n"

				"\"It's a brush. Not a magic wand. You know... I've never met a man who was so obsessed with 
				his hair. But anyway. What are we doing tonight?\""
			}
		}
	}
	before
	{
		location YouCanGo
		{
			"There is an exit north to my bedroom."
		}

		location DoVote
		{
			if GameEvents[53] = 1
			{
				DoVoteQuery()
			}
			else
			{
				"There's nothing to vote on, currently."
			}
		}
		location DoVoteYes
		{
			if GameEvents[53] = 1
			{
				DoVoteQuery(true)
			}
			else
			{
				"There's nothing to vote on, currently."
			}
		}
		location DoVoteNo
		{
			if GameEvents[53] = 1
			{
				DoVoteQuery(false)
			}
			else
			{
				"There's nothing to vote on, currently."
			}
		}
	}

	graphic {
		if LocationState[2] = 0 or LocationState[2] > 7
			{

			current_resource_file = "mall"
			current_resource = "tv_room01"

			}

			if LocationState[2] = 1
			{
			current_resource_file = "mall"
			current_resource = "tv_room02"
			}

			if LocationState[2] = 2
			{
			current_resource_file = "mall"
			current_resource = "movie_night_02"
			}

			if LocationState[2] = 3
			{
			current_resource_file = "mall"
			current_resource = "movie_night_03"
			}

			if LocationState[2] = 4
			{
			current_resource_file = "mall"
			current_resource = "movie_night_04"
			}

			if LocationState[2] = 5
			{
			current_resource_file = "mall"
			current_resource = "movie_night_05"
			}

			if LocationState[2] = 6
			{
			current_resource_file = "mall"
			current_resource = "movie_night_06"
			}

			if LocationState[2] = 7
			{
			current_resource_file = "mall"
			current_resource = "tv_room03"
			}

		return -1 
		}


cant_go {
		"I can't go that way. \n"
		"There is an exit north to my bedroom."
	}
n_to 
	{
		if Audrey in location
		{
			"I don't want to ignore Audrey by hanging out in my bedroom, and I can guarantee that she will not take
			the hint and start getting intimate with me if I just up and leave and go there."
		}
		else
		{
			return Bedroom_Door
		}
	}


out_to

	{
		if Audrey in location and GameEvents[67] = 0
		{
			"I don't want to ignore Audrey by hanging out in my bedroom, and I can guarantee that she will not take
			the hint and start getting intimate with me if I just up and leave and go there."
		}
		else
		{
			if GameEvents[16] = 1
			{
				return Porch_Door
			}
			else
			{
				return Bedroom_Door
			}
		}
	}

}


door Porch_Door "porch door"
{
	nouns "door" 
	adjectives "porch" "outside" "front"
	article "the"
	between Living_Room Front_Porch
	is openable, not open, lockable, not locked, answerable

	parse_rank 2

	before
	{

		object DoEnter
		{
			if GameEvents[16] =1 
			{
				"I shake my head at my horrible home life and leave for work...\n"

				Switch_Chapter(3)
			}
			else
			{
				"There's nothing for me out on the porch."
			}
		}

		object DoOpen, DoAnswer
		{
			if GameEvents[16] = 1 
			{

				"I shake my head at my horrible home life and leave for work...\n"

				Switch_Chapter(3)
			}

			elseif Audrey in Front_Porch
			{
				self is open

				if GameEvents[3] = 0
				{
					move Audrey to Living_Room

					"I let Audrey inside, and give her a kiss on the cheek.\n"
					"\"Hello, Jarret...\" she looks over and sees Pang on the couch. Distaste can't
					help but crawl across her face. \"So... what have we got planned for tonight?\"" 

					Porch_Door is not open
					!Porch_Door is not openable
					!Porch_Door is locked
					!Porch_Door is not lockable

					GameEvents[3] = 2 

					LocationState[2] = 1

					Deactivate(Audrey_Arrives)
					
					! Get rid of Pang's quips here
					SetQuip(4,2,0)
					SetQuip(4,3,0)
				}
				else
				{
					"Done."
				}

			}

			else
			{
				"There's nobody presently trying to get in the house!"
			}

		}
	
		object DoLock, DoUnlock
		{
		
			"We don't bother locking it. We live in the Fort, not a shitheap like New Haz or something."
		}
	}
}

LightRoom2 Duffy_Bedroom "Bedroom"
{
	prep " my"

	long_desc
	{
		"My bedroom's the smallest one in the house. (I got here last so I got the skankiest room.) There's
		not a whole lot going on in here, just some shelves with all my crap on it and a bed. It smells a
		bit less like cigarettes than it used to since I have gone a week and a half since my last one."

		if Audrey in location and GameEvents[15] = 0 
		{
			GameEvents[15] = 1 
			CharExclaim(Audrey,ExclaimArray[5])

			LocationState[4] = 3

			Bedroom_Door is not open
			Bedroom_Door is locked
			Bedroom_Door is not lockable 
			Bedroom_Door is not openable

			SetQuip(3,15,1) 
			SetQuip(3,16,1)
			SetQuip(3,17,1)

		}

		if Audrey in Living_Room
		{
			if GameEvents[32] = 0
			{
				"\nRather than ignore my girlfriend, I decide to head back to the Living Room."
			
				GameEvents[3] = 2 

				MovePlayer(Living_Room)
			}
		}
	}

	before
	{
		location YouCanGo
		{
			"There is an exit south to the Living Room."			
		}
	}
	graphic
	{
	
		select(LocationState[4])
			case 1
			{
				current_resource_file = "mall"
				current_resource = "duffy_bedroom01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "duffy_bedroom02"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "duffy_bedroom03"
			}

			case 4
			{
				current_resource_file = "mall"
				current_resource = "duffy_bedroom04"
			}

			case 5
			{
				current_resource_file = "mall"
				current_resource = "duffy_bedroom05"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "duffy_bedroom01"
			}

		return -1
	}

cant_go {
		"I can't go that way. \n"
		"There is an exit south to the Living Room."
	}


s_to 
	{
		return Bedroom_Door
	}
out_to
	{
		return Bedroom_Door
	}


}

LightRoom Front_Porch "Front Porch"
{
	prep " the"

	long_desc
	{

	if GameEvents[16] = 1 
	{

		"I shake my head at my horrible home life and leave for work...\n"

		Switch_Chapter(3)
	}
	else
	{
		"I head back inside to the Living Room."

		MovePlayer(Living_Room)
	}
	}


}

LightRoom Driveway "Driveway"
{
	prep " the"
}

door Bedroom_Door "bedroom door"
{
	nouns "door" "room"
	adjectives "bedroom" "living"
	article "the"
	between Living_Room Duffy_Bedroom
	is not openable, open, not lockable, not locked

	parse_rank 1
}




!!!!!!!!!!!!!!! Chapter Three

LightRoom2 MallStore1 "Benji's Gaming and Role-Playing Emporium"
{
	long_desc
	{
		if ((self is not visited) and (Chapter < 4))
		{
			Gibs_Script_1()

			"Trott had been working the evening shift; I greet him and take my usual place behind the counter. There's really no reason for two of us
			to close the store, except that Benji (the owner) is still a little freaked after someone tried to blow
			up his arcade next door a couple of weeks ago. It's unlikely that we'll have any customers, though, so
			Trott and I should be able to logout the register and drop the gate quickly when the time comes."
		}

		else
		{
			if Chapter < 4
			{
				"The Emporium is rather smallish, as far as stores around here go, nestled into the far corners of 
				the Mall, distant from practically every other decent or worthwhile store. Shelves of gaming books 
				and modules are arranged everywhere, and promotional kiosks occupy the floorspace between the 
				register and the far wall.\n"

				"The rest of the Mall is to the north."
			}
			else
			{
				"My store is covered in darkness and shadows, giving it a far more foreboding look than it's
				otherwise ever had.\n"

				"The rest of the Mall is to the north. The door to the back room leads east."

				if GameEvents[46] = 0 
				{
					GameEvents[46] = 1 

					"\n\"Trott? Trott!\" There doesn't seem to be any sign of him, but I yell his name a couple
					of times just in case he was hiding, skulking or lurking somewhere. \"He may have gone through 
					into the backroom,\" I say to Gibs. \"We can look for him there, I guess.\""
				}
			}
		}
	}

	graphic "mall", "mallstore01"

	before
	{
		location YouCanGo
		{
			if GameEvents[5] = 0
			{
				"There's an exit north to the rest of the Mall, but I'm really not supposed to leave until
				my shift is over. (That won't be for another couple of hours.)"
			}
			else
			{
				"There's an exit north to the rest of the Mall, and a door to the east."
			}
		}
	}

n_to 
	{
		if GameEvents[5] = 1
		{
			return Corridor1
		}
		else
		{
			"I'm supposed to finish out this shift tonight."
		}
	}

e_to	
	{
		if GameEvents[5] = 1
		{
			return BackOffice_door
		}
		else
		{
			"Ah, Trott will go into the back room to grab anything if the need arises."
		}
	}
}

LightRoom2 MallStore2 "Choad's Sporting Goods"
{
nouns "room" "area" "store" 

	long_desc
	{
		if self is not visited
		{
			Activate(Ghoul_Appears)			

			SetQuip(11,7,0)
			SetQuip(11,8,0)

			"There is a light blue-skinned, feral beast hunched over towards the corner of this store. 
			A ghoul, just as how I'd imagine it. It has Audrey backed up against the eastern wall. A row of 
			jacket racks separates them from me. Gibs is much closer, and seems to be holding the ghoul at 
			bay by slowly darting in and out of its range, and preventing it from ripping Audrey apart by 
			giving it another target. That won't stop it for long. The only thing preventing the ghoul 
			from shredding Audrey is its attempt to work out just how he can incapacitate and consume them both."
		}

		else
		{
			if ghoul.conscious = 0 
			{
				"Choad's Sporting Goods exists under the unfortunate circumstance that the owner's name translates into 
				Bengali as 'fuck.' Once or twice a year there will be a demonstration or protest from a bunch of 
				local student Hindus, but nothing ever changes.\n"
			}


			"The store is one of the larger ones in the Mall, about 40' wide and 140' long. Ski jackets take up almost 
			all the area towards the front of the store, as far as I can see, with the entire western wall filled 
			with displays of discount tennis sneakers.\n"

			"There doesn't seem to be any rifles or shotguns for sale. (It appears as if Gibs's intuition was incorrect.)"
		}
	}		

	before
	{
		location YouCanGo
		{
			"There is an exit south to the long corridor of the top level of the Mall."			
		}

		object DoSearch
		{
			if ghoul.conscious = 1
			{
				"There isn't enough time to really give the store a good searching. I don't see anything that
				resembles a rifle or shotgun offhand, though."
			}
			else
			{
				if GameEvents[49] = 0
				{
					SetQuip(3,36,1)
				}

				"I take a closer look at the store, but I don't see anything that remotely approaches a shotgun 
				or rifle. This is what I get for letting an amateur of consumerism like Gibs attempt to twist escape policy
				with their inexperience."
			}
		}
	}

	graphic
	{
	
		select(LocationState[11])
			case 1
			{
				current_resource_file = "mall"
				current_resource = "sporting01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "sporting02"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "sporting03"
			}
			else
			{
				current_resource_file = "mall"
				current_resource = "sporting01"
			}

		return -1
	}

s_to 
	{
		! Set this for Casey's quip 
		SetQuip(11,6,0)

		if ghoul.conscious = 1
		{
			"Not now -- not while this monster threatens my friends."
		}

		else
		{
			if GameEvents[22] = 0
			{
				GameEvents[22] = 1

				! Remove the "my preeeecious" line
				SetQuip(3,24,0)

				move wraith to kiosk

				"\"Can you watch Gibs for a bit?\" I ask Casey.\n"

				"\"It won't be a problem,\" she says.\n"

				"Audrey goes up to him, still in his frozen state, and gives him a kiss on the cheek. \"Have a good
				thaw,\" she says.\n"

				"I take her hand and put it in mine and together we leave the Sporting Goods store."
			}

			return Corridor2
		}
	}
}


LightRoom2 MallStore3 "Bead Store"
{
	prep " The"

	long_desc
	{
		if self is not visited
		{

			SetQuip(3,46,0)

			Activate(Ghost_Summons)			

			"I part aside a dense curtain of strung-together beads and enter the store. The Bead Store has always
			had a unique odor among the shops on this block of the Mall -- it smells strongly of incense and old
			marijuana. The owner of this place has a sweetheart deal on the rent along with clearance from the Fire
			Marshall that allows her to burn all manner of scent sticks popular with Wiccans and hippies.\n"

			"There are shelves on all sides of the store, but none in the middle of the store due to the drawn
			pentagram.\n" 

			"On the far side of the store is the register counter, and next to that, the broken PC that
			Audrey wanted me to take a look at."
		}

		else
		{

			"The Bead Store smells strongly of incense and stale joints, and it almost overpowers every
			other sense. There are shelves on all sides of the store, but none in the middle of the store due to the drawn
			pentagram." 

			if Chapter >= 4 
			{
				Activate(Bead_Store_Ejection)
			}
			else
			{
				"\nOn the far side of the store is the register counter, and next to that, the broken PC that
				Audrey wanted me to take a look at."
			}

		}
	}
	before
	{
		location YouCanGo
		{
			"There is an exit to the north which leads to the long corridor of the top level of the Mall."
		}
	}
	graphic
	{
		select(LocationState[3])
			case 0,1
			{
				current_resource_file = "mall"
				current_resource = "bead_store01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "bead_store02"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "bead_store03"
			}

			case 4
			{
				current_resource_file = "mall"
				current_resource = "bead_store04"
			}

			case 5
			{
				current_resource_file = "mall"
				current_resource = "bead_store05"
			}

			case 6
			{
				current_resource_file = "mall"
				current_resource = "bead_store06"
			}

			case 7
			{
				current_resource_file = "mall"
				current_resource = "bead_store07"
			}

			case 8
			{
				current_resource_file = "mall"
				current_resource = "bead_store08"
			}

			case 9
			{
				current_resource_file = "mall"
				current_resource = "bead_store09"
			}
			case 10
			{
				current_resource_file = "mall"
				current_resource = "bead_store10"
			}

			else

			{
				current_resource_file = "mall"
				current_resource = "bead_store01"
			}

		return -1
	}

n_to {
	if GameEvents[8] = 1 
	{
		"I still have stuff to do here."
	}

	elseif GameEvents[8] = 2 and Skeleton.conscious = 1 
	{
		"The skeleton won't let me pass!"
	}

	else
	{
		return 	Corridor3
	}
    }
}

LightRoom2 MallStore4 "Jewelry Store"
{
	prep " The"

	long_desc
	{
		if self is not visited
		{
			"We both press ourselves flat up against the wall of the Jewelry Store.\n"
			"\"How are we to get past the wraith, Jarret?\" Her eyes dart down and to the side as she tries
			to remember if she ever encountered one in a role playing game. \"... I can't remember,\" she
			says.\n"

			"\"Sunlight, and I don't know how long until that will show up.\" I say. 
			Was there really a wraith there? Outside the store? I didn't see
			a thing. It is colder down this way than it was in the rest of the Mall, though. 
			\"Yeah. Sunlight is the only thing I'm 100% positive on, maybe there are others.\" I strain to try to
			remember, but I haven't used a 'wraith' character in any games that I've played in a very
			long time. I'm certain there are other ways... I just can't recall."

			SetQuip(3,41,1)
			SetQuip(3,42,1)

		}
		else
		{
			"The Jewelry Store is of average dimensions for the Mall, with significantly less maneuvering
			room due to the long tabletop display that snakes about the room. They sell all manner of
			jewelry (ear rings, bracelets, watches) but as they close much earlier than everybody else, 
			it's all under lock and key.\n"

			"On the east side of the store, against the wall, is a large safebox."
		}
	}
	before
	{
		location YouCanGo
		{
			"There is a lone exit south to the long corridor of the top level of the Mall."			
		}

		location DoYell
		{
			if GameEvents[26] = 1
			{
				"Now is not a good time to attract the wraith into the room."
			}
			elseif GameEvents[57] = 1
			{
				Attract_Wraith()
			}
			
			else
			{
				"Audrey puts her hand over my mouth to stop me from screaming."
			}
		}
	}

	graphic
	{
		select(LocationState[5])
			case 1
			{
				current_resource_file = "mall"
				current_resource = "vision01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "vision02"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "jewelry_store03"
			}

			case 4
			{
				current_resource_file = "mall"
				current_resource = "jewelry_store04"
			}

			case 5
			{
				current_resource_file = "mall"
				current_resource = "jewelry_store_wraith"
			}
			case 6
			{
				current_resource_file = "mall"
				current_resource = "jewelry_store02"
			}
			case 7
			{
				current_resource_file = "mall"
				current_resource = "jewelry_store01"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "jewelry_store01"
			}

		return -1
	}

cant_go
	{
		"There isn't an exit in that direction.\n"

		"There's an exit south into the long corridor of the top level of the Mall."
	}

s_to
	{
		if wraith in kiosk
		{
			"\"Jarret, no!\" whispers Audrey. \"It's not safe, not with the wraith still out there!\""
		}

		else
		{
			SetQuip(3,37,0)
			SetQuip(3,38,0)

			! Can no longer kiss Audrey here 
			GameEvents[40] = 0 

			select(GameEvents[27])
			case 0			
			{
				"I take the opportunity to sneak out of the Jewelry Store..."

				Audrey is not following
				move Audrey to MallStore4

				return Corridor4
			}

			case 1
			{
				GameEvents[27] = 2

				Audrey is not following

				Activate(Luck_With_Elevator)

				move Barnaby to Corridor4
				move Audrey to Corridor4
				move Casey to Corridor4

				return Corridor4
			}

			case 2
			{
				return Corridor4
			}
		}
	}
}


Lightroom Corridor1 "Eastern End of the Mall"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"This is as far east as the Mall goes. The Mall technically dips a bit as one goes west, as it was
			originally built on a landfill (and it's already started to sink some). There's a three-sided advertising
			kiosk in the middle of the corridor.\n"

			"To the west is the Bead Store, Sporting Goods Outlet and Arcade.\n"
			
			"My store, the Gaming Emporium is south." 
		}

		else
		{

			"This is far east as the Mall goes. The Mall technically dips a bit as one goes west, as it was originally
			constructed upon a landfill. There's a three-sided advertising kiosk in the middle of the corridor.\n"

			"To the west is the Beads Store, Sporting Good Outlet and the (closed) Arcade.\n"

			"My store, the Gaming and Role-Playing Emporium, is to the south."

			if ((Audrey in location) and (Casey in location) and (Chapter = 4) and (GameEvents[12] = 0))
			{
				GameEvents[12] = 1

				CharExclaim(Audrey,ExclaimArray[4])
			}
		}
	}


graphic
	{
		select(LocationState[12])
			case 1
			{
				current_resource_file = "mall"
				current_resource = "corridor0101"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "corridor0102"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "corridor0103"
			}
			else
			{
				current_resource_file = "mall"
				current_resource = "corridor0101"
			}

		return -1
	}


w_to Corridor2	

s_to MallStore1
}

LightRoom2 Corridor2 "East Side of the Mall"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"I'm at the eastern side of the Mall. To the north is Choad's Sporting Goods (the gate
			has been lowered and the screen up). The arcade is to the south, but that has been closed and inaccessible for a while
			now. My store is a bit to the east, and the Bead Store a bit to the west.\n"
			
			"There is a table here, a couple feet west of the edge of the Sporting Goods store."

		}

		else
		{
			if Chapter >= 4 
			{
				LocationState[7] = 3
			}

			! Gibs won't mention that this is the wrong way... 
			GameEvents[44] = 2

			! Always turn this quip off -- it's about Duffy telling Audrey bye. 
			SetQuip(3,35,0)

			"I'm at the eastern side of the Mall. To the north is Choad's Sporting Goods. My store is a bit to the
			east, and the Bead Store a bit to the west.\n"

			"There is a table here, set adjacent to the Sporting Goods store."

			if GameEvents[9] = 0 and Chapter = 4
			{
				GameEvents[9] = 1 
				CharExclaim(Barnaby,ExclaimArray[6])
			}

			if Chapter = 4 and choadgate is not open and Security_Room is visited
			{
				if GameEvents[20] = 0 
				{
					GameEvents[20] = 1 

					if phone in Player
					{
						CharExclaim(Barnaby,ExclaimArray[8])
					}
					else
					{
						CharExclaim(Barnaby,ExclaimArray[26])
					}
				}

				! Quip for Trott
				SetQuip(8,12,1)
			}
			if Chapter = 4 and choadgate is open and Security_Room is visited
			{
				if GameEvents[20] = 0
				{
					GameEvents[20] = 1 

					"\n\"This won't take me a moment to sort out,\" says Gibs. \"I'll be in and out like a greased
					German through the Maginot Line.\"\n"

					"\"I thought the Germans circumvented \Baround\b the Maginot Line?\" I say.\n"

					"\"No. You've got that confused with what they did with the bounds of good taste when they
					collectively invented \Ischeisse \i porn,\" says Gibs with commanding authority. \"Anyway, 
					more importantly, I know just where the shotguns would be in this store. Anyone want to 
					come with?\"\n"

					"\"I'll go,\" says Audrey. \"I'll try to find some helmets and pads and such.\"\n"

					"\"Pads?\" This is good. Very good. \"Oh, so you were able to trickle a puck past the five hole 
					with the Detroit Red Wings after all?\" I ask Audrey.\n"

					"\"What?\" It takes Audrey a moment to translate my intended delicate innuendo in her head, but 
					when she does, she's not laughing. \"No. I meant like shoulder pads and shin guards. 
					For personal defense.\" She pauses for a moment. \"What on earth is wrong with you?\"\n"

					"Whoops. \"I'll just, ah, stay out here with Casey, then.\""

	
					move Audrey to Mallstore2
					move Barnaby to Mallstore2

					Audrey is not following
					Barnaby is not following
					Casey is not following
					Move Casey to Corridor2

					SetQuip(11,1,1)
					SetQuip(11,2,1)
				}
			}

			if GameEvents[22] = 1
			{
				GameEvents[22] = 2

				CharExclaim(Audrey,ExclaimArray[6])
			}

		}
	}
	before
	{
		location YouCanGo
		{
			if choadgate is open
			{
				"There is an exit north to Choad's Sporting Goods store, and then both west and east along
				the Mall corridor."

			}
			else
			{
				"There are exits west and east along the Mall corridor."
			}
		}
	}

graphic
	{
		select(LocationState[12])
			case 1
			{
				current_resource_file = "mall"
				current_resource = "corridor0202"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "corridor0201"
			}
			case 3
			{
				if choadgate is not open
				{
					current_resource_file = "mall"
					current_resource = "corridor0202"
				}
				else
				{
					current_resource_file = "mall"
					current_resource = "corridor0203"
				}

			}
			case 4
			{
				current_resource_file = "mall"
				current_resource = "corridor0204"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "corridor0202"
			}

		return -1
	}

n_to
	{
		if Chapter < 4
		{
			"There's really nothing going on in the Sporting Goods store."
		}
		else
		{
			if choadgate is open and GameEvents[21] = 1
			{
				return MallStore2
			}

			elseif choadgate is open and GameEvents[21] = 0
			{
				"Well, Casey and I are supposed to 'guard' the entrance. I guess we should probably do 
				that."
			}

			elseif Security_Room is not visited
			{
				"The gate is down. I won't be able to unlock it or otherwise open it from here, but I probably can if
				I get to Mall's security and electrical console. Trott knows where it is, so I should go find him."
			}

			else
			{
				"Trott can raise the gate for me so that I can get into the store, I just need to ask him."
			}
		}
	}

e_to 
	{
		SetQuip(8,12,0)
		return Corridor1
	}
w_to	{
		SetQuip(8,12,0)
		return Corridor3
	}
}

LightRoom Corridor3 "East Side Corridor"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			CharExclaim(Audrey, ExclaimArray[9])
			if Audrey in Corridor3
			{	
				""
			}

		}

		else
		{
			Deactivate(Bead_Store_Ejection)
		}
		
		"There's only one more stretch of corridor on this level before one gets to the elevator, which
		leads down to the ground floor. To the south of this area is the Bead Store, exits otherwise lead
		west and east."
	}

	graphic
	{
		select(LocationState[7])
			case 0
			{
				current_resource_file = "mall"
				current_resource = "corridor0301"
			}



			case 1
			{
				current_resource_file = "mall"
				current_resource = "corridor0301"
			}



			case 2
			{
				current_resource_file = "mall"
				current_resource = "corridor0302"
			}



			case 3
			{
				current_resource_file = "mall"
				current_resource = "corridor0303"
			}



			case 4
			{
				current_resource_file = "mall"
				current_resource = "corridor0304"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "corridor0303"
			}

		return -1
	}

e_to Corridor2
w_to Corridor4
s_to MallStore3
}

LightRoom2 Corridor4 "Before the Elevator"
{
	prep " the area"
	is special	! Used when the stench is there 

	long_desc
	{
		if Chapter < 4
		{
			Audrey is not following
			Barnaby is not following 

			"The floor of the Mall changes into a overhang terrace here. The bottom (ground floor) level can be viewed with ease,
			and a guard prevents adults and larger children from ragdolling their way off the edge.\n"

			"The guy taking the surveys for the Mall is here! This guy just traps you into doing one of these
			stupid surveys and then blathers on forever about how he's never had a date in his life."

			Randolph_Speaks()

			PictureinText("mall", "pause01", 15, 11, true)

			pause

			MovePlayer(Corridor3)

			move Randolph to Corridor4

			Audrey is following
			Barnaby is following 

		}
		else
		{

			"The floor of the Mall comes up against a rail, forming a barrier which prevents further (sane)
			western travel. The bottom (ground floor) level can be viewed with ease, though, as the
			guardrail mainly prevents kids -- future productive Mall denizens! -- from ragdolling their way off 
			the edge.\n"

			! Corridor4 being special denotes that the stench is still there

			if Corridor4 is special

			{
				"There is a horrific stench in this area. It's new, too -- the guy who used to take the surveys
				always kept himself cheerfully clean.\n"

				CharExclaim(Barnaby, ExclaimArray[33])

			}

			if kiosk is open
			{
				"There is a badly-cracked kiosk in the center of the hallway. At the far end of the rail is an elevator."
			}
			else
			{
				"There is a kiosk in the center of the hallway. At the far end of the rail is an elevator."
			}

			if Wraith in kiosk and GameEvents[23] = 0
			{
				GameEvents[23] = 1 
				
				if MUSIC_OFF = TRUE
				{
				}

				else
				{
					PlayMusic("ndmusic", "LikeThis--Wooooo", sound_volume, false, true)	
				}

				"\nAudrey quietly points over to the kiosk and whispers right into my ear.\n"
				"\I\"Do you see that? Do you see the wraith?\"\i\n"
				"I squint. The lighting is so dark... I don't see it. I adjust my glasses and still
				nothing. I shake my head in the negative.\n"
				"Audrey takes my hand in hers and we duck into the Jewelry Store..."

				PictureinText("mall", "pause01", 15, 11, true)

				pause

				MovePlayer(MallStore4)

				!check if this is necessary
				!move Audrey to MallStore4

				Activate(Vision_First)
			}

			if GameEvents[44] = 1 
			{

				CharExclaim(Barnaby, ExclaimArray[27])

				if GameEvents[45] = 0
				{
					GameEvents[45] = 1
					CharExclaim(Barnaby, ExclaimArray[28])
				}
			}
		}
	}
	graphic "mall", "corridor0401"

	before
	{
		location YouCanGo
		{
			"There are exits north to the Jewelry Store, in towards the Elevator and east towards the east side of
			the Mall."
		}
		location DoSmell
		{
			if self is special
			{
				"The general aura of air here is one of the worst-smelling and foulest odors I have ever had wafted around in my face."
			}
			else
			{
				"The air isn't going to win any awards from \IOlfactory Quarterly\i, but it's a sharp sight better than
				it used to be here."
			}
		}
	}
n_to 
	{
		if GameEvents[23] = 1 
		{
			return MallStore4
		}
		else
		{
			"The gates to the Jewelry Store prevents passage that way."
		}
	}

in_to
	{
		if GameEvents[31] = 2
		{	

			if Corridor4 is not special
			{
				if Barnaby in Corridor4
				{
					move Barnaby to Elevator
				}

				if Audrey in Corridor4
				{
					move Audrey to Elevator
				}
				if Casey in Corridor4
				{
					move Casey to Elevator
				}
			}

			return Elevator
		}
		else
		{
			"I can't get into the Elevator as it's not on this floor."
		}
	}
	
e_to Corridor3

cant_go
	{
		"There's not a path in that direction.\n"
		"There are exits north to the Jewelry Store, in towards the Elevator and east towards the east side of
		the Mall."
	}
}


scenery Mall_Elevator "elevator"
{
	noun "elevator"
	article "the"

	found_in Elevator Corridor4

	long_desc
	{
		"The elevator is a gray, oblique transporter used to move Mall denizens from level to level."
	}

	Before
	{

		object DoEnter
		{
			if location ~= Elevator
			{	
				MovePlayer(Elevator)

				if GameEvents[31] = 1 and Barnaby in Corridor5 and Barnaby.conscious = 1
				{
					Move Barnaby to Elevator
				}

				if GameEvents[31] = 1 and Audrey in Corridor5
				{
					Move Audrey to Elevator
				}

				if GameEvents[31] = 1 and Casey in Corridor5
				{
					Move Casey to Elevator
				}

				if GameEvents[31] = 2 and Casey in Corridor4
				{
					Move Casey to Elevator
				}

				if GameEvents[31] = 2 and Audrey in Corridor4
				{
					Move Audrey to Elevator
				}

				if GameEvents[31] = 2 and Barnaby in Corridor4
				{
					Move Barnaby to Elevator
				}

			}
			else
			{
				"I'm already in it."
			}
		}
	}
}


LightRoom2 Elevator "Elevator"
{
nouns "elevator" "lift"
parse_rank 1 

! GameEvents[31] determines which level it's on

	long_desc
	{
		"The elevator smells terrible, strongly of untreated or unembalmed cadavers. There are three buttons here in the elevator
		labelled 'up,' 'down' and 'open doors.'"

		"\nI'm currently on the ";

		if GameEvents[31] = 2
		{
			"\Bsecond\b ";
		}
		else
		{
			"\Bfirst\b ";
		}

		"level of the Mall. Aside from the operational panel, there is little else here in the lift."

		if (Elevator_Doors is open) and (perfume_bottle in Player) and (GameEvents[31] = 1)
		{
			"\nI can see into the corridor ahead, although only a few feet before the darkness completely
			envelopes the hall."
		}
	}

	before
	{
		location DoSmell
		{
			if Corridor4 is special
			{
				"Things smell of dead bodies here in the elevator. I couldn't bear to venture further into the 
				area on the first level. It would be like staring into the sun and walking forward, except
				for my nose."
			}
			else
			{
				"Everything smells fine. Well, relatively."
			}
		}

		location YouCanGo
		{
			"Er... there's an exit out of the elevator."
		}
	}

cant_go
	{
		"I can't go that way. \n"
		"There is an exit leading out."
	}
out_to
	{
		if GameEvents[31] = 1
		{
			if Corridor4 is not special
			{
				if Barnaby in Elevator
				{
					move Barnaby to Corridor5
					Barnaby is following
				}

				if Casey in Elevator
				{

					move Casey to Corridor5
					Casey is following
				}

				if Audrey in Elevator
				{
					move Audrey to Corridor5
					Audrey is following
				}

				return Corridor5
			}
			else
			{
				GameEvents[31] = 2 

				"The elevator doors open, and I'm struck by the terrible, pungent odor of carrion. It's far too much for 
				what I can bear: it's absolutely the worst-smelling air I have ever experienced.\n"				

				"I briefly steal a glance of what lay beyond in the corridor on the first level of the Mall before squashing
				the up button on the elevator -- it's mostly dark, but I can make out the cupid statue. The stench is just too much for 
				me. however. I can't force myself to do anything from here except escape.\n"				

				"The elevator comes to rest on the top floor."
				
			}
		}

		else
		{
			if Barnaby in self
			{
				move Barnaby to Corridor4
			}
			if Audrey in Elevator
			{
				move Audrey to Corridor4

			}
			if Casey in Elevator
			{
				move Casey to Corridor4
			}

			return Corridor4
				
		}
	}
}


scenery up_button "up button"
{
	noun "button" "up"
	adjective "up" "metal"
	article "the"

	parse_rank 1

	in Elevator 

	is static

	long_desc
	{
		"It's just a little metal button that says 'up' on it."
	}
	before
	{
		object DoPush
		{
			if GameEvents[31] = 2
			{
				"Nothing happens; I'm already on the second floor."

			}
			else
			{
				GameEvents[31] = 2 
				"I press the up button. After a few seconds, the elevator transports me to the
				second level of the Mall."

				remove Far_Hallway

				Elevator_Doors is not open
			}
		}
	}

}
	

scenery down_button "down button"
{
	noun "button" "down"
	adjective "down" "metal"
	article "the"

	parse_rank 1


	in Elevator 

	is static

	long_desc
	{
		"It's a non-descript button that says 'down.'"
	}
	before
	{
		object DoPush
		{
			if GameEvents[31] = 1
			{
				"Nothing happens since I am already on the first floor of the Mall."
				return 
			}
			else
			{
				GameEvents[31] = 1 
				"I press the down button. After a few seconds, the elevator transports me to the
				first (ground) level of the Mall.\n"

				"The doors remain shut for some reason."

				remove Far_Hallway

				Elevator_Doors is not open 
			}
		}
	}

}


scenery open_doors_button "open doors button"
{
	noun "button" "doors"
	adjective "open" "doors"
	article "the"

	parse_rank 1


	in Elevator

	long_desc
	{
		"The button itself is just a little pad on top of a heat-sensor."
	}
	before
	{
		object DoPush
		{
			Perform(&DoOpen, Elevator_Doors)
		}
	}
}


scenery elevator_doors "elevator doors"
{
	noun "doors" "door"
	adjective "elevator"
	article "the"

	parse_rank 10

	found_in Elevator Corridor4 Corridor5

	is plural, openable, open, enterable

	long_desc
	{
		"They are competently constructed steel doors, and possibly the only item not of ridiculously cheap
		construction in the entire Mall."
	}

	before
	{
		object DoOpen
		{
			if self is open
			{
				"They're already open."
			}
			else
			{
				self is open
				"The doors are now open."

				if GameEvents[31] = 1 
				{
					move Far_Hallway to Elevator
				}
			}
		}
		object DoClose
		{
			"Done."
			self is not open
			remove Far_Hallway
		}

		object DoEnter
		{
			if Player in Elevator
			{
				"I'm already in the elevator."
			}
			elseif self is open
			{
				MovePlayer(Elevator)
				self is not open
			}
			else
			{
				"(The elevator doors open...)"

				MovePlayer(Elevator)
				self is not open
			}
		}
	}
}


scenery control_panel "control panel"
{
	noun "panel"
	adjective "control" "operational"
	article "the"

	in Elevator

	long_desc
	{
		"The control panel details three buttons of interest: the up button, the down button and the
		open doors button."
	}
	before
	{
		object DoPush
		{
			"Pushing the control panel doesn't do anything -- there are three buttons, however (up, down
			and open doors)."
		}
	}
}



LightRoom Corridor5 "Mall, First Level, East Edge"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"I'm on the first level (ground floor) of the Mall, a lot closer to the lone exit than where I was
			previously. I'll need to get past a few more stretches of corridor (which is under a blanket of
			darkness) and then past the Food Court. And I hesitate to think about what is in store for me
			until I get to that point."
			
		}
		else
		{
			"This is the first level, or ground floor, of the Funtime Teen Mall. The lone Mall Exit leads
			in a westerly direction, past a few more stretches of darkness-enveloped corridor, and the Food Court. 
			There's also a few more stores to the west, with the Mall passageways expanding to all four
			directions at that point."
		}

		if ghast.hitpoints > 0
		{
			ghast is not following

			move ghast to Corridor6

			if Corridor6 is not visited
			{
				"\nJudging by the waves of odor that I can still pick up, there's probably a ghast 
				still running around here somewhere."
			}
			else
			{
				"\nThe air is still thick with a ripe, rotting stench... attributed to the still-living ghast
				to the west, natch."
			}
		}

		"\nExits lead west to the rest of the Mall, and inside to the elevator."

		if GameEvents[65] = 1
		{
			GameEvents[65] = 2
			CharExclaim(Audrey, ExclaimArray[15])
		}

		if self is not visited
		{
			CharExclaim(Barnaby, ExclaimArray[12])
		}
	}

	before
	{
		location DoSmell
		{
			"Everything smells awful here. It's not crippling -- the horrors of death are around, but bearable."
		}
	}

	graphic "mall", "corridor0502"

w_to	{
		return Corridor6
	}

npc_move e_obj

}

LightRoom2 Corridor6 "Mall, First Level, Eastern Edge"
{
	prep " the"

	long_desc
	{

		if self is not visited
		{

			if MUSIC_OFF = TRUE
			{
			}

			else
			{
				PlayMusic("ndmusic", "zombiecrap2", sound_volume, false, true)	
			}

			"I enter this bit of hallway and am taken back by the glorious fountain that dominates the scene.
			I've seen it hundreds, even thousands of times in normal daylight, but the small bits of ambient
			light currently available reflects off the fountain in a simply breathtaking manner."
		}

		else
		{
			if ghast is not following and ghast not in corridor6
			{
				LocationState[16] = 0
			}

			"This bit of hallway features an enormous and beautiful fountain. There are exits in all four
			primary compass directions."

			!fountain is quiet
		}


		if ghast.hitpoints > 0 and ghast in location
		{
			ghast.peaceful = false
			fight_active = 1 
			LocationState[16] = 1

			if self is not special
			{
				Activate(Ghast_Jpg_Changes)
				self is special
				CharExclaim(Barnaby, ExclaimArray[13])
			}

		}
	}
	before
	{
		location DoSmell
		{
			"A bit like rotting corpses, a bit like sexy perfume."
		}
	}
	graphic
	{
		select(LocationState[16])
			case 0
			{
				current_resource_file = "mall"
				current_resource = "corridor0601"
			}

			case 1
			{
				current_resource_file = "mall"
				current_resource = "ghast_attack01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "ghast_attack02"
			}
		return -1
	}

	before
	{
		location YouCanGo
		{
			"There are exits in all four primary compass directions."
		}
	}

e_to	{
		if ghast.conscious =1 and ghast in location
		{
			"The ghast chooses not to follow me."

			if GameEvents[65] = 0
			{
				GameEvents[65] = 1
			}

			ghast is not following

			return Corridor5
		}
		else
		{
			return Corridor5
		}
	}

w_to	{
		if ghast.conscious = 1 and ghast in location 
		{
			"The ghast blocks my path."
		}
		else
		{
			return Corridor7
		}
	}

n_to	{
		if ghast.conscious = 1 and ghast in location 
		{
			"I can't get past the ghast to go north!"
		}
		else
		{
			return Sunglasses_Hut
		}
	}

s_to
	{
		if ghast.conscious = 1 and ghast in location 
		{
			"The ghast won't let me get by him to go that way."
		}
		else
		{
			return Poster_Store
		}
	}


spectre_n_to	Sunglasses_Hut
spectre_s_to	Poster_Store
spectre_w_to	Corridor7

npc_move spectre_n_obj, spectre_s_obj, spectre_w_obj

}

LightRoom2 Corridor7 "Mall, First Level, Central Corridor"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"This stretch of the Mall hallway is covered with just a bit of rubble. There are clear
			exits to the west and south (in addition to the east, back from where we came). The gate to the 
			Record Store is down to the north."

			CharExclaim(Barnaby,ExclaimArray[14])

			SetQuip(8,15,1)

		}
		else
		{
			if rubble01 in self
			{
				"This stretch of the Mall hallway is covered with just a bit of rubble. There are clear
				exits to the west and south. The gate to the Record Store is down to the north."
			}
			else
			{
				"This stretch of the Mall hallway is covered with just a fine dusting of rubble. 
				 There are clear exits to the west and south. The gate to the Record Store is down to the north."
			}

			if Barnaby in location and Corridor8 is visited
			{
				Barnaby is following
			}
			if Casey in location and Corridor8 is visited and Casey is not bitten
			{
				Casey is following
			}
		}

		if ghast.hitpoints > 0 and ghast in location and ghast.conscious = 1
		{
			ghast.peaceful = FALSE
			fight_active = 1 
		}
	}

	graphic "mall", "corridor0701"

	before
	{
		location YouCanGo
		{
			"There are exits north to the Record Store, and west, east and south to other corridors of the Mall."
		}
	}
e_to	{
		return Corridor6
	}

w_to	{
		return Corridor8
	}

s_to	{
		if Corridor8 is not visited and Barnaby is following and Casey is following
		{	
			CharExclaim(Barnaby,ExclaimArray[32])

			Barnaby is not following

			Casey is not following
		}


		ghast is not following

		return Corridor9
	}

n_to
	{
		"The gate to the Record Store is down, blocking my path."
	}

cant_go {
		"There is not an exit that way. \n"
		"There are exits north to the Record Store, and west, east and south to other corridors of the Mall."
	}
	

spectre_n_to
	{
		return Record_Store
	}
spectre_s_to
	{
		return Corridor9
	}

npc_move spectre_n_obj, spectre_s_obj, e_obj

}


LightRoom Record_Store "Record Store"
{
! Only exists for the spectre


s_to 
	{
		return Corridor7
	}


spectre_s_to
	{
		return Corridor7
	}

npc_move spectre_s_obj
}




LightRoom2 Corridor8 "Mall, First Level, West Edge"
{
	prep " the"
	is not special

	long_desc
	{
		if self is not visited
		{
			"A kind of cave-in has apparently occurred here. While the gate north to the Novel Shoppe has been destroyed (and 
			passage is possible), our path to the west is blocked by an enormous amount of rubble."			

			Move Barnaby to location
			Move Casey to location

			CharExclaim(Barnaby, ExclaimArray[15])

			Barnaby is not following

			Casey is not following 

		}
		else
		{
			if GameEvents[59] = 0
			{
				SetQuip(2,19,1)
			}
				

			!Only do this until it's come up positively. 
			if GameEvents[54] = 0
			{
				!print number RubbleState[1]
				!print number RubbleState[2]
				!print number RubbleState[3]
				!print number RubbleState[4]
				

				RubbleState[5] = RubbleState[1] + RubbleState[2] + RubbleState[3] + RubbleState[4]

				!RubbleAnchor
				! These line, of course, has to go -- it's only here for testing. 
				!if RubbleState[5] = 0
				!{
				!	RubbleState[5] = 4 
				!}
				! These line, of course, has to go -- it's only here for testing. 
			}



			if RubbleState[5] = 4
			{
				GameEvents[54] = 1 
				RubbleState[5] = 5 

				"The area is free from the wreckage. Gibs, though is just standing up, completely motionless, facing the
				inky blackness that shrouds the Food Court from here. Casey is nowhere to be found."

				GameEvents[59] = 1

				CharExclaim(Barnaby, ExclaimArray[16])
			}
			else
			{
				!print number RubbleState[5]

				"This area is adjacent to the huge Food Court which is just over to the west. The amount of 
				available light dwindles further, while the density of smoke present is the thickest I've
				seen yet.\n"
				
				"There's paths to the west (into the Food Court) and east (back into the first-floor corridor)."
			}
		}
	}

	before
	{
		location YouCanGo
		{
			"There are exits north to Discount Novel Shoppe, East to the Central Corridor, South to the Sneaker 
			Store and West to the Food Court."
		}
	}
cant_go {
		"There is not an exit that way. \n"
		"There are exits north to Discount Novel Shoppe, East to the Central Corridor, South to the Sneaker Store and West to the Food Court."
	}

e_to	{
		return Corridor7
	}

n_to
	{
		return Book_Store
	}

s_to
	{
		"The gate to the Sneaker Store is down."
	}

w_to 
	{

		if RubbleState[5] = 5
		{
			SetQuip(2,19,0)

			Activate(Poltergeist_Attacks)
			return Food_Court1
		}
		else
		{
			"I can't go that way due to all the rubble."
		}
	}

spectre_e_to

	{
		return Corridor7
	}

npc_move spectre_e_obj

}

LightRoom2 Corridor9 "Mall, First Level, Southern Edge"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"I enter the southern-most section of the Mall, and it's as I feared: the Outlet SuperStore has been
			cemented over, so I won't be able to get to the exit doors that way. (I always arrive through the 
			food court due to how the parking lots are structured.)\n"

			"There's two stores here that are accessible, however: a party favors store to the east, and then
			the Bead Store's main competitor -- a candle store, which is to the west."
		}
		else
		{
			"This is the southern-most section of the Mall. There's a large block of impenetrable cement to
			the south, which covers over the failed Outlet Store, and two paths to two other stores: the
			candle store (west) and party favors store (east)."
		}
	}
	before
	{
		location YouCanGo
		{
			"There are exits north to the Central Corridor, west to the Christ's Candles and east to Party On Central."
		}
	}

cant_go {
		"There is not an exit that way. \n"
		"There are exits north to the Central Corridor, west to the Christ's Candles and east to Party On Central."
	}

n_to	{
		return Corridor7
	}

w_to	{
		return Candle_Store
	}

e_to
	{
		return Party_Store
	}

s_to
	{
		"The gate to the Outlet Tech SuperStore is down."
	}


spectre_s_to
	{
		return Block_Store
	}

npc_move spectre_s_obj, w_obj, e_obj, n_obj

}

LightRoom Poster_Store "Poster Store"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"This place has been in the Mall for as long as I can remember. It really is just called
			'Poster Store,' though when I first noticed it a few years back the 'T' on the sign was
			missing. For months I thought it was some theme store where white suburban kids exclusively 
			bought cassettes detailing cop killing and bitch slapping.\n"
		}

		"The Poster Store sells posters... and little else. There's a hanging flip-rack of posters in the corner of
		the store, and a few hanging up on the walls."


	}

	graphic "mall", "poster_store01"
n_to	{
		return Corridor6
	}

npc_move n_obj
}

LightRoom Sunglasses_Hut "Sunglasses Hut"
{
	prep " the"

	long_desc
	{

		if self is not visited
		{
		"I'm not quite sure why sunglasses and shades are only sold in 'huts' but this store is very un-hut like. 
		There are three very solid walls here and a roof made not of thatch, but poured, cracking cement. 
		The floor is hardly comprised of peat or mud, but the same tile present everywhere else in the Mall.\n"
		}


		"A fair bit of ether has snaked itself into the room. It combines with the hand-picked and market-researched 
		atmospheric lights that still function to give off a very deep, defracted and soothing look to the room. 
		Vibrant purples and deep blues dominate the walls and counters of the Sunglasses Hut.\n"		

		"I worked at this place for a week once when I was fighting with my manager at the D&D store.
		I acquired a little bit of trivia regarding this place (for instance, the center display case will 
		open if it's tapped upon) but nothing useful otherwise."
	}

	graphic "mall", "sunglasses01"

s_to	{
		return Corridor6
	}

npc_move s_obj
} 

LightRoom Candle_Store "Christ's Candles"
{
	prep " "


	long_desc
	{
		"The Candle Store is the second-most picketed store, right after Choad's. It used to be a lot worse when 
		it was a nail and board emporium, though. Some old and independently wealthy latin guy owns the place,
		though, and he just doesn't care about the Cash-In of the Christ.\n"

		"Christ's Candles is decked out in a similar manner to the Bead Store, hippie stuff and dark shadows
		even when the power isn't completely out. This isn't the kind of city where one can set up a number of
		candles on stands like in the video to 'Wrapped Around Your Finger,' so instead all the candles and
		other objects are on shelves."

		if self is not visited
		{
			"\nThere are a number of tiny birthday candles in packages all over the store, but the most 
			impressive display is in the back, where an elegant, if clouded menorah rests upon a 
			long display table."
		}
		else
		{
			"\nThe floorspace towards the rear of the store is completely taken up by the long display table 
			against the western wall."
		}


		if self is not visited
		{
			! Ensure that this plays even if they leave the Candle Store immediately
			! Gibs and Casey should not be with them. 
			Activate(Vision_Second)
		}

		if GameEvents[70] = 0 and GameEvents[30] = 1
		{
			SetQuip(3,25,1)
		}
	}

e_to	{
		SetQuip(3,25,0)
		return Corridor9
	}

npc_move e_obj
}

LightRoom Book_Store "Discount Novel Shoppe"
{
	prep " the"

	long_desc
	{
		LocationState[15] = 1

		if self is not visited
		{
			Activate(Revenant_Speaks)

			"You're supposed to be pumped to enter a book store in a mall.\n"

			"This isn't the case with this one. The novels contained herein are not discounted in terms
			of their cost, they are discounted, rather, in terms of their quality. A few years back there was a fad in
			publishing that resulted in the release of a large number of non-fiction books that were little more
			than paper printouts of 'successful' blog sites. (I say 'successful' in a manner of speaking like
			that, as in my opinion the only \Bsuccessful\b blog site is one that ends with the webcam suicide of 
			its maintainer.)\n"

			"\IEl circo de chamuscarse de la retina\i doesn't stop there. Shitty steampunk, trite 
			Lycanthropian romance novels, pre-civilization thrillers featuring cavemen (well, cavepeople)
			and gimmick dictionaries were all part of the hardcover publishing's switch towards the tactics
			of pop music the last few years. These outright dolorous genres are fully represented here, making
			this place more a library or museum than a boutique.\n"

			"There is an exit to the south."
		}
		else
		{
			if self is visited and Revenant.conscious = 1 and Revenant is villain
			{
				Revenant.peaceful = FALSE
				fight_active = 1
			}
			else
			{
				Deactivate(Revenant_Speaks)
				Activate(Revenant_Speaks)	
			}


			"I hate going in here, but I have apparently been a patron enough times to notice how peculiar the store
			is without its overhead fluorescent spotlights. The low light received from outside produces oddly-angled
			little shadows, albeit (apparently) non-sentient ones.\n"

			"There are two long rows of shelves along the north-south orient of the store, and a cashier's counter
			in back."
		}
	}
	graphic {
			if LocationState[15] = 0 or LocationState[15] = 1
			{

			current_resource_file = "mall"
			current_resource = "novelshop01"

			}

			if LocationState[15] = 2
			{
			current_resource_file = "mall"
			current_resource = "crucify02"
			}

			if LocationState[15] = 3
			{
			current_resource_file = "mall"
			current_resource = "crucify03"
			}

		return -1 
		}



s_to	{
		Deactivate(Revenant_Speaks)

		return Corridor8
	}
}


LightRoom2 Nutrition_Store "Nutrition & Herb Store"
{
! Garlic Store

	prep " the"

	long_desc
	{
		Audrey is following
		Barnaby is following 

		if self is not visited
		{
			ScoreArray[35] = 1

			"The Nutrition Store is dominated by a series of five-foot high shelves that make up four distinct
			aisles. The walls are a sickly shade of green which some junior ad exec no doubt thinks promotes 
			quick sales decisions, when all it truly does is make customers eager to get the hell out before
			they add an equally off-putting color to the surrounding by use of their own acrid vomit.\n"
			
			"In the rear of the store is a modest plastic counter and an ancient analog cash register. Further
			behind that is a closed metal door that really clashes with what's going on otherwise,
			stylistically.\n"

			"There is no front gate to the Nutrition Store, only a ten foot cut in the wall. The opening
			is not quite centered, however, and a 5'x3' pane of glass has been placed into the southern
			wall.\n"
			
			"Exits lead to the southwest and through the door."

			if GameEvents[55] = 0
			{
				GameEvents[55] = 1
				"\n\"There should \Bsurely\b be some garlic here,\" I say to myself..."
			}
		}
		else
		{
			"The Nutrition Store is dominated by a series of five-foot high shelves that make up four distinct
			aisles. The walls are a sickly shade of green and contrast with the subdued nature of the shelves
			and all the jars of pills placed upon them.\n"
			
			"In the rear of the store is a modest wood counter and an ancient analog cash register. Even further,
			behind the counter and register, is a metal door.\n"

			"There is no front gate to the Nutrition Store, only a ten foot cut in the wall. The opening
			is not quite centered, however, and a 5'x3' pane of glass has been placed into the southern
			wall."

			if Duffy is rotting and GameEvents[62] = 1
			{
				if Audrey in location
				{
					"\nAudrey looks at me with a little bit of inquisitive sympathy, but I don't say
					or reveal anything."
				}
			}

			if Duffy is rotting and GameEvents[62] = 0 and mummy is not following
			{
				GameEvents[62] = 1
				CharExclaim(Audrey,ExclaimArray[14])
			}

			if GameEvents[62] = 0 and mummy is following
			{
				GameEvents[62] = 1
				CharExclaim(Barnaby,ExclaimArray[30])

				fight_active = 1

				Mummy.damagepotential = 40
				Mummy.attackadjust = 20

			}
		}
	}

	before
	{
		location YouCanGo
		{
			"There are exits southwest to the Food Court and down (through the door)."
		}
	}

sw_to	{
		if RubbleState[5] = 5
		{
			Activate(Poltergeist_Attacks)
			return Food_Court1
		}
		else
		{
			return Food_Court1
		}
	}

d_to {
		if self is not special
		{
			self is special
			if Audrey in location or Barnaby in location
			{
				"\"I'm going to take a quick look below. Be right back.\""
			}
		}

		return Garlic_Door
	}
}


door Garlic_Door "door"
{
	nouns "door" "basement"
	adjective "steel" "reinforced" "thick" "heavy"
	article "the"
	between Nutrition_Store, Nutrition_Basement1
	is static, not open, not locked, openable, not lockable

	long_desc
	{
		"The door to the basement of the Nutrition Store seems to be made out of a kind of reinforced steel.
		Okay, I don't really know my building materials, but it's really thick and heavy. It's by far the 
		most serious attempt at a door that I've ever seen in the Mall."
	}
}


LightRoom Nutrition_Basement1 "Basement to the Nutrition Store"
{
	prep " the"

	long_desc
	{
		Audrey is not following
		Barnaby is not following 


		if self is not visited
		{

			ScoreArray[36] = 1 

			"I descend the stairs and enter the basement. The air is at least twenty degrees cooler down here than
			it is up above and it has a bit of a tangy, acrid -- almost 'chewy' quality to it. My breath turns into 
			wispy, stringy clouds the instant it leaves my lips and I begin to feel my very bones come across a
			deep chill. I usually prefer winter to summer, so normally I wouldn't be put off by the frost 
			down here and a few bad smells, but there's something different about the chill in the air down here. 
			The temperature of the air seems malevolent, almost.\n"

			"The ceiling of the basement is about five and a half feet high, so I have to lurch over like I'm the
            		hunchback of Notre Dork just to get around. The walls have a very rough texture to them, as if 
	               	they were blasted away and then sanded down in a very half-assed manner.\n" 
			
			"The corridor continues into darkness to the north."
		}
		else
		{
			"The temperature of the air down here in the basement is quite cold, probably no more than thirty 
			degrees Fahrenheit. The ceiling is just over five feet high, and the walls have a very rough texture to
			them, as if they were blasted away and then poorly sanded."
		}
	}
	graphic "mall", "nutrition_basement01"
u_to
	{
		return Garlic_Door
	}

n_to Nutrition_Basement2

}


LightRoom Nutrition_Basement2 "First Basement Corridor"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"The light is very poor in this room, all of it coming from what can seep and pour through the metal door 
			up above. The floor has turned to earth, however, and the walls seem to have a texture wholly different
			from the blasted rock earlier in the corridor. I can't say I'm totally suprised to find this area down
			here below the Mall, as rumor was that the place was built upon some burial grounds. I just never
			knew that they were, in parts, integrated.\n"

			"Exits lead south and further on to the north."
		}
		else
		{
			"This stretch of corridor is little more than a narrow, forgotten passageway. Soft earth makes up the
			floor, a distinct change from the cement seen to the south."

			!Deal with the skulls on the wall
		}
	}

	graphic
	{
		select(LocationState[9])
			case 0
			{
				current_resource_file = "mall"
				current_resource = "nutrition_basement02"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "nutrition_basement0201"
			}

		return -1
	}

n_to Nutrition_Basement3
s_to Nutrition_Basement1
}

LightRoom Nutrition_Basement3 "Coffin Room"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			"The basement ceiling gets much taller in this room, about up to 15 feet or so, I'd guess. At the
			very top is a small torch, which is providing a fair bit of the light in the room -- the rest of it
			is reflected from the coffin in the corner.\n"
			
			"The ground is no longer soft earth, either, but rather blocks of cold stone. The walls are made of
			some kind of brick which reflects a bit of light as well, although nowhere near as well as the coffin.\n"

			"A support beam has been installed next to the coffin. Beyond it, to the right, is a small and very
			dark alcove."
		}
		else
		{
			"The ceiling in this room is unique within the basement, as it is actually enough up where I don't have
			to hunch. ";

			if torch is not special
			{
				"At the top of the ceiling is a single, lit torch, held at a diagonal against the wall
				with a bracket. ";
			}

			"All available light is strongly reflected from the coffin, which sits quietly in the corner of the room.
			The walls are made out of a flecked brick, and a support beam stands to the right of the coffin.\n"

			"Exits are south towards the stairs and east into a tight alcove."
		}
	}

	graphic
	{
		select(LocationState[10])
			case 0
			{
				current_resource_file = "mall"
				current_resource = "nutrition_basement03"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "nutrition_basement05"
			}

		return -1
	}

e_to Nutrition_Basement4
s_to Nutrition_Basement2
}

LightRoom Nutrition_Basement4 "Alcove"
{
	prep " the"

	long_desc
	{
		"I practically have to crawl to get into this little cave-like section cut away from the basement.
		The light is gobbled up from something inside, as nothing from the coffin room manages to get 
		in here.\n"
			
		"The only thing of note here is a very small trestle up against the wall."
	}

	graphic "mall", "nutrition_basement04"


w_to Nutrition_Basement3
}



LightRoom2 Food_Court1 "Food Court"
{
	long_desc
	{
		if self is not visited
		{
		"The Food Court is a vast, open area and I can only see about half of it from here due to the lack of light -- the entire
		western end of it is cloaked in darkness. There are a number of cheap square tables and static plastic chairs bolted
		to the floor here, although a few have somehow broken off and are loose.\n"

		"To the northeast is a Nutrition Store. They carry a large assortment of tabs, pills, drugs and spices. The Court has
		another section to the west, and there is an exit east from where we came."

		CharExclaim(Audrey, ExclaimArray[13])

		Vampire_Script_1
		Casey_Script_1
		}

		else
		{
		"The Food Court is a vast, open area, and I can only make out about half of it from here. (The entire west end is shrouded
		in darkness.)\n"

		"To the northeast is a Nutrition Store. The Court has another section to the west, and there is an exit 
		east from where we originally came."

		}
	}

	prep " the"

	after
	{
		location DoDrop
		{
			Activate(Poltergeist_Attacks)
		}
	}

	before
	{
		location YouCanGo
		{
			"There are exits east (to the corridor), northeast (into the Nutrition Store) and west (to the
			rest of the Food Court)."
		}
	}

	graphic
	{
		select(LocationState[17])
			case 0
			{
				current_resource_file = "mall"
				current_resource = "food_court01"
			}

			else
			{
				current_resource_file = "mall"
				current_resource = "food_court02"
			}

		return -1
	}

e_to	{
		Deactivate(Poltergeist_Attacks)
		return Corridor8
	}


ne_to	{
		Deactivate(Poltergeist_Attacks)
		return Nutrition_Store
	}

w_to	{
		if GameEvents[36] = 1 
		{
			Deactivate(Poltergeist_Attacks)
			return Food_Court2
		}
		else
		{
			"I can't get by the Poltergeist!"
		}
	}

spectre_w_to
	{
		return Food_Court2
	}
}


LightRoom2 Food_Court2 "Food Court"
{
	prep " the"

	long_desc
	{

		"This far section of the Food Court pinches off to a slight, concrete wall extension. There were plans to expand this once,
		by the corporation that owns the Mall, but they now seem forever ago and far away. The rest of the Food Court is to the east,
		and the final corridor leading out of the Mall completely is around a turn to the northwest."


		if self is not visited
		{
			CharExclaim(Vampire, ExclaimArray[1])
		}
	}

	graphic
	{
		select(LocationState[6])
			case 0,1
			{
				current_resource_file = "mall"
				current_resource = "food_court2_01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "food_court2_02"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "food_court2_03"
			}

			case 4
			{
				current_resource_file = "mall"
				current_resource = "food_court2_04"
			}

			case 5
			{
				current_resource_file = "mall"
				current_resource = "food_court2_05"
			}

			case 6
			{
				current_resource_file = "mall"
				current_resource = "food_court_casey01"
			}
		return -1
	}

	before
	{
		location YouCanGo
		{
			"There is an exit east to the other side of the Food Court, and northwest to the last hallway in the Mall."
		
		}
	}


nw_to	{
		if Vampire in location and Vampire.conscious = 1
		{
			"I'll need to defeat the Vampire first."
		}

		else
		{
			return Mall_Exit
		}
	}

e_to	{
		return Food_Court1
	}
}


LightRoom2 Party_Store "Party On Central"
{
	prep " the"

	long_desc
	{

		"This store is mostly unfurnished, with a low, bare ceiling, cold floor covered in cheap carpeting, and blankets and
		rugs thumb-tacked up to hide the peeling wallpaper and crumbling drywall. \n"

		"The contents of the room are a cluttered mess, as this place seems to be more of a craftsman's think-tank and construction
		area than pure chamber for commerce like so many other shops in the Mall. There's a workdesk and mirror along the 
		northern wall and a file cabinet across from it. A small window is visible behind some junk, and directly across
		from the entrance are seven masks attached to the back wall in a proud display. Attached to one of the naked support
		beams is a disco laser pointer."
	}
	before
	{
		location YouCanGo
		{
			"There is an exit west to the Southern Edge of the Mall."
		}
	}
cant_go
	{
		"There is not an exit that way.\n"
		"There is an exit west to the Southern Edge of the Mall."
	}
w_to 
	{
		return Corridor9
	}

s_to
	{
		"The door won't budge. It's locked."
	}

	graphic "mall", "partystore01"
		
npc_move w_obj
}


LightRoom Party_DummyRoom
{
! dummy room
}

door Party_Door
{
	nouns "door" "locked"
	article "the"
	between Party_Store, Party_DummyRoom
	is static, not open, locked, openable, lockable

	long_desc
	{
		"The door is metallic gray, free from windows or bars or anything else of the sort."
	}
	before
	{
		object DoUnLock
		{
			"I have no idea how one \Iwould\i unlock the door. There's certainly nothing present that indicates
			that a key could be used."
		}
	}
}


LightRoom2 Mall_Exit "Mall, First Level, North Edge"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			Move Sydney to location 
			Move Audrey to location 
			Move Barnaby to location
			Move Casey to location

			SetQuip(10,6,0)
			SetQuip(10,7,0)
			SetQuip(10,8,0)

			if MUSIC_OFF = TRUE
			{
			}

				else
			{
				PlayMusic("ndmusic", "blued", sound_volume, false, true)	
			}

			if ghast_head not in Player and ghast_head not in Mall_Exit
			{
				move ghast_head to Mall_Exit
			}


			"We've come to the last long hall. To the north, approximately fifty yards away, are the exit doors. Dawn has yet to creep up
			upon us. It's still pitch black outside. Freedom is all I can think of at this point.\n"

			"I take a single step forward. That's when she materializes.\n"

			"\"Hello, Sydney,\" I say, intentionally agitating the spirit that
			thinks it's in total control.\n"

			"\"Hi there, doll,\" she says in return. \"What happened to her?\" she asks, looking over towards Casey. \"How unfortunate.
			I was hoping to add her soul to my collection, but it looks like that won't be possible.\"\n"

			"\"We have to get out of here before the sun rises. Otherwise she'll die,\" I say. \"Get 
			out of the way.\"\n"

			"\"The door is shut by my command, Jarret. Though I'll confess that the thought of her turning to sawdust as the sun rises
			right before I take each of your lives is especially intriguing. We could do it that way. That's fine with me.\""

			CharExclaim(Audrey,ExclaimArray[10])
		}

		else
		{
			"We are before the last long hall. To the north, approximately fifty yards away, are the exit doors. There are no stores to
			either side of us. ";
			
			if Sydney in location and Sydney.conscious = 1 and GameEvents[7] ~=0
			{
				"An informational kiosk and some planted trees are the only things in between us and the exit. Well, that and the levitating,
				possessed body of one of my friends, natch."
			}
			else
			{
				"An informational kioks and some planted trees line the path, but it is otherwise clear from obstructions.\n"
				"Large, windowed doors provide an exit to the north."
			}

		}
	}
	before
	{
		location YouCanGo
		{
			"There is an exit north to the Parking Lot and southeast to the Food Court."
		}
	}
	graphic
	{

		select(LocationState[19])
			case 0,1
			{
				current_resource_file = "mall"
				current_resource = "lastscene01"
			}

			case 2
			{
				current_resource_file = "mall"
				current_resource = "lastscene02"
			}

			case 3
			{
				current_resource_file = "mall"
				current_resource = "lastscene03"
			}

		return -1
	}


cant_go	{
		"There are exits north and southeast."
	}

se_to	{
		if GameEvents[72] = 0
		{
			return Food_Court2
		}
		else
		{
			"That way leads madness."
		}
	}

n_to	{
		if GameEvents[38] = 0
		{
			"An impenetrable wall of force prevents me from leaving the mall. It's Sydney's doing, of course, or at least that of the
			demon that has possessed her."
		}
		else
		{
			return Parking_Lot
		}
	}
}

LightRoom Parking_Lot "Parking Lot"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{

			Deactivate(Casey_Becomes_Vampire)

			ScoreArray[31] = 1

			if GameEvents[39] = 1
			{
				! It's too late -- there is sunlight. Casey dies.
				! Do not make them try to get into the car, chapter ends here.

				Casey_Dies_1()
			}
			elseif (GameEvents[39] = 0) and (bloodbag in Spectre)
			{
				!Description that they made it out
				!Note that the car is there
				!Casey stirs just a bit
				!It is not sunny out

				Casey_Lives_1()

			}
			elseif (GameEvents[39] = 0) and (bloodbag not in Spectre)
			{
				! It's too late -- there is sunlight. Casey dies.
				! Do not make they have to get into the car. End the chapter.

				Casey_Dies_1()
			}
		}
		else
		{
			! Take care of the one turn here
			Casey_Lives_1()

		}
	}			
			
			
}

LightRoom Block_Store
{
! Only exists for the spectre


n_to 
	{
		return Corridor9
	}


npc_move n_obj
}

LightRoom Shoe_Store
{
! Only exists for the spectre


n_to 
	{
		return Corridor8
	}

npc_move n_obj
}


!!!!!!!!!!!!!!! Chapter Four


LightRoom BackOffice "Back Office"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{

			"I enter the back office hand-first, groping for the light switch. I find it, but flipping it has no effect.
			This act is not lost on Gibs.\n"

			"\"Good work, there, Tesla,\" he says, albeit rather quietly. \"The electricity is out everywhere.\"\n"

			"It takes a moment, but our eyes adjust to the darkness. The back office is made up of a number of shelves
			which hold boxes of 'Magic' game cards, and other stock we don't want out by the customers. There's barely
			enough room for two people to stand side-by-side here.\n"

			"\"Trott's not here...\" I say to Gibs.\n"

			"Gibs doesn't say anything. I turn back to look at him and his face has blanched. He snaps out of
			it but doesn't look at me. He points ahead and whispers, \"Look at the window to the door, Duffy...\""
		}
		else
		{
			"The back office is a cramped and tight little room with shelves on both sides.\n"
			"There are two exits, one back to the store and one that leads to the garbage hall (and
			eventually, beyond that, to the security area)."
		}
	}
	graphic "mall", "backoffice01"


w_to	{
		return BackOffice_door
	}

n_to	{
		return BO_Hall1_door
	}


}


LightRoom BackOffice_Hall1 "Garbage Hall"
{
	prep " the"

	long_desc
	{
		BO_Hall2_door.noun #3 = "lounge"

		if self is not visited
		{
			"Gibs and I enter the long hallway that sits behind a number of stores. It's here to allow us
			to drop off whatever cardboard and trash we accumulate during the day for janitorial services. 
			I know from memory that there is a door on the east side that opens into a sort of mini-lounge
			for the mallcops, but there isn't enough light to really make it out very well."

		}
		else
		{
			"This is a long hallway that sits behind a number of stores. The store owners and workers put
			their trash in this hallway for janitorial services. There is a door to the security lounge to 
			the east and a door to the back office of Benji's store to the south."
		}
	}
	graphic "mall", "backoffice_hall1"

e_to	{
		return BO_Hall2_door
	}
	
s_to	{
		return BO_Hall1_door
	}
}


LightRoom BackOffice_Hall2 "Mallcop Lounge"
{
	prep " the"

	long_desc
	{
		BO_Hall2_door.noun #3 = ""

		if self is not visited
		{
			LocationState[14] = 0	! Reset this 

			! What did you expect the lounge to look like?
			SetQuip(2,12,1)

			! Kill the quip about the handprint 
			SetQuip(2,15,0)

			"The Lounge is far more spacious than the last few areas, and has enough room for a couple of couches,
			a television, a big plant, and a water cooler.\n"
			
			"On the far side of the room is a door which leads to a long walkway (on the other side of which, I think,
			is the actual Mall Security headquarters)."

			CharExclaim(Barnaby, ExclaimArray[10])
		}
		else
		{
			LocationState[14] = 0

			"The Lounge is a largish, open room with a high ceiling. There are a couple of old couches here, along with
			a television";

			if Mallcop_pot in location
			{
			", water cooler and plant life of unknown make and origin.\n"
			}
			else
			{
			" and a water cooler.\n"
			}

			"Exits lead north and west."
		}
	}
	graphic
	{
		select(LocationState[14])
		case 0
			{
				current_resource_file = "mall"
				current_resource = "backoffice_hall2"
			}

		case 1
			{
				current_resource_file = "mall"
				current_resource = "dayna02"
			}

		return -1
	}


w_to	{
		SetQuip(2,12,0)

		return BO_Hall2_door
	}

n_to	{
		SetQuip(2,12,0)

		return BO_Hall3_door
	}	
}


LightRoom2 BackOffice_Hall3 "Mall Back Hallway"
{
	prep " the"

	long_desc
	{
		if self is not visited
		{
			! Remove the one about Jarret's virginity 
			SetQuip(2,13,0)

			"This hallway is strangely shaped, and we are unable to make out everything within it. On the far
			side of the hall is a door that leads to the Security Room, but I can only barely make it out from
			here. The only real items in the room are a pair of doors and a large garden-variety plant in the corner.\n"

			"There is no transparent moon roof or anything in this room, so Gibs sticks his lacrosse stick up
			against the door so that we get light from the Lounge.\n"

			"\"Do you think Trott got into the Security Room?\" asks Gibs. \"Do you think he made it this far?\""

			move lacrosse_stick to BO_Hall3_door

			SetQuip(2,16,1)
			SetQuip(2,17,1)
			SetQuip(2,18,1)

			Activate(Zombie2_Appears)
		}
		else
		{
			"This is an oddly-shaped hallway that connects the Lounge with the Security Room. There are doors
			that lead to both rooms."

			if GameEvents[17] = 0 
			{
				GameEvents[17] = 1 
				SetQuip(8,11,1)
			}
		}
	}
	graphic
	{
		select(LocationState[8])
		case 0,1
			{
				current_resource_file = "mall"
				current_resource = "backoffice_hall3_01"
			}


		case 2	
			{
				current_resource_file = "mall"
				current_resource = "backoffice_hall3_02"
			}


		case 3	
			{
				current_resource_file = "mall"
				current_resource = "backoffice_hall3_03"
			}

		case 4	
			{
				current_resource_file = "mall"
				current_resource = "backoffice_hall3_04"
			}


		else	
			{
				current_resource_file = "mall"
				current_resource = "backoffice_hall3_01"
			}


		return -1
	}

	before
	{
		location YouCanGo
		{
			"There are exits to the north and south from here."			
		}
	}
n_to	{
		return BO_Hall4_door
	}

s_to	{
		if Zombie2 not in Backoffice_Hall3 and GameEvents[47] = 0
		{
			"I go to exit the room when Gibs places his hand on my shoulder.\n"

			"\"Wait, Duffy... wait -- what the fuck is that in the corner?\""
		}

		else
		{
			return BO_Hall3_door
		}
	}
}


LightRoom Security_Far "Outside"
{
	prep " the"

	long_desc
	{
		"This is a small section of real estate outside the Mall."
	}
}


LightRoom Security_Room "Security Room"
{
	prep " the"

	long_desc
	{
		ScoreArray[8] = 1

		if self is not visited
		{
			if Barnaby.conscious = 0
			{
				"Barnaby gets up slowly and dusts himself off. \"Uuuurf,\" he says quietly.\n"
			}

			Barnaby is following
			Barnaby.hitpoints = Barnaby.maxhitpoints 

			"We open the door and see Trott bolt right up from his chair.\n"
			"\"Oh, geez... thank Christ it's you guys. Wait, did you get past that -- \"\n"
			"\"Yeah, we did,\" I say. \"I think we killed it.\"\n"
			"I take a look around the room. There's a big console against the west wall which controls the gates,
			electricity and breakers for all the shops in the Mall. I imagine that Trott has been trying to get
			it operational for sometime now."
		}
		else
		{
			"The Security Room is where all the mallcops normally hang out and take calls regarding shoplifters,
			loiterers, unruly customers and, if you happen to be Benji, where they are made aware of the presence
			of any and all minorities.\n"

			"There is a console up against the west wall, and a set of lockers and a counter on the other side.
			The lone exit leads south."

			if remote_nurse in Security_Room
			{
				Activate(Nurse_Screeches)
			}
		}
	}

	graphic
	{
		select(LocationState[13])
		case 0
			{
				current_resource_file = "mall"
				current_resource = "securityroom01"
			}


		case 1	
			{
				current_resource_file = "mall"
				current_resource = "security_nurse01"
			}

		case 2
			{
				current_resource_file = "mall"
				current_resource = "security_nurse02"
			}
		return -1
	}

s_to	{
		

		Deactivate(Nurse_Screeches)

		return BO_Hall4_door
	}

}


door BO_Hall1_door "first corridor door"
{
	nouns "door" "hall" "hall" "office" "corridor"
	adjective "hall" "garbage" "first"
	article "the"
	between BackOffice_Hall1, BackOffice		! Back Office & Garbage Hall
	is static, not open, not locked

}


door BO_Hall2_door "second corridor door"
{
	nouns "door" "hall" "lounge" "corridor"
	adjective "hall" "garbage" "mallcop" "second"
	article "the"
	between BackOffice_Hall1, BackOffice_Hall2	! Garbage Hall & Security Lounge
	is static, not open, not locked

}


door BO_Hall3_door "lounge door"
{
	nouns "door" "hallway" "lounge" 
	adjective "hallway" "mallcop" "mall" "lounge"
	article "the"
	between BackOffice_Hall2, BackOffice_Hall3	! Mallcop Lounge & Mall Back Hallway
	is platform, static, not open, not locked

!\

asdasd

	before
	{
		object DoOpen
		{
			if (((self is locked) and (self is not open)) and (Barnaby.conscious = 1))
			{
				if GameEvents[10] = 0 and Zombie2 in location and Zombie2.conscious = 1 
				{
					GameEvents[10] = 1 
					"\"It's locked!\" I yell over to Gibs. \"I can't get it open!\""
				}

				if GameEvents[10] = 1 and Zombie2 in location and Zombie2.conscious = 1 
				{
					"It's locked or something -- I can't open it!"
				}
				else
				{
					"It's locked."
				}
			}
			else
			{
				self is open
			}
		}
	}
\!


}


door BO_Hall4_door "security room door"
{
	nouns "door" "hallway" "security" "room"
	adjective "hallway" "room" "back" "mall" "security"
	article "the"
	between BackOffice_Hall3, Security_Room		! Mall Back Hallway & Security Room
	is static, not open, locked, not special 

	before
	{
		object DoKnock
		{
			if self is not special 
			{
				if GameEvents[11] = 0
				{
					"Nothing happens."
				}
				else
				{

					if SOUND_OFF = TRUE
					{
					}
					else
					{
						PlaySound("ndmusic", "knocking", sound_volume, false, true)	
					}

					self is special
					self is not locked
					"After a brief pause, I hear a \"klitch!\" sound come from the Security Room door, 
					around where the lock is located."
				}
			}
			else
			{
				"I pound on the door to the Security Room, but nothing happens."
			}
		}
	}

}


door BackOffice_door "back office door"
{
	nouns "door" "office" "room"
	adjectives "back" "office" "door" "room"
	article "the" 
	between Mallstore1, BackOffice
	is static, not open, locked

	long_desc
	{
		
		"The back office door is extremely aged and flaking. The door is currently ";

		if (self is not open) and (self is not locked)
		{
			"closed, but unlocked."
		}

		elseif (self is open) and (self is not locked)
		{
			"open and unlocked."
		}
		elseif (self is not open) and (self is locked)
		{
			"closed and locked."
		}
		elseif (self is open) and (self is locked)
		{
			"opened, but the lock is set."
		}
	}
	
	before
	{
		object DoHit, DoShoot
		{
			"The back office door is covered in decades-old lead paint which gives it advanced armor
			against any attack I could strike it with."
		}

		object DoKnock
		{
			"Nothing answers."
		}

		object DoOpen
		{
                
                        if self is open
                        {
                                "It's already open."
                        }
                        else
                        {
                                return false
                        }
                }

                object DoClose
                {
                        if self is not open
                        {
                                 "It's already open."
                        }
                        elseif self is open and self is locked
                        {
				"It needs to be unlocked first so that it will catch correctly."
                        }
			else
			{
				return false
			}
                }

                object DoLookThrough
                {
                        if (location = MallStore1) and self is open
                        {
                                "The back office is on the other side. I don't see anything of note"
                        }
                        elseif (location = BackOffice) and self is open
                        {
                                "Through the door is the rest of the store."
                        }
			else
			{
				"It's closed; I can't look through it."
			}
                }
		object DoSearch
		{
			move paint_chips to MallStore1
			{
				"I see that there are some paint chips on the ground when I take a closer look around."
			}
		}
	}
	after
         {
                object DoOpen
                {
                        "Okay, the door is now open."
                }
                object DoClose
                {
                        "The door to the back office is now closed."
                }
         }
}



routine Reset_Quips
{

! Audrey
SetQuip(3,1,1)
SetQuip(3,2,1)

! Pang
SetQuip(4,1,1)

! Criswell
SetQuip(5,1,1)

! Trott
SetQuip(8,1,1)
SetQuip(8,2,1)


! Revenant
SetQuip(27,1,1)
SetQuip(27,2,1)


}

!----------------------------------------------------------------------------
!----------------------------------------------------------------------------

routine set_screen
{
	UpdateInvWindow()
	UpdateGraphicsWindow(location)

	! Here, check to see if any objects need to be depicted in the graphics window
	Obj_UpdateGraphicsWindow(object)

	UpdateFaceWindow(Duffy)
	UpdateOpponentWindow(object)
	UpdateBorderWindow()
	
	!UpdatePartyWindow()
}



window_class graphics_window 
{
	! The graphics window is the left-top rectangle of the screen:
	! (Its aspect ratio is slightly wider than 1.66:1 on a standard
	! 80x25 screen.)

	win_left 1
	win_top
		return 1 + display.statusline_height
	win_right
		!return 60
		return 58

	win_bottom
		return 20
		!return display.screenheight * 5/10 - 2
	win_textcolor BRIGHT_WHITE
	win_backcolor BLACK
}

window_class face_window 
{
	! The graphics window is the left-top rectangle of the screen:
	! (Its aspect ratio is slightly wider than 1.66:1 on a standard
	! 80x25 screen.)

	win_left 59

	win_top
		return 1 + display.statusline_height
	win_right
		return 77

	win_bottom
		return 20

	win_textcolor BRIGHT_WHITE
	win_backcolor BLACK
}

window_class opponent_window
{

	win_left 78

	win_top 
		return 1 + display.statusline_height

	win_right
		return 96

	win_bottom
		return 20

	win_textcolor BRIGHT_WHITE
	win_backcolor	BLACK
}

window_class party_window
{
	win_left 1
	win_top
		return 21
	win_bottom 
		return 29

	win_right 
		return display.screenwidth

	win_textcolor	BRIGHT_WHITE
	win_backcolor	BLACK
}

window_class border_window
{
	win_left 1

	win_top 21

	win_right 
	{
		! Put this in here to ensure that the toolbar stays left-justified.

		if display.screenwidth > 160
		{
			return 160
		}
		else
		{	
			return display.screenwidth
		}
	}

	win_bottom 22
}


window_class inv_window 
{
	! The graphics window is the left-top rectangle of the screen:
	! (Its aspect ratio is slightly wider than 1.66:1 on a standard
	! 80x25 screen.)

	win_left 95
	win_top
		return 1 + display.statusline_height
	win_right
		return display.screenwidth
	win_bottom
		return 20

	win_textcolor BRIGHT_WHITE
	win_backcolor BLACK
}

routine UpdateGraphicsWindow(obj)
{
	! SL_... settings copied from Init in gb.hug (duplicated here
	! in case the engine changes display.hasgraphics during play)
	if not display.hasgraphics
	{
		SL_TEXTCOLOR = DEF_SL_FOREGROUND
		SL_BGCOLOR = DEF_SL_BACKGROUND
		return
	}
	else
	{
		SL_TEXTCOLOR = BRIGHT_WHITE
		SL_BGCOLOR = BLACK
	}

	if last_drawn_picture = obj and not force_repaint
		return

	if not obj.graphic and obj ~= 0         ! 0 forces window clearing
		return

	run graphics_window.win_init
	window
	{
		if obj.graphic ~= -1
		{
			current_resource_file = obj.graphic #1
			current_resource = obj.graphic #2
		}
		picture current_resource_file, current_resource
	}
	run graphics_window.win_end

	last_drawn_picture = obj
	force_repaint = true

}

routine Obj_UpdateGraphicsWindow()
{
	if object = window_backoffice
	{
		UpdateGraphicsWindow(window_backoffice)
	}

	if object.graphic
	{
		UpdateGraphicsWindow(object)
	}

return
}

routine UpdateFaceWindow(obj)
{
	! SL_... settings copied from Init in gb.hug (duplicated here
	! in case the engine changes display.hasgraphics during play)
	if not display.hasgraphics
	{
		SL_TEXTCOLOR = DEF_SL_FOREGROUND
		SL_BGCOLOR = DEF_SL_BACKGROUND
		return
	}
	else
	{
		SL_TEXTCOLOR = BLACK
		SL_BGCOLOR = BRIGHT_WHITE
	}

	if last_drawn_picture = obj and not force_repaint
		return

	if not obj.facepic and obj ~= 0         ! 0 forces window clearing
		return

	run face_window.win_init
	window
	{
		if obj.facepic ~= -1
		{
			current_resource_file = obj.facepic #1
			current_resource = obj.facepic #2
		}
		picture current_resource_file, current_resource
	}
	run face_window.win_end

	last_drawn_picture = obj
	force_repaint = true
}

routine UpdateOpponentWindow(obj)
{
	! SL_... settings copied from Init in gb.hug (duplicated here
	! in case the engine changes display.hasgraphics during play)
	if not display.hasgraphics
	{
		SL_TEXTCOLOR = DEF_SL_FOREGROUND
		SL_BGCOLOR = DEF_SL_BACKGROUND
		return
	}
	else
	{
		SL_TEXTCOLOR = BLACK
		SL_BGCOLOR = BRIGHT_WHITE
	}

	if last_drawn_picture = obj and not force_repaint
		return

	if not obj.opponentpic and obj ~= 0         ! 0 forces window clearing
		return

	run opponent_window.win_init
	window
	{
		if obj.opponentpic ~= -1
		{
			current_resource_file = obj.opponentpic #1
			current_resource = obj.opponentpic #2
		}
		picture current_resource_file, current_resource
	}
	run opponent_window.win_end

	last_drawn_picture = obj
	force_repaint = true
}

routine UpdatePartyWindow()
{
	run party_window.win_init
	window
	{
		"\BJarret Duffy\b"
		"\BBarnaby Gibs\b"
		"\BAudrey Case\b"
		"\BTrott\b"
	}
	run party_window.win_end
}


routine UpdateBorderWindow()
{
	run border_window.win_init
	window
	{
		picture "mall", "picline06"
	}
}


routine UpdateInvWindow()
{

	run inv_window.win_init
	window
	{
	}
	run inv_window.win_end
}
	

#include "chars.h"		!characters

array Characters[NUMCHARACTERS] = testzero, Duffy, Barnaby, Audrey, Pang, Criswell, Tericho, Clerk, Trott, Zombiebot, Sydney, Casey, Randolph, Skeleton, Ghoul, Shadow, Ghast, Mummy, Spectre, Vision, Poltergeist, Vampire, Zombie2, Leary, Wraith, Lum, Zombiebot2, Revenant, Nurse, Magic_Mouth, Dead_Girl


LightRoom placeholder "placeholder"
{
	graphic "mall", "king-gibs03"

}


!=====================================================================
! Classes
!=====================================================================

routine Switch_Chapter(ChapNum)
{
local i, c, j 


Chapter = ChapNum

select(ChapNum)
	case 2:
		{
			"\n"

			pause

			window 0

			if MUSIC_OFF = TRUE
			{
			}

			else
			{
				PlayMusic("ndmusic", "casio", sound_volume, false, true)
			}			

			cls
	
			picture "Mall", "ndrift-title03"

			pause

			cls 

			move Neon to Driveway

                       for i in player
                        {
                                c++
                        }

                        if c ~= 0
                        {
                           while c > 0
                                {
                                    for i in player
                                    {
	                                    j = i

                                    }

                                    remove j 
                                    c--
				}
			}



			for i in Duffy 
			{
				!print i.name
				remove i

			}

			move glasses to Duffy
			glasses is worn

			! The messed-up hair picture of Duffy
			GameEvents[14] = 8

			Pang is not following
			Criswell is not following
			Barnaby is not following
			Zombiebot is not following

			Duffy.hitpoints = Duffy.maxhitpoints

			Barnaby.hitpoints = Barnaby.maxhitpoints

			! Get rid of Pang and Barnaby's previous quips
			SetQuip(4,1,0)	! Pang
			SetQuip(5,1,0)	! Criswell

			! Set their new quips
			SetQuip(4,2,1)
			SetQuip(4,3,1)

			SetQuip(5,2,1)

			! Zombie's picture
			GameEvents[75] = 1

			
			"I've only been on, really, truly \Ion\i... once in my life.\n"

			"It was about five years ago. The first week of March. The Wizards of the Coast (the company that publishes all
			the D&D books these days) were sponsoring a huge, two-day tournament in the Fort. I signed up for it with 
			Barnaby, who used to be more into this kind of thing back then, and we started gaming it on a Saturday 
			morning.\n"

			"It wasn't a 'competitive' tournament, per se, especially since around that time the two local gangs of Korean 
			role players had pretty much wiped each other out when an on-line housing refresh dispute went from the virtual 
			world of the internet to the physical one of reality, resulting in thirteen dead and seven wounded. That would 
			have normally taken the edge off for the rest of us for the whole of the weekend, but we soon found out that 
			WotC were putting up an eight-thousand dollar first prize for the weekend's 'Most Outstanding Roleplayer.' When 
			I found that out, something clicked inside me, and I drew from a strength of personality I didn't know I had.\n"

			"All day the dice were with me. Just about every time I threw a twenty-sided die I got an incredibly favorable 
			result. I started getting a bit more bold and soon found that the other kids at my table started \Ifollowing\i 
			me. Looking to me for direction, for decisions, for witticisms. I became bolder and overly gregarious. I hardly 
			needed any of the booty the game's Dungeon Master was giving us in-game, and won over the entire table through 
			generosity. I was confident and having fun being \Ime\i for the first time ever.\n"


			"My luck stayed with me when I went to different tables and played with different people. When the tournament 
			finished the next day, I was awarded the top prize and a check for $8,000. I accepted it graciously and thanked 
			everyone I played with for giving me the chance to shine. As Barnaby and I were rounding up our backpacks and 
			bags of dice, I Xeroxed a copy of my character sheet, signed my name and phone number to it, and gave it to 
			the cutest girl who seemed single during the event, someone I had played with on the first day.\n"

			"When I got home, I spent the entire check on a car and a new wardrobe. I had nothing left of it by Tuesday.\n"

			"Audrey didn't call the number on the sheet, maybe because it was a pompous act of nigh-Olympic level. But when 
			she dropped by the Mall later that week I asked her out on a date. She said yes and has been in various states of 
			flabbergastation with me over the years that have followed.\n"
	
			"I got my car, clothes and relationship within a lucky streak that lasted 48 hours five years ago. And 
			I've been living off that success ever since. I'd confess that in my darker moments, when I am at my most 
			honest, it rather spooks me to know that I have essentially been stagnant ever since.\n"

			pause


			! Remove this for the actual game, of course
			!Endflag = 1
			! Remove this for the actual game, of course

			Move Pang to blue_couch			

			MovePlayer(Living_Room)
		
	
			Activate(Audrey_Arrives)

		}

	case 3:
		{
			"\n"

                       for i in player
                        {
                                c++
                        }

                        if c ~= 0
                        {
                           while c > 0
                                {
                                    for i in player
                                    {
	                                    j = i

                                    }

                                    remove j 
                                    c--
				}
			}



			for i in Duffy 
			{
				!print i.name
				remove i

			}

			move glasses to Duffy
			glasses is worn


			pause

			window 0

			if MUSIC_OFF = TRUE
			{
			}

			else
			{
				PlayMusic("ndmusic", "MoroseEncounters", sound_volume, false, true)	
			}

			cls
	
			picture "Mall", "ndrift-title04"

			pause

			cls 

			! This line is only for testing. 
			! move nailgun to Mallstore3


			"I'm still rather pissed off when I pull up into the Mall parking lot and showroom park my car. What
			kind of game is Audrey playing here? Surely she's bluffing. We've gone to Defcon 2 or maybe 3 before,
			but we were always able to talk one another down before the bombshells were dropped.\n"

			"I didn't want to have to go into work tonight worrying about this kind of crap. My job becomes a
			lot easier when I'm able to turn off the parts of my mind that don't deal with twenty-sided dice,
			Player's Handbooks and noticing customer body odor. The greatest curse you can inflict upon someone
			who works at the Mall is getting them to fret.\n"

			"(And the greatest curse you can inflict upon yourself while at the Mall is to attempt to stop smoking.
			I seriously picked a bad week for it.)\n"

			"I walk down to the east end of the Mall, avoid the guy taking surveys, and enter my store."

			pause

			! Remove this for the actual game, of course
			!Endflag = 1
			! Remove this for the actual game, of course

			! Make it so that Duffy can't leave the Bead Store
			GameEvents[8] = 1

			! Change Audrey's picture to the sexy jacketless one
			GameEvents[41] = 1 

			! Change Duyffy's pic back to the first one

			GameEvents[14] = 0

			! Zombie's picture
			GameEvents[75] = 0

			MoveOnto(Gamestore_Counter, postcard)
			MoveInto(Gamestore_Counter, Magic_Cards)

			Audrey is not hidden

			Move Audrey to Corridor3

			Move Barnaby to Corridor1

			Pang is not following
			Barnaby is not following
			Criswell is not following
			Audrey is not following

			choadgate is not open
			choadgate is not openable

			MovePlayer(MallStore1)

			move lacrosse_stick to Barnaby

			! Set Barnaby's Quips
			SetQuip(2,1,0)
			SetQuip(2,2,0)
			SetQuip(2,3,0)
			SetQuip(2,4,0)
			SetQuip(2,5,0)
			SetQuip(2,6,0)

			! Set Audrey's Quips
			SetQuip(3,1,0)
			SetQuip(3,2,0)
			SetQuip(3,3,0)
			SetQuip(3,4,0)
			SetQuip(3,5,0)
			SetQuip(3,6,0)
			SetQuip(3,7,0)
			SetQuip(3,8,0)
			SetQuip(3,9,0)

			SetQuip(3,51,1)
			SetQuip(3,52,1)

			! Set Casey's Quips
			SetQuip(11,5,1)

			! Set Sydney's Quips 

	
		}

	case 4:
		{
			"\n"

			GameEvents[69] = 1	! get the skeleton's new picture

			pause

			window 0

			if MUSIC_OFF = TRUE
			{
			}

			else
			{
				PlayMusic("ndmusic", "motherplucker", sound_volume, false, true)	
			}

			cls
	
			picture "Mall", "ndrift-title05"

			pause

			cls 

			"Gibs drags me out of the Bead Store as I try to plead with Sydney (or whatever is possessing her) to use
			anybody else as her template tonight, to give us back our friend, to let us all go. The room just keeps getting
			colder, and my words and breath form puffy clouds that fall short of reaching her. She never wavers in her 
			silent smirk.\n"
			
			"We leave the Bead Store and collect ourselves out in the foyer. Most of the lighting in the Mall is now 
			completely gone; lit instead by the moon through the skylights.\n"

			"\"Fuck this fucking mall,\" says Gibs. \"Let's go get Trott and get the fuck out of here. Jesus Fucking
			Christ.\"\n"

			"\"I don't think we can just leave,\" says Audrey.\n"

			"\"Why not?\"\n"

			"\"The thing that possessed Sydney said that the Mall will be governed by the arbitrary rules she found
			floating about in my head,\" I say. \"With the showing of the skeleton, I think she means the undead rules.\"\n"

			"\"What undead rules?\" asks Gibs. \"What are they, specifically? Which undead are we going to encounter?
			What will they act like?\"\n"

			"\"Who \Iare\i all you people?\" says Casey in a voice like Gibs's, making fun of all his questions.\n"

			"\"There's a progression,\" I say. \"In the D&D undead table, it goes skeleton, zombie, ghoul, shadow, ghast 
			or wight, wraith, mummy, spectre, vampire, ghost, lich... and then 'special.'\"\n"

			"Gibs reflects on that for a couple seconds. \"Ah. Sure. Special like Special Olympics, or -- \"\n"

			"\"Special like they can kill with a scream or single touch.\"\n"

			"\"Yeah.\" Gibs shrugs. \"I guess that's pretty special.\"\n"

			"\"Wait,\" says Casey. \"Do you hear that? There's something groaning out there, in that direction.\" She points
			to the west. \"Can you guys hear it? It sounds like there's a lot of them.\"\n"

			"\"I'll get us out of here,\" I say, quietly. I don't know if the others are paying attention to me. \"I'll
			keep us all safe...\"\n"			


			Ghast.noun #2 = "randolph"

			Sydney.noun #2 = "ghost"
			Sydney.noun #3 = "demon"
			Sydney.noun #4 = "spirit"

			mall_smoke.found_in #1 = Corridor3
			mall_smoke.found_in #2 = Corridor2
			mall_smoke.found_in #3 = Corridor1


			Move Audrey to Corridor3
			Move Casey to Corridor3
			Move Barnaby to Corridor3
			Move Trott to Security_Room

			MoveOnto(garlic_trestle, garlic)


			!UpdateOpponentWindow(testzero)

			remove Randolph

			move ghast to Corridor5

			MovePlayer(Corridor3)

			LocationState[7] = 4
			LocationState[3] = 10 

			Barnaby is following

			Casey is not following
			Audrey is not following

			Pang is not following
			Criswell is not following

			BackOffice_door is not locked 
			BackOffice_door is not open

			Activate(Gibs_Duffy_Leave_Mallstore3)

			Corridor2 is visited

			GameEvents[5] = 1

			! Set Audrey's picture to be the jacketless one (this is also done for Chapter Three) 
			GameEvents[41] = 1 

			! This is used to have Gibs say (once) that Corridor4 is the wrong way...
			GameEvents[44] = 1 

			! This should be set in Chapter Three, but for testing Chapter 4, it's nice to have them here
			LocationState[12] = 3 


			!Add a quip for Gibs
			SetQuip(2,14,1)

			! Set Audrey's Quips
			SetQuip(3,1,0)
			SetQuip(3,2,0)
			SetQuip(3,3,0)
			SetQuip(3,4,0)
			SetQuip(3,5,0)
			SetQuip(3,6,0)
			SetQuip(3,7,0)
			SetQuip(3,8,0)
			SetQuip(3,9,0)



			!Add the spirit's quips
			SetQuip(10,6,1)
			SetQuip(10,7,1)
			SetQuip(10,7,1)

			SetQuip(10,1,0)
			SetQuip(10,2,0)
			SetQuip(10,3,0)
			SetQuip(10,4,0)
			SetQuip(10,5,0)			

			!Ensure that Trott's quips are set right
			SetQuip(8,1,0)
			SetQuip(8,2,0)
			SetQuip(8,3,0)

			SetQuip(8,4,1)
			SetQuip(8,5,1)
			SetQuip(8,6,1)
			SetQuip(8,7,1)

			!Spectre's
			SetQuip(18,1,1)
			SetQuip(18,2,1)
			SetQuip(18,3,1)
			SetQuip(18,4,1)

			! Magic Mouth's
			SetQuip(29,1,1)
			SetQuip(29,2,1)
			SetQuip(29,3,1)

			MoveInto(Coffin, Mummy)
			MoveInto(Coffin, Bloodbag)
			MoveOnto(Coffin, coffin_lid)


			setscript[Script (Spectre, 5)] = &CharMove, 0, &CharMove, 0, &CharWait, 0, &CharMove, 0, &LoopScript, 0

			!Remove for Game
			!Endflag = 1
			!Remove for Game

		}

	case 5:
		{
			"\n"
			pause
			window 0
			cls
			picture "Mall", "ndrift-title06"
			pause
			window 0
			cls 
			"\n\n\n\n\IFour months later...\i"
			pause
			window 0
			cls

			PlayMusic("ndmusic", "ambertide", sound_volume, false, true)

			for i in player
                        {
                                c++
                        }

                        if c ~= 0
                        {
                           while c > 0
                                {
                                    for i in player
                                    {
	                                    j = i

                                    }

                                    remove j 
                                    c--
				}
			}



			for i in Duffy 
			{
				!print i.name
				remove i

			}

			move glasses to Duffy
			glasses is worn


			if Casey.hitpoints = -101
			{
				"I thought the five of us ";
			}
			else
			{
				"I thought the six of us ";
			}


			"would have difficulties explaining what happened in the Mall right after the incident. I thought there 
			would be questions, interrogations, solicitors and then time in locked rooms downtown before good
			cops gone bad, and then thrown off our case, but at the last second rehired because they always got
			results.\n"

			"But there was none of that. Not so much as a single arched eyebrow. Electricity had been restored
			when I sheepishly returned a few days later for my next shift. The bodies were removed, either when the
			ghost vanished or by carry-out after the fact. I never found out because I was too much of a coward to
			ever research what officially happened to them.\n"

			"It was easy to not get into a nervous furor about things with my friends because I hardly saw any of
			them afterwards. Gibs treated missing his shift that night as a power ploy and ended up getting promoted
			and the afternoon drive-time slot. ";

			if Casey.hitpoints > 0
			{
				"Casey disconnected her phone and blocked me on ICQ. ";
			}

			"Sydney I only ever saw through Audrey, and Audrey moved to Texas at me a week after what went down in the Mall.
			I mean, \Bright\b at me. (If it could be said that someone could aggressively move 'at' somebody, I mean. 
			If that's possible, then that's definitely what Audrey did.) Trott was the only one of the group that I ever 
			encountered with any regularity, and that was because we worked together. We never spoke about that night.\n"

			"But after four days of living with the spectre of the night figuratively breathing a chilling ulcer into
			my bones I decided that it was time that we did."

			pause

			move Trott to EpilogueStore
			!Remember to remove all of Trott's quips as well
			SetQuip(8,13,1)


			Pang is not following
			Criswell is not following
			Barnaby is not following
			Audrey is not following
			Trott is not following
			Sydney is not following
			Mummy is not following
			Casey is not following

			! Duffy's pic
			GameEvents[14] = 6

			
			! Trott's pic
			GameEvents[73] = 1

			
			!Set them for Gibs
			GameEvents[74] = 1
			SetQuip(2,22,1)
			SetQuip(2,23,1)
			SetQuip(2,24,1)
			! Remove virgin line
			SetQuip(2,21,0)	


			!Set them for Zombiebot2

			SetQuip(26,1,1)
			SetQuip(26,2,1)
			SetQuip(26,3,1)
			SetQuip(26,4,1)

			!Turn off some for Trott

			SetQuip(8,1,0)
			SetQuip(8,2,0)
			SetQuip(8,3,0)

			Duffy.hitpoints = Duffy.maxhitpoints

			Deactivate(Water_Flows_Away)

			remove water_1

			Deactivate(Casey_Becomes_Vampire)

			MovePlayer(EpilogueStore)
		}

}



!=====================================================================
!=====================================================================
routine DoTalk
{
local x, y, z, ok = 0

   if (object.charnumber = 1)
	{
	"I'm listening."
	return true
	}

   if (object is paralyzed)
	{
	CArt(object)
	print " can't really communicate in any way other than drooling due to the paralysis, and even with that
	not much can be transmitted other than, \"Heya. I'm drooling.\""

	return true
	}


   if (object is not living) and (object is not talkable)
	{
	"I can't speak to that!"
	return true 
	}

   if (object = human_skull)
	{
		if fight_active = 0
		{
			"\"Alas, poor Yorick! I knew him, Horatio...\""
		}

		else
		{
			"The skull's got no advice on this one."
		}
		return true
	}

   if (object.conscious = 0)
	{
	CArt(object)
	print " isn't in any shape to talk to anyone."
	return true
	}
   if (object.peaceful = false)
	{
	CArt(object)
	print " is way too pissed off to talk to me right now."
	return true
	}

! Count up all the lines by previous characters.
   if (object.charnumber > 0)
	{
	for (x=0; x < object.charnumber; x++)
		{
			y = (y + quips[x])
		}
	}


! Check and make sure you have something to say. 

   for (x=y; x<(y+quips[object.charnumber]); x++)
	{
	if (QuipOn(object.charnumber,x-y))
		{
			ok++
		}
	}


! Write contents to the screen

if (ok>0)
{

   UpdateOpponentWindow(object)
!  "Please select one:\n\n"

 print "\n";

! List the player's choices

	for (x=y;  x < y+quips[object.charnumber]; x++)
		{
		if (QuipOn(object.charnumber,x-y))
			{
				z++
				print "["; number z; "]";
				SayQ(object.charnumber,x-y)
			}
		}

	! Get the choice

   	GetDial(z)
   	if (selected ~= 0)
 		{
		ok=0
		!print "ok is: "; number ok
		"\n";
        	   for (x=y;  x < (y+quips[object.charnumber]); x++)
			{
			if (QuipOn(object.charnumber,x-y))
				{
				ok++
				if (ok = selected)
					{
				  	Respond(object.charnumber,x-y)
					}
				}
			}
	}
	return true
		
	}
   "I can't think of anything to say right now."

}
routine GetDial (max)
{
local temp
   print "\n\BSelect an option or 0 to say nothing\b ";

   COLOR LIGHT_CYAN

   print ">> "; 

   COLOR TEXTCOLOR

    input


   if word[1]
	{
      	string(tempquip, word[1])
	}
   else
	{
       	string(tempquip, parse$)
	}

   temp = tempquip[0] - '0'

   if (temp = 0)
	{
	"\nI decide not to say anything."
	selected = temp
	return
	}
   else
	{
	selected = temp
	}

return
}




routine SetQuip (char, line, onoff)
{
local x, y, z, n

	for (x=0; x<char; x++) 
		{
	    	 n=(n + quips[x])
		}
	n = (n + line)
	y = (n / 8)
	z = Mod(n,8)
	z = Power(2,z)
	if (onoff = 1) 
		{
	     	qflag[y] = ((qflag[y]) | (z))
		}
	if (onoff = 0) 
		{
		     qflag[y] = ((qflag[y]) & (~z))
		}
}


routine QuipOn (char, line)
{
local x, y, z, n

  for (x=0; x<char; x++) 
	{
	     n = (n + quips[x])
	}
  n = n + line
  y = n / 8
  z = Mod(n,8)
  z = Power(2,z)
  if ((qflag[y] & z) = z) 
	{ 
	return(1)
	}
  return(0)
}

routine Power (a, b)
{
local c sum
  sum = a
  if (b = 0) 
	{ 
	return(1)
	}
  if (b = 1) 
	{ 
	return(a)
	}
  for (c=0; c<(b-1); c++) 
	{
	     sum = sum * a
  	}
  return(sum)
}


!!!!!!!!!!!!!!!!!!!!!!!!
!! QUIPS DIALOGUE
!!!!!!!!!!!!!!!!!!!!!!!!
routine SayQ (char, line)
{
select(char)
   case 2:
	{
	!Gibs
	select(line)

	case 1: {" \"Ah. You heard about that, eh?\""}
	case 2: {" \"No, it isn't like that right now, man.\""}
	case 3: {" \"Audrey's actually supposed to drop by later...\""}

	case 4: {" \"I already \Bhave\b a girlfriend, Gibs.\""}
	case 5: {" \"What were you doing anywhere near that Beads Store?\""}
	case 6: {" \"Sounds like the Bead Store is a happening place.\""}


	! "Hey, Duffy, solid. Glad you're here, had a question for you," says Barnaby."

	case 7: {" \"Hey, look who it is! The guy who hates malls and D&D!\""}
	case 8: {" \"Aren't you supposed to be at work?\""}
	case 9: {" \"Well what brings you here? I thought you hated the mall?\""}

	case 10: {" \"What do you have down as the worst sports city, all-time, so far?\""}

	case 11: {" \"Gibs, do \Bnot\b touch the ghoul.\""}

	case 12: {" \"What did you expect the lounge to look like?\""}

	! Corridor 3, start of chapter
	case 14: {" \"All right. Here's what we're going to do.\""}

	case 15: {" \"What's your take on that bloody handprint?\""}

	! "When did you lose your virginity?"
	case 13: {" \"Nah, my first time was September 11th, 2001, actually.\""}

	! Did Trott make it this far?
	case 16: {" \"Yeah. Trott's pretty resourceful.\""}
	case 17: {" \"I dunno. I can't think of where else he'd have gone, though.\""}
	case 18: {" \"Nah, we'll probably find him crucified in the next room.\""}

	! Gibs and the rubble
	case 19: {" \"How close are you to getting this rubble cleaned up, Gibs?\""}

	case 20: {" \"What's with the lights?\""}

	case 21: {" \"Are you secretly a virgin?\""}

	
	!End Game Stuff
	case 22: {" \"Hi there. Long time, man. Thanks for the help.\""}
	case 23: {" \"BRING! BACK! PRE-CASTING! BEEEEEYATCH!\""}
	case 24: {" \"You absolutely decked that guy.\""}

	case 25: {" \"I wanted to talk about our night in the Mall.\""}
	case 26: {" \"I wanted to ask you about job possibilities.\""}

	case 27: {" \"You're really worried about me?\""}

	case 28: {" \"So let's go tear it up, huh?\""}


	case 29: {" \"You're sure? No kidding around?\""}


	}

   case 3: 
	{
	!Audrey

	!!!!!!!!!!!!!!!!!!!!!!!!!
	! Chapter Two


	select(line)
	case 1: {" \"Movie Night! Movie Night sure sounds great, doesn't it?\""}
	case 2: {" \"I'm going to avoid that question by telling you how great you look, Miss Case.\""}
	case 3: {" \"OK, to be honest, I thought we'd watch a movie.\""}

	!Following is their fight in his room after Movie Night. Most likely, some dialogue will occur chronologically before this, but numerically after

	case 26: {" \"Sorry. The next movie will probably be better anyway.\""}
	case 27: {" \"Did you particularly want to see \IBlade?\i?\""}

	case 28: {" \"So... how is school going these days?\""}
	case 29: {" \"What are you doing later?\""}

	case 30: {" \"This, ah, movie is mine, for what it's worth.\""}

	
	! Queue on "What the hell was that? When are you going to get it?"

	case 15:{" \"You're pissed. Aren't you?\""}
	case 16:{" \"Hey, sorry about that and those guys.\""}
	case 17:{" \"What's got to stop?\""}

	case 18:{" \"Well, what is fun, then? Educate me.\""}
	case 31:{" \"What? Come on, we were just goofing around in there.\""}

	case 19:{" \"Hey, look, me either. OK? I'm not retiring on you.\""}
	case 32:{" \"Look, we'll go skydiving or something, okay?\""}

	case 20:{" \"Lay it on me, then. What's up?\""}
	case 21:{" \"Look, there's not a chance in hell I'm moving to Texas.\""}
	case 22:{" \"Houston? Why not Bangor? Or freaking Charon?\""}


	! All comes down to Jarret having to leave 

	case 23:{" \"Look... I have to get to work.\""}

	case 24:{" \"I'm with you now. My preeeeecioussss...\""}


	! She tells him that she's moving to Texas
	case 4: {" \"Get it? Get what? What the hell are you talking about, Audrey?\""}
	case 5: {" \"Me? What about you storming off like that?\""}
	case 6: {" \"I don't have time for this crap tonight. I really don't.\""}
	
	case 7: {" \"Why would you do something like that?\""}
	case 8: {" \"Really. Remarkable. Just leave. OK?\""}
	case 9: {" \"That's going to be a nasty commute for you, then.\""}	

	!Lights Going Out in the Mall
	case 34:{" \"Whoa, that was one hell of a lightning strike.\""}


	!Candle Store
	case 25:{" \"Are we looking for a particular candle?\""}

	!Vision #2
	case 33: {" \"Whoa, that was you in the vision! What does a plus mean?\""}

	!!!!!!!!!!!!!!!!!!!!!!!!!
	! Chapter Three


	! She asks him if she can ask a question, in the Mall 

	case 10: {" \"Sure, anytime. Go ahead.\""}
	case 11: {" \"Yeah. Talk in private, or...?\""}

	case 12: {" \"Yes, look, I'll help you. Them. Whoever.\""}
	case 13: {" \"Look, I'll try to make it over eventually. OK?\""}


	!!!!!!!!!!!!!!!!!!!!!!!!!
	! Chapter Four

	case 14: {" \"Oh, one other thing. There was a zombie back there.\""}


	!Going off to go get the Sporting Goods Store open...
	case 35: {" \"We'll be back in a couple minutes, OK?\""}

	case 36: {" \"You didn't find any rifles, did you?\""}

	case 37: {" \"Oh, what does it matter if I cheated at the tourney?\""}
	case 38: {" \"C'mon, you have to admit it's pretty funny.\""}

	case 39: {" \"You've never 'cheated' around with me or anything?\""}
	case 40: {" \"Hey, those in glass houses ought not to be throwing loaded dice, narmean?\""}

	case 41: {" \"How sure were you that there was something out there?\""}
	case 42: {" \"I didn't see anything. I'm leaving.\""}

	case 43: {" \"Yeah. That one by WotC. Five years ago.\""}

	case 44: {" \"Audrey... trust me on this. Please.\""}
        case 45: {" \"What options do you have for this?\""}

	case 46: {" \"Hey, who turned off all the lights?\""}

	case 47: {" \"Don't worry your sweet little ass about it, doll.\""}
	case 48: {" \"That thing's a beast! I don't know how to begin to kill it.\""}
	case 49: {" \"It's paused for now, as it wants to get all of us.\""}

	case 50: {" \"This poor girl. Had you ever seen her before?\""}

	case 51: {" \"Well, that didn't take long. Hi!\""}
	case 52: {" \"Congrats! You're our 209th customer!\""}
	}

   case 4
	{
	!Pang
	select(line)
	case 1: {" \"The hell? You brought a full beer in here?\""}
	case 2: {" \"What are you doing tonight?\""}
	case 3: {" \"Look, get lost. My girlfriend is coming over.\""}

	case 4: {" \"That -- this, all of this: Not cool, dude.\""}
	case 5: {" \"What the FUCKING HELL is wrong with you?\""}

	}

   case 5
	{
	!Criswell
	select(line)
	case 1: {" \"So... anything look good?\""}

	case 2: {" \"Why were you keeping beer at the neighbor's house?\""}

	case 3: {" \"I don't care... I really don't.\""}
	case 4: {" \"Leave it on. Don't be an ass.\""}
	case 5: {" \"Yeah, get it out of there.\""}

	case 6: {" \"Why are you acting like a prick?\""}
	case 7: {" \"Fuck you, you fucking junkie shit!\""}

	}

   case 7
	{
	!Clerk
	select(line)
	case 1: {" \"Do you recommend anything here?\""}
	}

   case 8
	{
	!Trott
	select(line)
	case 1: {" \"Hey, what's up, Trott?\""}
	case 2: {" \"Anything interesting happen tonight?\""}

	case 3: {" \"What the hell does this postcard even mean?\""}

	case 4: {" \"What were you doing in here? Taking a nap, you \Itesticle?\i\""}
	case 5: {" \"The mallcop got turned into a zombie. What I can't figure out is why you weren't.\""}
	case 6: {" \"How did you get past that thing?\""}
	case 7: {" \"Hey... did you know that was us?\""}
	case 8: {" \"Do you know how to work the console?\""}
	case 9: {" \"Later... the girls are out there alone.\""}
	case 10:{" \"Now is good, it's probably safe.\""}

	case 11:{" \"Hey, the lounge door got locked. Can you unlock it?\""}
	case 12:{" \"Trott, it's me. Can you raise the gate to the Sporting Goods store for us?\""}

	! End Game / Epilogue

	case 13:{" \"Hey, Trott... You know That Night we never talk about?\""}

	case 14: {" \"The hell is up with that girl outside?\""}


	case 15: {" \"Can you raise the gate of the Record Store for me?\""}


	}

   case 10
	{
	!Sydney
	select(line)
	case 1:  {" \"What's going on, gorgeous?\""}
	case 2:  {" \"Looking good, sexy!\""}

	! Right after the aftermath
	case 3:  {" \"Syd? You okay, doll?\""}

	case 4:  {" \"What happened to your eyes?\""}
	case 5:  {" \"How many fingers am I holding up?\""}

	case 6:  {" \"What have you done to her?\""}

	case 7:  {" \"Why won't you let us leave?\""}
	case 8:  {" \"What happened to everyone else in the Mall?\""}



	}

   case 11
	{
	!Casey
	select(line)
	case 5: {" \"Hi there, Casey. How are you?\""}


	case 1: {" \"So... what's new with you?\""}
	case 2: {" \"Hey, you talk to Audrey all the time. Is she going to dump me again?\""}
	case 3: {" \"Gibs... I mean, Barnaby, he wears his hat backwards.\""}
	case 4: {" \"What does Audrey want from me, then?\""}

	case 6: {" \"I buried it.\""}

	case 7: {" \"I'm not going in there!\""}
	case 8: {" \"Yeah, hold up, I need something better to use as a weapon.\""}

   	}

   case 18
	{
	!Spectre
	select(line)

	case 1 {" \"Hello there, my friend.\""}
	case 2 {" \"Have at thee, demon!\""}
	case 3 {" \"Why are you so cold, lost soul?\""}
	case 4 {" \"Follow me, spirit.\""}
	}

   case 21
	{
	!Vampire
	select(line)
	case 1: {" \"What did you do with Casey?\""}
	case 2: {" \"Mmm! Hmm! Yeah, I'd like to talk to you.\""}
	case 3: {" \"Give us back Casey and you won't get hurt.\""}
	case 4: {" \"Just get out of my way, okay? We're leaving.\""}

	case 5: {" \"How did Sydney get possessed?\""}
	case 6: {" \"Are you responsible for all this?\""}
	case 7: {" \"You thrash and fight and avoid as best you can a necrotic drift.\""}

	}

   case 26
	{
	!Zombie Bot2
	select(line)
	case 1: {" \"Hey! What are you doing back here?\""}
	case 2: {" \"You're really a robot, aren't you? I knew it!\""}
	case 3: {" \"Go away, cracky. Nobody likes you.\""}
	case 4: {" \"Are you interested in any stripper poles?\""}
	}
	
	case 27: 
	{
	!Revenant
	select(line)
   	case 1: {" \"How... are you?\""}
	case 2: {" \"What happened to your face?\""}
	
	case 3: {" \"No, I didn't.\""}
	case 4: {" \"Your life? No. But I know who did.\""}
	case 5: {" \"Yes. I am your killer.\""}

	case 6: {" \"A spirit possessing a girl named Sydney. It is your killer.\""}
	case 7: {" \"Your killer is the wandering spectre.\""}
	case 8: {" \"A vampire, Kali, is your killer.\""}

	case 9: {" \"Yeah. Sorry about that. I honestly thought she killed you.\""}
	case 10:{" \"What was supposed to happen upon you finding your killer?\""}

	case 11:{" \"The vampire wasn't your killer, was she?\""}

	}

   case 29:
	{
	!Magic Mouth
	select(line)
	case 1: {" \"What on earth happened to you?\""}
	case 2: {" \"Greetings, Mouth!\""}
	case 3: {" \"Tell me a story, Magic Mouth!\""}

	case 4: {" \"Er, excuse me?\""}
	case 6: {" \"Shut the fuck up. You're just shitty lips on a wall.\""}
	
	case 7: {" \"Oh, you want to go, eh? Fisticuffs?.\""}
	case 8: {" \"Please don't insult me like that. It's, er, insulting.\""}


	case 10:{" \"Tell me about the ghost that has possessed my friend Sydney.\""}
	case 11:{" \"Tell me how to defeat the various undead creatures in the Mall.\""}
	case 12:{" \"Tell me the \Bbest way\b to get out of here.\""}
	case 13:{" \"Tell me the most important thing you know.\""}

	}








}


routine Respond (char, line)
{
select(char)
   case 2
	{
	!Gibs
	select(line)
	case 1: {
		SetQuip(2,1,0)
		SetQuip(2,2,0)

		! I don't want to make the Beads Store joke twice... 
		GameEvents[4] = 1

		"\"Yeah,\" says Barnaby. \"We all did. She said... that'd she'd be better off \Idead\i? Jesus, man.\"\n"
		"\"When did you see her? I thought you didn't like her.\"\n"
		"\"She was at the beads store in the mall when I was the other day.\"\n"
		"\"What on earth were you doing there? I thought the only people who hung out there were Pagans and those 
		who smell of groin and armpit.\"\n"
		"Barnaby doesn't say anything for a second. He scans the back of some sports movie, \IHoosiers\i or \ISlap 
		Shot\i or something. \"Duffy,\" he says after a few seconds, \"you're the most pretentious mall snot I've 
		ever met. \IPagans and pitties?\i Did you transfer to the Gap? The Limited? Even Aeropostale? No, you in 
		fact did not. You're still working at the DUNGEONS AND DRAGONS STORE for the love of Christ. When was the 
		last time someone set foot in that place that attended their prom with someone other than their own 
		mother? Anyway, I went to the bead store because I had to get beads for Mardi Gras next month. I made an 
		investment in my future.\" He pauses for just a beat; damn him.\n" 
		"\"What's your future look like?\""	
		}

	case 2: 
		{
		SetQuip(2,1,0)
		SetQuip(2,2,0)

		"\"So, what, this is a good stretch?\" asks Barnaby.\n"
		"\"I'd say so. She even sat in for a session with us a couple days ago.\" By 'session,' I mean a session of D&D. She's only done
		that for maybe a half-dozen times in the last year or so. She doesn't like to play much anymore.\n"
		"\"Yeah...\" says Barnaby. \"Hey, Trott was your game referee for that, right?\"\n"
		"\"Right.\" Barnaby gives an exaggerated 'imagine-that!' look. \"What?\" I ask him. \"What does that mean?\"\n"
		"\"Maybe she's trying to get in good with Trott, that's all.\" I frown at that. It'd be unlike her. \"All I'm saying,\" continues 
		Barnaby, \"is that no girl sits through a session of orc herding and dice rolling or whatever it is you lot do without trying to
		get in good with some guy. It's like a dude tagging along to a Tori Amos concert through free will. And as she's already archived the 
		shape of your spunk -- so to speak -- she's got no reason to ingratiate herself to you.\"\n"
		"\"What the hell is wrong with you? Jesus. Pang was there. Maybe she wants to nuzzle up with him?\"\n"
		"Barnaby goes deadly serious for a moment. \I\"No woman could love the Pang.\"\i"
		}
	case 3: 
		{
		SetQuip(2,1,0)
		SetQuip(2,3,0)

		"Barnaby gestures over to Pang and Criswell. \"I certainly hope you're getting rid of those two idiots, then.\"\n"
		"\"I... er, I wasn't planning on it...\"\n"
		"\"Wait, you're telling me that you're going to have Audrey over and you're \Iallowing\i these cretins to hang around? You 
		know, it's a wonder that you've ever gone to bed with anyone. Ever. Don't these guys know to make themselves scarce?\"\n"
		"\"Well, they work nights. And only three or four nights a week at that. Look, Gibs, I'm living there because my rent
		is just $210 a month. And because they own a TV and a DVD player. Not because I particularly connect with them or anything.\"\n"
		"\"Hey, no need to take offense, Duffy.\" Barnaby shrugs. \"All I'm saying is that there are three things that every, and I mean
		\Ievery\i, student learns in eight semesters at university. You never start a land war in Asia, you never start a flame war with
		Derek Smart, and you never start a movie in a dark room with one hand on your remote and the other up your girlfriend's skirt 
		with two other guys in the room.\"\n"
		"\"Yeah, yeah, thanks for the heaping of wisdom Lady Crysan--\"\n"
		"Barnaby cuts me off and says, \"And, hey, that's the order of likely success as well. Genghis Khan and Subotai at least met
		some of their goals. Civilization as a whole is still waiting for that one guy to have a nice date with the girl he's on the
		rocks with when a couple of idiot dump-humpers are slinking around.\""
		}
	case 4: 
		{
		SetQuip(2,4,0)
		SetQuip(2,5,0)
		SetQuip(2,6,0)

		"\"Yeah, you've got one presently,\" says Barnaby, \"But for how long? Women always keep their options open.\"\n"
		"\"What do you mean by that? Their options open?\"\n"
		"\"Women, in my experiences, when they are getting ready to give their guy the hammer -- dump him, to the layman
	        -- have some opportunistic toady crawling around on their radar ready to be the emotional Gibraltar.\"\n"

		"\"Not all women are co-dependent.\" Gibs is a solid citizen and a good friend, but I've never been able to 
		verify if he has a sincere misogynistic streak in him or if he just exaggerates a lot. Normally my defense of
		the female gender is a lot more verbose, but showing any sort of optimism after being in New Haz for five minutes
		gets tough.\n"

		"\"All I'm saying... is that you need to keep your supply lines open. Why let Audrey -- why let \Iany\i woman --
		turn you into some sort of social recluse? I don't like being seen in your precious Mall, but if I were that kind
		of guy I'd be all around that Bead Store.\""
		}
	case 5: 
		{
   		SetQuip(2,4,0)
		SetQuip(2,5,0)
      		SetQuip(2,6,0)
		"\"Kee-rist, you've got a pretentious, arrogant streak in you when it comes to that Mall,\" says Barnaby. \"How
		did I get myself into another endless discussion about the fucking Mall with you anyway?\"\n"
		"\"Show some respect to the only place worth dropping money at in New Haz.\"\n"
		"\"Hey!\" exclaims the clerk.\n"
		"\"No offense,\" I shrug. I turn back to Barnaby. \"No, seriously, only hippies and pagans hang out there. I thought
		you hated those kinds of groups.\"\n"
		"\"I hate everybody,\" says Barnaby. \"No, I need them for a trip I'm taking. Mardi Gras is next month.\" That's 
                right: Gibs had mentioned this, but I couldn't afford to go. \"Anyway, the people that hang out there are like the
		polar opposite of those that hang out in your store. Where your peeps see not showering as a kind of badge of honor,
		the girls over there smell sweet, like fruit. Where your customers are hideously overweight and convinced that 
		they are 'living life to the fullest,' they are curvaceous and toned. Where the D&D clientele see the ultimate clothing
		accessory as the plaid Cum Rag, they -- \"\n"
		"\"Okay... OKAY. Jesus, I frigging get it. Your point is made.\""

		}

	case 6:
		{
		SetQuip(2,4,0)
		SetQuip(2,5,0)
		SetQuip(2,6,0)

		"\"It's got advantages to the Rat's Nest you lord over, yes,\" says Gibs.\n"
		"\"What are you talking about? My store is one of the cleanest in the entire Mall.\"\n"
		"\"Sure,\" he says, \"You guys vacuum and so forth, but maybe the guys who come into your place asking for those
		elusive 3rd Edition Leprechaun Modules ought to instead be directed to the nearest Irish Spring.\"\n"
		"I don't say anything for a second, and Gibs takes that to mean that I didn't understand him.\n"
		"\"I'm saying that nobody who buys anything at your store bathes, and that they could all use a \IBag of Holding\i
		that only held soap cakes. Run that promotion sometime. That is all.\" Gibs goes back to browsing the movies."
		}
	
	case 7, 9: 
		{
		SetQuip(2,7,0)
		SetQuip(2,8,0)
		SetQuip(2,9,0)
		SetQuip(2,10,1)

		Audrey_Script_1

		"\"Mingya, gimme a break, Duffy,\" says Barnaby. \"I outgrew all this stuff years ago. If I'm going to be weirdly obsessive 
		about something, it'll be football roto stats, not the loyalty tables of half-orc henchmen.\"\n"
		"\"Fair enough,\" I say with a shrug. Why get into it with him? \"What's up, anyway?\"\n"
		"\"I need you to come on the air tonight. After you get done here and everything. Both of my interviews fell through
		so I need to make this an all-comedy night.\"\n"
		"I've gone by the studio with Barnaby a couple times before. Though previously I've known in advance and could brush up
		on the various crimes committed by NFL players.\n"
		"\"I dunno, Gibs... I haven't been paying much attention as of late, I don't even know who's going to be in the Super Bowl.\"\n"
		"\"You'll do fine!\" he says. \"Tavarian Pittman was identified as a participant in a snuff film earlier today! All we're
		going to do is make jokes about it for three hours. Can you do a Nicholas Cage impression? Additionally, we'll also discuss
		the worst sports cities of all-time.\""
		}

	case 8:
		{
		SetQuip(2,8,0)
		SetQuip(2,7,0)
		SetQuip(2,9,1)

		"\"Nah, not until three o'clock A.M.,\" says Barnaby. \"On Fridays they don't need me around before my show starts.\""		
		}
	
	case 10:
		{
		SetQuip(2,10,0)
		QuipsKiller(2,2,10,0)

		"\"So far, Nagasaki, 1946. Everyone is dead, the stadia are in shambles, and the concession stand taffy glows
		in the dark.\""		
		}

	case 11: 
		{
		SetQuip(2,11,0)

		"\"What? Why?\"\n"
		"\"Its touch will cause paralysis. You'll lock up. Look, you have to trust me!\"\n"
		"\"I'm not going to let him just start hacking away at her,\" he says. He hasn't taken his eyes off the ghoul yet.
		I don't think he believes me or is even really listening to me."
		}

	case 12: 
		{
		SetQuip(2,12,0)
		SetQuip(2,13,1)
		QuipsKiller(3,2,13,0)

		"\"Oh, I don't know,\" says Gibs. \"Maybe a keg, some darts, a big screen TV... something better than this
		squalor.\"\n"
		"\"The Mall has no incentive to pay for those things. Maybe in a better, parallel dimension, I guess.\"\n"
		"\"Y'know,\" says Gibs, \"I was reading up on parallel dimensions the other day. It really is interesting.
		We could be making these same moves in a different reality, maybe one where this lounge is decked out like
		a fraternity house, or one where we are both involved in polygamy with a set of supermodels, or one where
		the lead singers to the bands Saves the Day and Nine Days were exchanged.\"\n"
		"\"I don't know those bands. What would be different about such a dimension?\"\n"
		"\"Well, actually...\" Gibs scrunches up his face and considers this for a moment. \"...Not a goddamn 
		thing. Maybe \Ithat's\i the one we're in. Bad example. Sorry. This creepy corridor shit has me a little flustered.
		Why don't you tell me a story or something and help break the tension.\"\n"
		"\"Like what?\" I ask him, not at all sure what he means.\n"
		"\"I don't know. Tell me about what's going on with your girl and you. She was your first, right?\""
		}
	case 13:
		{
		SetQuip(2,13,0)

		"\"No!\" says Gibs.\n"

		"\"But yes!\" I exclaim. \"Wait, you thought Audrey was my first? What? I've only known her a few years. You knew me in college, and I was
		banging -- \"\n"

		"\"I meant, were \Iyou \Bher\b\i first. I asked it wrong, most likely because I am about somewhat spooked here.\"\n"

		"\"Oh. Yeah. I was. But anyway, my first time -- I was fifteen. I ducked out of high school that day because Tara Ontillo 
		had taken a shine to me and picked me up in her Civic. She was something. She had these soft blue eyes and this unnaturally 
		jet black hair. Just the color of something that paleontologists find mastodons in.\"\n"
		
		"\"Paleontologists don't search for -- \" I cut Gibs off with a sharp wave of my hand.\n"
		
		"She wore it really short -- not so short that you'd think she was a citizen of the Lesbian Guerilla Nation or anything. 
		But short like she played bass in Elastica on the side. It's still a preference of mine. And oh, man, she was nothing but 
		trouble. She just had this thing for deflowering boys at my high school. She was 18, and I think it was her way at 'getting 
		back' of the boys who treated her bad when she went to school there. I skipped out on Social Studies and met her outside 
		at 7:30. She brought me over to some duplex or townhouse that belonged to an older friend of hers. She started taking her
		clothes off at a rather quick pace, and I almost came just looking at her, all naked and in front of me. \""; 
		
		"...Overall I guess I did okay considering it was my first time, though she wouldn't let me really touch her 
		until she came twice via me dropping on her. She had some crazy scoring system I had to adhere to. I got back to school and 
		everybody was freaking out and in hysterics. Nobody noticed that I missed the first two hours of class, of course.\"\n"

		"\"Well,\" says Gibs uncomfortably, \"That's what they said. 9/11. Never Forget... your, uh, First Time.\""

		LocationState[14] = 1

		}

	case 14:
		{
		SetQuip(2,14,0)
		SetQuip(3,35,1)

		! Don't have Gibs say pretty much this exact thing in his daemon routine 
		GameEvents[43] = 1 

		! Used when "the plan" has been done 
		GameEvents[45] = 1 

		"\"Talk to me,\" says Gibs. \"This is your eminent domain, after all.\"\n"

		"Yeah, it is, now that I think about it. I do appreciate the vote of confidence from Gibs. \"Let's grab some rifles,\" 
		I say. \"I think there might be some in the Sporting Goods Store. That's just a few 'blocks' to the east,\"\n"	

		"\"Great, yeah.\" Gibs imagines himself with some serious pump-action weaponry for a moment. He shakes himself out of
		it. \"Let's arm ourselves,\" says Gibs. \"This D&D stuff is only frightening -- in my opinion! -- because back in the
		1300s or whenever you dorks imagine you're playing, nobody had any gunpowder.\"\n"

		"\"Truth to tell, there is a character in D&D called the Gif, and they -- \"\n"

		"\"Yeah, that's pretty amazing,\" says Gibs as he turns to the girls. \"I apologize for to you two for this goofy 
		nerdling. Jesus. Anyway, you guys'll be OK for a couple minutes, right?\" Audrey and Casey nod. 
		\"All right, Jarret. Let's go.\""
		}

	case 15: 
		{
		SetQuip(2,15,0)

		"\"I'm going to hold out the hope that it is finger paint,\" says Gibs. \"Surely that fits Occam's Razor more than 
		somebody chucking quarts of blood around the place like they were re-creating the intro to the TV show 'In Living 
		Color.' Especially since there's none on the walls or floor.\"\n"

		"\"Where is someone going to get finger paints in this Mall? The only nod this place has \Iever\i made towards the Fine 
		Arts is when they hosted that gallery of paintings from the criminals locked up in the State Fed. And that was simply
		because, as convicts, the Mall didn't have to pay to display their work.\"\n"

		"\"Maybe a Mallcop was marking his territory,\" Gibs offers.\n"

		"I consider this. \"They'd do that by urinating on the window, not by painting it, though.\" Gibs just 
		lets the issue drop."

		}
	case 16:
		{
		SetQuip(2,16,0)
		SetQuip(2,17,0)
		SetQuip(2,18,0)

		"\"Really? If you say so. He seems sort of like a chud to me,\" says Gibs.\n"

		"\"What? No. Shut the fuck up.\" I'm not exactly Atticus Finch defending Boo Radley here, but I do what I can, I guess."
		}

	case 17: 
		{
		SetQuip(2,16,0)
		SetQuip(2,17,0)
		SetQuip(2,18,0)

		"\"Do you think the ghost, ah... teleported or created that skeleton? Or do you think it was someone from the Mall?\" asks
		Gibs.\n"

		"\"I'm not really certain... there was a really skinny guy who worked at the cosmetics kiosk who would have been really close to
		the Bead Store... I don't know. I never really memorized the guy's dental record or jawline or anything.\""
		}

	case 18:
		{
		SetQuip(2,16,0)
		SetQuip(2,17,0)
		SetQuip(2,18,0)

		"\"Crucified?\" asks Gibs. \"Huh?\"\n"

		"\"That's what various undead lords like to do with their victims. Well, sometimes they just put one's head on a pike.\"\n"

		"\"I guess I'd prefer crucifixion, then,\" says Gibs, after giving it a bit of thought. \"That way I could have an open
		coffin ceremony without having to have my head stitched back on my head like some kind of Frankenstein's Monster ordeal.
		That would repulse my mother, and she has a weak heart.\"\n"

		"\"Yeah, she'd probably be better able to deal with getting nailed to a cross. At least there's a precedent there with
		someone she respects having already paved the way for the rest of us.\""
		}

	case 19: 
		{
		SetQuip(2,19,0)

		RubbleState[5] = RubbleState[1] + RubbleState[2] + RubbleState[3] + RubbleState[4]

		select(RubbleState[5])
		case 0
			{
				"\"I haven't even really started yet,\" says Gibs. \"Jesus, go do something. Mingya.\""
			}

		case 1
			{
				"Gibs surveys the wreckage that is left. \"Eh, I'm about a quarter the way finished, 
				I guess,\" he says."
			}

		case 2	
			{
				"Gibs wipes some sweat off his forehead. \"Almost halfway finished, really,\" he says,
				before going back to work."
			}
		case 3
			{
				"\"Like three-quarters done,\" he says. \"Just a little while longer.\""
			}

		case 4
			{
				RubbleState[5] = 5
				"\"Yeah, I'm set,\" he says. \"We're all good here.\""
			}
		}

	case 20:
		{
		SetQuip(2,20,0)
		"\"The hell would I know?\" asks Gibs."
		}

	case 21: 
		{
		SetQuip(2,21,0)
		"At first Gibs doesn't deign that question worthy of an answer. \"If your master plan on getting us out of here was dependant
		on me having never turned a bunch of women inside-out then it's the worst plan I've ever heard of. I almost got some \Iwhile\i
		we were getting out of here.\" He pauses for a second. \"What else is in store for me with your worldly famous, terrible plan?
		Arranging a defensive Maginot Line with a bunch of mall junk?\"\n"

		"Ah... looks like I'll need somebody else."
		}

	case 22: 
		{
		SetQuip(2,22,0)
		SetQuip(2,23,0)
		SetQuip(2,24,0)
		SetQuip(2,25,1)
		SetQuip(2,26,1)

		Deactivate(Zombiebot_Returns)

		LocationState[20] = 4

		"Gibs and I shake hands. We attempt to complete a multi-step handshake, but only get three moves in
		before he messes it up. It really had been a long time.\n"

		"\"Is this a typical Friday night for this dump?\" asks Gibs. \"Come to work, see my buddy getting his
		ass kicked, see his co-worker stand completely motionless like he was trying to spontaneously generate
		chameleonic qualities.\"\n"
		
		"\"Hey!\" interjects Trott.\n"

		"\"I'd say it was a full moon or something,\" I tell Gibs, \"But the impression I get is that the crazies
		would still descend upon this place and everywhere I go even if someone shot it straight out of the sky.\"\n"

		"\"So what did you want to bring me down here for, anyway?\" asks Gibs."

		}

	case 23: 
		{

		SetQuip(2,22,0)
		SetQuip(2,23,0)
		SetQuip(2,24,0)
		SetQuip(2,25,1)
		SetQuip(2,26,1)
		SetQuip(2,27,1)

		Deactivate(Zombiebot_Returns)

		LocationState[20] = 4

		"I'm interrupted before I can even get to the good part. \n"
		
		"\"Hey! Shut up! Mingya... what does that even \Imean?\i asks Gibs. \"Pre-casting? The fuck? You really need to calm 
		down, Duffy... I'm worried about you. I have been for quite some time. This is why we don't go and see boxing 
		matches any more. Every time somebody gets decked you start shouting and ranting like you're a bloodthirsty 
		hyena.\""
		}

	case 24:
		{
		SetQuip(2,24,0)

		Deactivate(Zombiebot_Returns)

		LocationState[20] = 4

		"\"That's not the very first time I ever had to smash somebody with a stripper pole,\" says Gibs. He looks very
		contemplative for a moment. \"And hopefully it will not be the last!\" he exclaims."
		}

	case 25:
		{
		SetQuip(2,25,0)
		SetQuip(2,26,0)
		SetQuip(2,27,0)
		SetQuip(2,28,1)

		LocationState[20] = 5

		"\"Argh... why you wanna do that?\" asks Gibs. \"I thought we agreed to a death pact on the subject or something. Didn't we? Trott?\"\n"

		"Trott shakes his head. He doesn't know.\n"

		"\"Look, Gibs...\" I decide how I want to proceed. \"How did you rationalize it away? \BDid\b you provide a rational explanation
		in your own mind?\"\n"
		
		"\"Ah, it was probably just robots,\" says Gibs. \"Who knows? I need to get out of this town. I never thought I'd be
		some place utterly lawless and unforgiving. I need... fuck, man, I need things like social services and hospitals and so forth.
		I want to be able to walk down the street without feeling like I should be carrying a firearm. I want to get a slice of pizza
		that isn't covered in foul egg-like substances...\" Gibs changes focus mid-rant. \"All I know is that we got the hell out of there.
		There were a bunch of things trying to kill us, but you got us out. I don't know if I ever thanked you, Jarret, but... well... 
		You know. Thanks.\"\n"

		"Gibs steps on over to me and we give each other a very weird and awkward man-hug."
		}
		
	case 26: 
		{
		SetQuip(2,25,0)
		SetQuip(2,26,0)
		SetQuip(2,27,0)
		SetQuip(2,28,1)

		LocationState[20] = 5

		"\"Job possibilities?\" repeats Gibs. \"Why on earth would you want to leave this place? It's finally become the most unfocused
		store in the Mall! You're hocking everything from Gold Bond medicated food powder to edible pasties. I thought it was a dream
		come true.\" Gibs turns over to Trott. \"What the hell are you still doing here, anyway? Don't you have like three other jobs?\"\n"

		"\"I seem to be having some problems with the direction of my life. Admittedly. Anyway, who asked you?\"\n"

		"\"Sorry,\" says Gibs. \"I don't want to see either of you guys rot in here.\"\n"

		"\"What do you got for me?\" I ask Gibs. \"And why are you stuck in New Haz, anyway? Can't you do your show 
		from anywhere? I think I want in.\"\n"

		"\"Yeah, with the tech we've got over there it could be done on opposite sides of the globe and it would 
		sound crystal-clear. You're up for this? Talking about sports?\"\n"

		"\"I think so,\" I tell him. Maybe it's time to grow up. Maybe it's time to find a more socially 
		acceptable and lucrative job. \"Yeah.\""
		}

	case 27: 
		{
		SetQuip(2,27,0)

		"\"Of course I am, man,\" says Gibs. \"Go four months without hearing from you... your girlfriend leaves you, your 
		place of employment turns from a respectable hobby store into Creusa's Patio of Curiosities... I was just hoping that
		when I saw you next it wasn't going to be with you jamming a needle into your arm.\"\n"

		"No idea where Gibs got that from. \"Where did this come from? I don't have a drug problem -- \"\n"

		"\"Yet. YET. You don't have a drug problem yet. AOL Keyword: YET. NASDAQ abbreviation Y-E-T.\"\n"

		"\"No, Gibs...\" I tell him, \"I'm good in that respect.\""
		}

	case 28: 
		{
		SetQuip(2,28,0)
		SetQuip(2,29,1)

		LocationState[20] = 6

		"\"Sounds good,\" says Gibs. \"Let's get the hell out of here.\"\n"

		"I give the customer a kick. It's a bot. Let loose on the town for some data collection by a robotic company.\n"

		"\"I've got half a mind to give these jokers a piece of my mind,\" I say. \"They've been sending their shitty
		prototype androids out into the city for almonst an entire year now.\"\n"

		"\"Let's drop by,\" suggests Gibs. \"Why not? We'll kick them where it really hurts.\"\n"

		"Yeah. Hmm. \"Their wallets?\" I ask.\n" 

		"\"No, in the gob.\" says Gibs.\n"

		"\"We're going to have them seeing stars. We're going to have them seeing the entire top row of the keyboard. 
		More stars than the Milky Way. More dollar signs than in the GNP. More carats and underlines than in a Korean
		chat room. More plus signs than in a bucket of negative pregnancy tests. More -- \"\n"

		"Trott speaks up for a sec. \"A positive means the girl is pregnant, Duffy.\"\n"

		"\"Yeah,\" adds Gibs. \"Jesus.\"\n"

		"Surely these two assholes are kidding. \"What are you two blathering on about? The plus means they are 
		positive that your girl isn't pregnant. Positive means happy. Fortunate.\"\n"

		"\"No, dummy,\" says Gibs, \"It means whoever you porked got the absolute worst of you and had their womb
		totally polluted by you. Did you knock somebody up? Look, champ, other guys are going to want that space
		eventually and... hey, it wasn't Audrey, was it? Did you find one of her tests?\""
		}
	
	case 29
		{
		SetQuip(2,29,0)

		LocationState[20] = 7

		UpdateGraphicsWindow(location)

		"\"Yes. Quite sure,\" says Gibs. \"My modus operandi is not traveling the city, starting (or rather, ending)
		fistfights and then providing incorrect data on home pregnancy tests. I have no agenda here.\""


		PictureinText("mall", "pause01", 15, 11, true)


		pause

		cls


		End_Game()

		}





	}

   case 3
	{
	!Audrey
	select(line)
	case 1: 
		{
		SetQuip(3,1,0)
		SetQuip(3,2,0)

		Activate(Movie_Night)

		"\"Movie night?\" asks Audrey. \"You want to sit around the house and watch a movie? Come on. Really?\"\n"
		"Pang pops up with his opinion. \"Well, \II\i want to.\"\n"
		"\"Nobody's asking you,\" says Audrey. Then it hits her that Pang is probably going to sit around for
		the showing. \"Your little friend isn't around is he, Pang?\" She means Criswell.\n"
		"\"He will be in a minute. The pipes froze and burst next door and flooded the kitchen. He's been keeping 
		beer there.\"\n"
		"Audrey doesn't roll her eyes or anything, but it's obvious to me that she envisioned something else when I
		asked her over. I'd love to go out somewhere, but I barely have enough gas to get me to work and back and I
		don't get paid until Wednesday. In a storybook world or in some kind of made-up \Idream\i relationship I'd just
		come correct and let her know how broke I was. We could then just play in the snow, frolic for a couple hours
		and eat pieces of our gingerbread house for dinner. In the world I reside in, though, in the reality I've 
		made for myself that's not an option I have available."
		}
	case 2: 
		{
		SetQuip(3,1,0)
		SetQuip(3,2,0)
		SetQuip(3,3,1)

		"\"Well, that's certainly nice of you to say,\" says Audrey. \"Thank you. But...\" she says with just the trace of a
		smile, \"You can't avoid the question \Iforever\i, you know.\"\n"
		"Well, she's right about that, but I could at least probably \Itry\i."
		}
	case 3: 
		{
		SetQuip(3,1,0)
		SetQuip(3,2,0)
		SetQuip(3,3,0)

		Activate(Movie_Night)

		"\"A movie. Oh-kay,\" she says. \"Which theatre?\" she asks, hopefully.\n"
		"\"Casa de Duffy, funnily enough.\"\n"
		"\"Funnily enough? What's so funny, \Ior\i fun, about being cooped up in this house for the millionth time?\" 
		She puts her hands on her hips, which is an subconscious indicator that she's starting to get agitated. \"You
		really don't want to leave and do something?\"\n"	
		
		"\"Well, it's not ha-ha funny, no,\" I tell her. \"Look, we got some good stuff. I broke the bank here. If you
		don't like the films then at least you've got me providing Tom-Servo-style running commentary.\"\n"

		"She relaxes her pose and waves her hand in a dismissal of her argument. \"Okay, okay... but you'd better be
		\Bon\b, Jarret Duffy. What's your term for it? Comedy Jupiter? It had better be Comedy Jupiter.\"\n"

		"\"You betcha. I'll even throw in Io and Europa.\" I'm not quite sure what that means, but those were the only
		two moons I could recall in a pinch, so."

		}



	case 6: 
		{
		SetQuip(3,3,0)
		SetQuip(3,4,0)
		SetQuip(3,5,0)
		"\"What do you mean 'you don't have time'?\" Audrey says that in an almost perfect impression of my voice. I hate it
		when she does that.\n"
		"\"I mean I have to be at fuckin' work in a couple hours! Jesus Christ!\" I don't bother trying to return the favor
		to her like this. Not that I am above it, or anything, I just can't make my voice sound anything like hers.\n"
		"\"Right, God forbid the nerds and goblins don't have you to tuck them in for a night.\"\n"
		"\"What the hell? The people that go in there need me, and they're my friends -- \"\n"
		"\"Oh, come off it. They're like pets to you.\"\n"
		"\"Well, we use the term 'familiar' instead of 'pet.' But I still disagree. What the hell's gotten into you, anyway?
		Me living with those idiots is hardly news. Why -- \"\n"
		"\"Look, Jarret, I'm leaving. Moving, I mean. I'm moving to Texas.\"\n"
		"Well. Huh. That \Iis\i news."  
		}

	case 10: 
		{
		SetQuip(3,10,0)
		SetQuip(3,11,0)
		SetQuip(3,12,1)
		SetQuip(3,13,1)

		"\"Okay...\" she says, silently making her uncomfortableness speaking in front of Barnaby and Trott obvious.
		\"The register at the Bead Store is broken. Sydney wanted me to ask you if you'd look at it and see if
		you could fix it.\"\n"

		"\"Ha!\" blurts out Gibs. \"Isn't that always how it is? First they tell you to shove off, and then they're 
		crawling back for technical support.\" Audrey braces herself at that, not wanting to get into an argument
		with him; hoping she can ignore him.\n"

		"\"I don't know, Aud, I'm not a computer expert or anything -- \"\n"

		"\"I know, I know,\" she says, quietly. \"They just wanted you to look at it. Goddess! You interface with the 
		\Isame\i mainframe every night, don't you?\""
		}

	case 11: 
		{
		SetQuip(3,10,0)
		SetQuip(3,11,0)
		SetQuip(3,12,1)
		SetQuip(3,13,1)
		"\"Private would be fantastic,\" says says, quickly. She takes my hand and walks me to the back of the store. 
		We're not really out of the range of Barnaby and Trott, but it's unlikely that they are going to eavesdrop.\n"
		"\"Hey, look,\" I start, \"About before -- \"\n"

		"\"Oh, no,\" she says, \"This isn't about that. We can get some coffee when you get out of work and talk about
		that. No, Sydney and Casey wanted me to ask you a favor. They are having difficulties getting their register
		to interface with the mainframe tonight. Something is broken with their PC. They thought maybe you could
		look at it for them.\"\n"

		"I am crazy about this girl, and I guess I will always be and everything, but her coming over here to get me
		to do work for her friend's store is kind of cold. \"Isn't Mall Security supposed to handle that?\" It's not
		really that I don't want to help, I tell myself, as much as that I'll look like a jerk in front of a small gaggle of 
		girls if I can't fix it. (But then I tell myself that I'm 28 and still afraid to fail a bit in front of some
		chicks. Ouch.)\n"

		"\"They only have one guy working now, what with Christmas Rush being over and everything. And that guy is infatuated
		with a girl over at the lingerie store.\"\n"

		"\"Which one? I know one or two girls that work there.\"\n"

		"\"Not one that works there. He's obsessed with with one of the giant push-up bra posters in the window.\"\n"

		"I consider this for a moment. \"Well... fair enough, I guess. Her breasts on one of those giant posters would
		be six times larger than his head. Or even eight times if it's a good push-up.\""
		}
	
	case 12: 
		{
		SetQuip(3,12,0)
		SetQuip(3,13,0)
		"\"Fan-\Itastic\i,\" she says, with more than a hint of exasperation. \"Let's go.\" I wave to Trott in order to
		inquire if it's OK if I leave the store. He gives me a nod. We run this store through a regime of 
		efficient hand-signals and basic telepathy. Gibs perks up at all of this.\n"
		"\"Hey, I'm coming along,\" he says.\n"
		"\"No, you're not,\" replies Audrey.\n"
		"\"You're out of your mind if you think I'm missing a chance to hang out with the girls at the \IBead\i Store, 
		Yoko,\" says Gibs.\n"

		"Audrey turns to make what I predict to be a sharp comment, but I try to defuse the situation first. \"Audrey 
		isn't anybody's Yoko fucking Ono, Gibs. That doesn't even make any sense, since she's not bringing me down, 
		making me dress poorly, stopping me from shaving and bathing, or getting me shot in New York City. She's not the 
		Yoko to my Lennon, not the Delilah to my Samson. No, what she is, is -- \"\n"

		"\"I'm going to prepare some vomit bags in case you say she's the Laurana to your Tanis,\" says Trott from
		behind the counter. He's referring to the male and female lead of the \IDragonlance\i novels.\n"

		"Nobody says anything for a few seconds. \"Let's just go,\" I say. \"The three of us.\""

		GameEvents[5] = 1

		Activate(Lights_Go_Out)

		Barnaby is following
		Audrey is following
		}
	
	case 13: 
		{
		SetQuip(3,12,0)
		SetQuip(3,13,0)
		"\"Very well,\" says Audrey. \"If you're going to be mad at me, fine. We'll talk about it sooner or later, and 
		certainly I am not completely at non-fault. But don't hold it against Sydney and Casey. They both have an asshole 
		for a boss and will ruin their bonus criteria for next quarter if they don't enter their day's receipts in properly.\"\n"
		"\"Hey,\" pipes up Gibs, \"Those two are over there? Duffy'll be over \Ireal\i soon. I can guarantee that much.\"\n"
		"Audrey just chews her gum for a little bit and stares down Gibs before saying, \"That's super.\" She's practically
		shooting hate daggers out of her eyes at him. But Gibs metaphorically dodges or something, I don't know."

		Audrey_Script_2
		GameEvents[5] = 1

		Barnaby is following

		Activate(Lights_Go_Out)

		}

	case 14: 
		{
		SetQuip(3,14,0)

		GameEvents[13] = 1 

		"\"Really...?\" says Audrey.\n"

		"\"Yeah. It turned one of the mallcops into it. We got by it, we're both okay... but it looks like whatever is
		possessing Sydney also turned the people that work here into the undead.\" Audrey nods in understanding, but
		does not say anything."
		}		

	case 15: 
		{
		SetQuip(3,15,0)
		SetQuip(3,16,0)
		SetQuip(3,17,0)
		SetQuip(3,31,1)

		"\"It's got to stop, Jarret. You know that.\"\n"

		"Eight years ago I was a sophomore at Syracuse University. I had not only barely gotten in, but barely survived my
		first year. My grade point average was a 1.8. (Well, 1.78; I used to always round that up.) My father had two main
		tenets when it came to raising me: obedience and grades. The first half of my sophomore year I failed all my classes
		except for Organic Chemistry Lab and Mythologies II. (Chem Lab was because I was fucking the teaching assistant; bitch 
		still only gave me a B-.) When my father got my semester's grades in the mail he, for the first time, didn't go
		berserk or explode in a wave of profanity. He simply shrugged and said 'it's got to stop.'\n"

		"It feels just the same as Audrey saying it now."
		}

	case 16:
		{
		SetQuip(3,15,0)
		SetQuip(3,16,0)
		SetQuip(3,17,0)
		SetQuip(3,18,1)
		SetQuip(3,31,1)


		"\"Well, when is it going to stop? I mean, really. They're animals.\"\n"
		"\"Oh, come on now! You're over-reacting if you really think that.\"\n"
		"\"Fine, Leary isn't. But he's never around. Those other two? They're out there right now hurling feces at one another
		while masturbating, sorry, \Ifuriously\i masturbating and you \Bknow\b it.\"\n"
		"\"Look, I can't help my roommates, OK?\"\n"
		"\"Yes, you can, Jarret! You're better than this! We're better than this. You're too intelligent and talented to be
		working for minimum wage. But because you are, you have to live with three other people.\"\n"
		"\"Look, I happen to like my job. Shouldn't that account for something?\"\n"
		"\"Jarret, if you had as little going for you as Pang and Criswell then I wouldn't care. I really wouldn't. But I know
		you better, and I know that with the smallest bit of drive or ambition you could be writing, writing \Iwell.\i The guy
		that I fell in love with was the greatest storyteller, er, albeit in the fantasy genre, that I had ever met. And you're just
		sitting on that gift. Seeing you waste yourself like this isn't fun.\""
		}
	
	case 17: 
		{
		SetQuip(3,17,0)
		SetQuip(3,16,0)
		SetQuip(3,15,0)
		SetQuip(3,18,1)
		SetQuip(3,31,1)

		"\"These nights, these days, these dates,\" she says. \"Your roommates aren't that amusing. I hate coming over here when
		those two are around. You know what they are like? They are like a couple that has been together for eight or nine years
		and are starved for entertainment because they are both shallow and, at the core, uninteresting, so they latch and 
		leech on to anyone new who enters their lair. That's not what I think of as 'fun.'\""
		}
	
	case 18: 
		{
		SetQuip(3,18,0)
		SetQuip(3,31,0)
		SetQuip(3,19,1)
		SetQuip(3,32,1)

		"\"Spending time with you is fun, normally. You know, doing date-type things. I am not old enough where I want to 
		spend every evening with my boyfriend just sitting on a couch watching film. My sister became that way, but she works
		all day, is married and is tired when she gets home. I'm not ready to retire just yet.\""
		}

	case 31: 
		{
		SetQuip(3,18,0)
		SetQuip(3,31,0)
		SetQuip(3,19,1)
		SetQuip(3,32,1)

		"\"Well it's not funny!\" she says. \"And I can't think of any substance I could take that would make those idiots
		'funny.' I could give you the formula and arrangement of at least a hundred molecules off the top of my head, and
		not a single one can be ingested in sufficient quantities that would make what went on in there 'funny' without
		killing me first.\"\n"

		"The thing about dating smart girls, I should tell you, is that you don't feel half as bad when they attempt to
		humiliate you. Audrey and I also give each other plenty of time to finish our sentences, which I think is something
		that we both require more than oxygen, fresh water, and C6 H... er, 12, and O... well, glucose, anyway.\n"

		"\"Spending time is normally fun with you, Jarret. Doing date-type things. Even studying when you were still going
		to uni. But this middle-age sitting-around watching-DVDs thing... I'm just not ready for every day to be like this.\""
		}

	case 19: 
		{
		SetQuip(3,19,0)
		SetQuip(3,32,0)

		SetQuip(3,20,1)

		LocationState[4] = 4

		"\"Well, I appreciate the sentiment, Jarret, but it's been like this for a while now. I don't know if it's just the
		inevitable ennui you get when you reach your late twenties or what, but that kind of brings me to what I wanted
		to talk about when I came over tonight...\"\n"

		"I realize now that we're probably only just getting started with what she wants to discuss. Geez. Well, I'll try
		to keep this quick."
		}


	case 32:
		{
		SetQuip(3,19,0)
		SetQuip(3,32,0)

		SetQuip(3,20,1)

		LocationState[4] = 4

		"\"What's skydiving going to fix?\" she asks.\n"
		"\"What \Bcan't\b it fix? Give it a try, Pegasi.\" Gibs tells me that he always puts the word 'skydive' in his on-line
		match maker ads. Look, I'm desperate here.\n"
		"\"That just sounds hokey. I don't know. Maybe.\" I can tell she's at least considering it.\n"
		"\"Well, look, Gibs was telling me that he was a little nervous his first time out. He was up at about 4500 feet
		or whatever you jump at. The instructor tells him to jump and Gibs says, 'no.' The instructor tells him again,
		a little more firmly, to go jump out the goddamn plane. Gibs says 'no' again. I mean, he just freezes up and refuses
		to go. The instructor then says that if he doesn't make the jump, he's going to tear off Gibs's pants and sodomize him
		right in the plane.\"\n"
		"\"Well?\" asks Audrey. \"Did he jump?\"\n"
		"\"Yeah, a little at first, I think,\" I say with a wink.\n"
		"She smiles for a little bit. \"That kind of brings me to what I wanted to really talk about when I came over tonight.\""
		}

	case 20:
		{
		SetQuip(3,20,0)
		SetQuip(3,21,1)
		SetQuip(3,22,1)

		"\"I'm going to be moving soon.\"\n"
		"\"What? Why? Where to? Moving like you're moving to Cheyenne moving or moving like you're moving to Eastern Islamistan
		moving?\"\n"
		"\"To Texas... I'm going to Texas. Houston, specifically. A company from there sent some recruiters up over Christmas
		Break and most of us in my program interviewed well. After I finish up this semester I am taking a job with them and
		headed down there.\"\n"
		"\"Uh... okay.\" \IDon't you break down, Duffy. Do not let this girl get under your skin.\i\n"
		"\"And it goes without saying that I'd love it if you came with me. I mean, I hope you know that.\"\n"
		"\"To Texas. Uh... well...\""
		}
	
	case 21: 
		{
		SetQuip(3,21,0)
		SetQuip(3,22,0)
		SetQuip(3,23,1)

		"\"Really?\" she says, a bit annoyed at my attitude. \"And why's that? You're not worried about losing your seniority
		at that shithole you work at, are you?\"\n"
		"\"No! Jesus. It's not that. But look at it from my perspective. Why would I move to a city where I know exactly
		nobody?\"\n"
		"\"You'd know me.\"\n"
		"\"Besides you.\"\n"
		"\"Some of my friends from class are headed down there. They like you.\"\n"
		"\"I don't know about \Ithat.\i\" I consider that for a second. \"Wait, really?\""
		}

	case 22: 
		{
		SetQuip(3,22,0)
		SetQuip(3,21,0)
		SetQuip(3,23,1)

		"She shakes her head, she doesn't understand what I mean.\n"
		"\"I'm just saying, if you're going to move the hell away then don't beat around the bush. Get to some place that
		I'll really never be able to see you.\" For the record, I thought that mentioning Persephone or another Kuiper Belt
		object would have come off as too sarcastic, but I don't tell her that.\n"
		"\"That's not why I am going there. Why are you being so thick with this? What on earth is keeping you here?\"\n"
		"\"So you want me to come with you?\"\n"
		"She pauses before answering. \"With you like this? No. No, I don't want this version of you coming with me. I
		don't think you get just how much I am into you, Jarret. And it's painful to see you like this. The guy that I
		fell for and have been with all these years would not get defensive about simply moving somewhere.\""
		}

	case 23:
		{
		SetQuip(3,23,0)

		"\"I understand,\" she says.\n"
		"Technically, I had a couple hours before I was due at work, but I might as well go in early and pick up some overtime."
		"\"We can talk about this after I get out of there, right?\"\n"
		"\"Of course,\" she says. Again, in her terse form of communicating more without words than with.\n"
		"\"I get out at eleven. Gibs might want me to do his radio show but I will blow it off if so. I'll give you a
		call when I get home, okay?\"\n"
		"She nods, gives me a hug and leaves my room."

		LocationState[4] = 5

		Activate(Audrey_Leaves_Bedroom)

		Audrey is not hidden

		}
	
	case 24: 
		{
		SetQuip(3,24,0)

		"I say it just like Gollum from the \IThe Lord of the Rings\i talking about the precious of his very own.
		I don't say it at first, I don't say it right away... but I say it and she knows what I mean by it. 
		Her body shakes with a quick, stifled bit of laughter. I'm so glad she's here with me that it doesn't
		even occur to me that it must be \Ikilling\i Gibs to not be able to tell us just how bop we are for
		each other."

		}
	case 25:
		{
		SetQuip(3,25,0)
		GameEvents[70] = 1

		"\"Um... I'm not really sure,\" said Audrey. \"If I remember right, the candle or candles didn't have an 
		apparent identifying trait that I could see...\" She screws up her face in thought for a moment. \"I'll
		think, though, about it...\" It's probably nothing more than ego on my part, but I could \Iswear\i that
		there was a hint of, 'if I don't get it, I am betting that my charming and resourceful boyfriend
		\Icertainly\i will.' OK, maybe a lot of ego, but still."
		}
	
	case 26: 
		{
		SetQuip(3,26,0)
		SetQuip(3,27,0)

		"\"That's cool,\" says Audrey. \"To be honest, I'd rather watch the next one anyway. I think I saw \IBlade\i
		when it first came out.\"\n"
		"I do a double-take when I think about the math involved in that one. \"Waitasec, the Neuromancer didn't like
		you dating me at first because I am three years older than you, but he let you watch \IBlade\i when you were
		like eight?\" I call her old man 'The Neuromancer' because the guy's first name is Henry, and the main character
		of the novel _Neuromancer_ is named Henry Case. She still kind of finds that funny, sometimes.\n"
		"\"What? Come on. It's not that intense.\" She tries to hide the beginnings of a smile, because she knows
		I'm right.\n"
		"\"Okay, but if we have kids and our li'l halflings find my stash of pornography at that age, I am going
		to remember this conversation.\" She raises her eyebrows, but doesn't say anything to that. The sad thing is,
		each time we get together I chuck whatever 'adult materials' I've managed to acquire in the interim, but it's
		not something I've ever gone out of my way to mention."
		}

	case 27: 
		{
		SetQuip(3,26,0)
		SetQuip(3,27,0)

		"\"Not especially,\" she says. \"I think I saw it when it first came out.\"\n"

		"\"What? Are you kidding me?\" I think about the math for a second. \"By my calculations, you were
		eight when it came out. You mean to tell me that the Neuromancer didn't like you dating me at first because
		at three years your elder, I was a bad example, but he was OK with you watching a movie where Snipes hacks
		apart vampires for 90 minutes?\" I call her father 'The Neuromancer' because his first name is Henry, and the main 
		character of the novel _Neuromancer_ is named Henry Case. I've been lucky in not saying it when he's been around
		so far.\n"
		"\"I was very mature for my age,\" she replies. \"I think we'd have been a perfect match, intellectually,
		if you met me when I was eight and you were twenty-seven.\n"
		"\"Hey, what about if you met me?\" says Criswell.\n"
		"\"Two,\" Audrey and I say at the same time."
		}
	
	case 28: 
		{
		SetQuip(3,28,0)
		SetQuip(3,29,0)

		"\"Pretty well, actually.\" Audrey is in the last year of Medical School. It's taken her forever
		to finish up, but I guess that's normal for would-be doctors. \"They are having a dress-up party in my department
		for Martin Luther King day in a couple weeks, you know. You should come.\"\n"
		"\"Who do you have to dress up as?\"\n"
		"\"Someone who did something positive for civil rights.\"\n"
		"\"So you could dress up as someone who freed the slaves, then, right?\"\n"
		"\"Sure. You'd look cute, I think, if you had that Abraham Lincoln-style beard for a few days.\"\n"
		"\"Ah! Ah-ha. Yes.\" I don't bother to tell her that I was thinking more along the lines of Cameron Maj\'ere than 
		Lincoln, which is probably for the best."
		}

	case 29: 
		{
		SetQuip(3,28,0)
		SetQuip(3,29,0)

		"\"Probably storming out of here in anger,\" she says. I give her one of those looks that would look more in place
		on a puppet after the jaw string got cut. \"Just kidding,\" she says after a beat. \"You're working, right? I 
		am actually going to be at the Mall, 'funnily enough.'\" She does that, sometimes, claim my clich\ied remarks
		as her own. \"Sydney and a few of my other friends will be at the Bead Store. I'll stop by.\""
		}
	
	case 30:
		{
		SetQuip(3,30,0)

		"She doesn't say anything. She just nods, looking straight ahead. I can't really blame her... these two idiots
		are really getting in my way tonight, and ruining everything."
		}


	case 33:
		{
		SetQuip(3,33,0)

		"\"What does a plus mean?\" asks Audrey. \"On a home pregnancy test? It means that you're not pregnant.
		Thank God.\"\n"

		"\"Did you have a close call or something?\"\n"

		"\"Yes, \Bwe\b had a close call. Don't you remember? It wasn't that long ago. I had got off ICQ talking to one
		of your ex-girlfriends the night before. She told me that you, quote, 'wig out' when spoken to in Elvish or
		some other made-up language along those lines.\"\n"

		"Audrey continues her story, but I start to get a flood of memories back from that night. I had actually
		deigned to go out clubbing with her for a night a few weeks back. (I usually don't, as I am such a lousy,
		self-conscious dancer.) She was wearing this tight little gray dress with slight horizontal lines across it,
		made out of this fuzzy fabric -- the outfit practically squealed 'do me' by itself.\n"

		"Audrey was grinding her way up against me every time I went onto the floor. I just seizured out. That's the
		only way I know how to dance. I almost never really consume much alcohol, but that night I was taking pull 
		after pull of some Safeway Vodka that Sydney had smuggled into the club as if the contents of the bottle were 
		nothing more innocuous than Mexican Kool-Aid. Audrey and I took a cab back to her place, and we were all 
		over one another before we could find the light switch.\n"

		"She was on top of me for what seemed like the better part of an hour when she dipped down and whispered something
		into my ear. \ITye-mela'ne\i. It's Tolkein Elvish for 'I love you.' We don't seem to say that to each other very 
		much, but even drunk I instantly translated what she said and I... well, I went off like a Soviet 
		Catapult: unexpectedly, unpredictably, and altogether quite messily.\n"

		"I hadn't thought about it -- about the consequences of it -- until just right now. I didn't mean for her to
		go through a pregnancy scare like that by herself. I just wasn't thinking about the details.\n"

		"(For what it's worth, the story that Audrey related as I had this flashback was pretty much exactly like mine, 
		except that she said that we only jammed for something like fifteen minutes. She's got this crazy, post-Einsteinian 
		view of how time really works though, so don't believe her.)"
		}

	case 34:
		{
		SetQuip(3,34,0)

		"\"Is this a first?\" says Audrey, from somewhere in the dark. \"Or, is that he worst clap of thunder you've 
		ever heard here?\"\n"
		"\"Yeah, I think so,\" I say. \"Back in 2012 there was an electrical storm that caused the power to go

		out, but it wasn't a sudden burst like that. The main side effect back then was that the tattoo parlor store
		was working on a guy. He wanted a 'QUEENSRYCHE' tat, but had to wander around with one that read 'QUEENS'
		until the next day when the Mall re-opened.\" I triangulate where Audrey is by her breathing and give her
		a quick pinch on the butt.\n"
		"\"Hey!\" she exclaims, thrashing about, and turning herself around so that she's inadvertedly facing me.
		I give her a very quick, yet very deep kiss and hope that the lights stay off for a few seconds more."
		}

	case 35: 
		{
		SetQuip(3,35,0)

		"\"Right. I heard you. We'll be here...\"\n"

		"I didn't think she was going to jump my bones or anything, but maybe a peck on the cheek? The Mall got much
		colder when Sydney got possessed, but Audrey has managed to keep pace with it and be an even greater Ice
		Queen."
		}

	case 36: 
		{
		SetQuip(3,36,0)
		GameEvents[49] = 1

		"\"We couldn't find any,\" says Audrey. \"I could have sworn that Choad used to carry guns... He told me 
		once -- \" Waitasec.\n"

		"\"What? When did you and Choad ever have a conversation?\" I say the words before my brain catches onto
		the fact that I probably don't want to hear the answer.\n"

		"\"We went out a couple times when we were broken up once. Not that it's any of your business or anything. 
		I didn't get all mad when you took Sydney out during a time-out that one time.\" Right, she only references
		it every time something like this comes up.\n"

		"I decide not to pursue the line of questioning for the moment, but silently and in my head, I am doing
		little else than repeating the mantra, \IGod, if you're in fact up there in Heaven and there is some point
		to us monkeys walking around on Terra Firma like this... please, please, please don't let me live in a 
		world where the love of my life has had Choad P. Riddleman's dick in her mouth. Please, Lord, please!\i"
		}

	case 37: 
		{
		SetQuip(3,37,0)
		SetQuip(3,38,0)
		SetQuip(3,39,1)
		"\"I only went out with you because you made an impression at that event!\"\n"
		"\"The fact that you knew I had at least eight grand in my pocket probably \Ihelped\i, didn't it, Miss Auric
		Van Goldendowser?\"\n"
		"\"That's incredible, coming from you,\" says Audrey. \"Yes, Jarret, it's your money that I am attracted to. 
		You finally pieced it together. Well done. Goddess! You're like a three year old playing \IClue\i for the first time.\"\n"
		"\"Me? You're the one who has apparently come up with this terrible crime: Colonel Duffy in the Game Room with the bag
		of party dice.\"\n"
		"\"You're just terribly dishonest and a horrible cheat. That's all. It changes everything. There's no moral difference
		between you taking that money with a gun and taking it with a dice that only rolled 20s. And furthermore, while we're
		on the subject, \Iautographing\i your character sheet and giving it to me is the most conceited act of arrogance 
		I have \Iever\i witnessed in my entire life!\"\n"
		"\"Let's not say things we can't take back about the autographed character sheet. After all, I know for a fact
		that you still have it.\"\n"
		"\"What?!!\" exclaims Audrey."
		}
	
	case 38:
		{
		SetQuip(3,37,0)
		SetQuip(3,38,0)
		SetQuip(3,39,0)
		SetQuip(3,40,1)


		"\"Oh, it's hilarious, all right,\" says Audrey. \"You know me. There's nothing I find funnier than stories of the guy
		that I've been with for the last five years ripping off everyone I know like a unconscionable rogue at 
		a lawless bazaar.\"\n"
		
		"\"The Wizards of the Coast were going to give that to me anyway. The dice didn't really change anything, other than
		the fact that I made a few extra saving throws and got a few extra hits in. You have to appreciate the return on
		the investment, at least.\"\n"

		"\"Oh, sure. You're a regular Gordon Gecko,\" says Audrey.\n"

		"\"I can't believe you're comparing me to white collar criminals.\"\n"
		
		"\"I can't believe you essentially commit white collar crime.\" Audrey shrugs her shoulders."
		}

	case 39: 
		{
		SetQuip(3,37,0)
		SetQuip(3,38,0)
		SetQuip(3,39,0)
		SetQuip(3,40,0)

		"\"What the hell is that supposed to mean, ass?\" asks Audrey. I don't notice her going into any sort of
		guilty shell, which is good overall, I suppose, but bad for my position in this argument.\n" 
		"\"Nothing, m'lady.\" She's not really convinced that I didn't mean something by it."
		}
	
	case 40:
		{
		SetQuip(3,37,0)
		SetQuip(3,38,0)
		SetQuip(3,39,0)
		SetQuip(3,40,0)

		"\"No, I don't know what you mean, actually,\" she says. \"What are you saying here?\"\n"
		"I give my best sigh of desperation. \"Oh, nothing, nothing at all. I was just taking a shot
		in the dark.\"\n"
		"\"You're really impossible sometimes, you know that?\" she says.\n"
		"\"Well, impossible dice give one confidence when faced with impossible situations. It had an effect
		on you, you know.\""
		}

	case 41: 
		{
		SetQuip(3,41,0)
		SetQuip(3,42,0)

		"\"I'm positive,\" she whispers. \"Can't you see it now? It's transparent, but you can make out the
		red eyes and nose...\" She points straight out towards the perfume kiosk in the foyer.\n"
		"\"No, I still can't make it out... I'll trust you though. OK?\"\n"
		"\"Okay,\" she says. She smiles. \"And I'll trust you to figure out a way past it...\" Right on."
		}

	case 42: 
		{
		SetQuip(3,41,0)
		SetQuip(3,42,0)

		"\"No, Jarret, please... don't go. It's out there. Can't you see it?\" She brings her voice back down 
		to a whisper. \"Please. I can see it rather plainly. It has red eyes and nostrils and it's 
		scanning everywhere... I can kind of \Ihear\i it, in my mind, as well...\"\n"
		"\"What's it saying to you?\"\n"
		"\"It's not talking to me directly. I don't think. It's just ranting... Please, help me figure out
		a way to get past it, okay?\"\n"
		"\"OK, Audrey. I will. We need some silver, I suspect.\""
		}

	case 43: 
		{
		SetQuip(3,43,0)

		"\"That's where we met, isn't it?\" asks Audrey.\n"
		"\"Yeah. It is. Man... you were one hot and na\:ive little number back then, you know that?\" I say this 
		and immediately give her a wink so she knows I'm kidding around.\n"
		"\"I guess I was pretty na\:ive to get mixed up with you, wasn't I?\" She gives my hand a friendly squeeze,
		which is her way of letting me know that she's just joshing with me as well."
		}

	case 44: 
		{
		SetQuip(3,44,0)
		SetQuip(3,45,0)

		"\"Jarret! I don't want that thing in here!\"\n"
		"\"Audrey, you know that I will not let it touch you. There's a lock just like this one in my store, and
		it's made of ridiculously poor components. Everyone involved in owning a store in this Mall is incredibly
		cheap and only worried about the bottom line and how much money they can squeeze out of their customers.
		I will guarantee you that as soon as the temperature is brought down a few degrees Celsius that lock
		is coming off like a prom dress. A lock of this type busted earlier today at my store when Gibs placed
		his iced soft drink next to it.\"\n"
		"\"Okay...\" she says. She kisses me for entirely too brief a time and looks right into my eyes. \"I
		trust you.\"\n"

		"I suddenly feel like I can do anything. One scream and the wraith will make its way over here."
		}
	case 45
		{
		SetQuip(3,44,0)
		SetQuip(3,45,0)

		"\"Well, you said that sunlight will affect it, didn't you?\"\n"
		"\"I don't think that's a good plan. Gibs will eventually recover from his paralysis, and what happens
		if those two stroll on this way and encounter that thing? Gibs could barely handle the ghoul without
		getting himself killed. Waiting until the sun comes up, I don't know Audrey -- I want to get out
		of here as soon as possible.\" She still doesn't seem to be convinced.\n"

		"\"Look,\" I say, as I draw closer to her, \"That thing isn't going to lay a tentacle on you -- \" I freeze
		up as a look of new horror crosses her face. Now's not the time to be particularly descriptive, Duffy. \"As
		soon as it comes closer, that lock is going to pop around like the Impossible Man opening a bottle of 
		discount champagne. \BI personally guarantee it.\b Everyone who owns a store in this dump is concerned 
		with squeezing every dime that they can out of it. A lock busted earlier today at my store when Gibs placed
		his iced soft drink next to it.\"\n"
		"\"Okay, Jarret,\" she says. She kisses me for a moment and looks right into my eyes, as sad and as scared
		as I've ever seen her. \"I trust you...\"\n"
		"I won't let her down. She heads over to the far side of the store. One yell and the wraith'll head this
		way."
		}

	case 46
		{
		SetQuip(3,46,0)
		SetQuip(3,20,0)

		"\"I don't really know, Jarret,\" says Audrey. \"My guess, well... Just a thunderstorm, maybe? Nothing more.\""
		}
	case 47: 
		{
		SetQuip(3,47,0)
		SetQuip(3,48,0)
		SetQuip(3,49,0)

		"\"I'm sorry -- what?\" says Audrey. \"Where the hell do you think you get off talking to me that way?\"\n"
		"\IWords seem forced, as if originated from an alien source.\i\n"
		"\"Gibs is dead! He will be soon enough! And isn't that what you want? All my friends that you don't care
		for to be killed and removed?!\"\n"
		"Audrey says nothing. She glares at me. The silent screaming wakes me up somewhat.\n"
		"\I\"I'm sorry,\"\i I state. I shake my head as if to scramble my own feelings and emotions back
		to their regular state. \"I'll find a solution past it...\""
		}
	case 48: 
		{
		SetQuip(3,47,0)
		SetQuip(3,48,0)
		SetQuip(3,49,0)
		"\"They all are, Jarret,\" says Audrey. Her voice is soothing. She places her hand against my shoulder. \"But I
		know you can do it. The spirit that possessed Sydney hasn't 'cheated' yet, she's been quite fair.\" Audrey's
		face begins to get ruddier, softer. \"Don't you remember about the ghast monster from your gaming days?\"\n"
		"I do. I do! Silver can hurt them, but I think I'm out of that. Brute force, too, but it's probably more than a 
		match for me. What else? Dammit, I know there's something else...\n"
		"Tears fall gently from Audrey's eyes. She's going to tough it out and get through this. But in seeing them,
		I'm reminded. I acquire a slight little smirk. I kiss her tears away.\n"
		"\"Water, Audrey... Your tears, right... they reminded me. The fountain is a glorious religious symbol -- or at 
		least an idolic one, ha-ha. The monster over there will fall due simply to some holy water...\""
		}
		
	case 49: 
		{
		SetQuip(3,47,0)
		SetQuip(3,48,0)
		SetQuip(3,49,0)

		"Audrey says nothing. Casey says nothing. I say nothing.\n"
		"Audrey orders up trump in this euchre-like stalemate of non-conversation and says, \"He wants to feed on all of us
		at the same time, you think, Jarret?\"\n"
		"\"Yeah... I'm guessing so. It's hungry, but not mindless. It might pick away at Gibs if we don't do something soon.\"\n"
		"\"There's been things that have helped so far, haven't there?\" asks Casey with her head so slightly cocked to the
		side. \"It's really just ferocious. It can claw and bite, but... \" She gets a bout of self-consciousness. \"Well,
		it's easy for me to say.\"\n"
		"The three of us stare ahead to where the ghast is lurking, right on the far side of the fountain.\n"
		"\"Why didn't it want to come closer?\" I wonder, aloud."
		
		}
	case 50: 
		{
		SetQuip(3,50,0)

		if location = Book_Store
		{
			"\"I haven't,\" says Audrey. \"Not that I have been to this store often, however. I usually buy books from the Internet
			or go to the library...\"\n"

			"\"Something is getting its kicks from the slow torture of nailing girls to walls, though,\" I say. \"That isn't behavior
			with any undead creature that I can think of. Which of them like to toy with their victims?\"\n"

			"Audrey looks over the poor girl, quickly scanning over the cross and her wounds. \"...Wonder if she had that text on her 
			when she was killed...\""
		}
		else
		{
			"\"I never saw that girl before,\" says Audrey. \"Maybe she was a new hire. Poor thing.\"\n"

			"\"Something is getting its kicks from the slow torture of nailing girls to walls, though,\" I say. \"That isn't behavior
			with any undead creature that I can think of. Which of them like to toy with their victims?\"\n"

			"\"I wonder if she was reading that text when she was caught,\" says Audrey. \"Hmm.\""
		}
		}

	case 51: 
		{
		SetQuip(3,51,0)
		SetQuip(3,52,0)

		GameEvents[76] = 1

		"I chicken out at the last second and only give her a non-verbal head nod. I'm great at those. I can convey novels -- veritable
		\Ibibles\i like that. I can't read it very well, though, as Audrey also give me a head nod and I have no real idea
		what she means in doing so."		
		}

	case 52: 
		{
		SetQuip(3,51,0)
		SetQuip(3,52,0)	

		GameEvents[76] = 1

		"Audrey's not sure how to respond to that.\n"

		"\"You get a free dice polishing down at Hrewreguard's Trading Post,\" I say.\n"

		"Audrey's even \Iless\i sure of how to respond to it now."

		}

	}

   case 4
	{
	!Pang
	select(line)
	case 1:
		{
		SetQuip(4,1,0)
		"Pang just shrugs. \"This place is filthy and smells like an unattended bag of ass,\" he says. \"I need another 
		three or four of these things to make this trip worthwhile.\"\n"
		"\"This isn't the week before the Super Bowl within the French Quarter of New Orleans, for Christ's Sake, Pang. 
		You're in \Icivilization\i, presently. You can't just wander around the city with open containers of alcohol.\"\n"
		"\"This city sucks, this \Itrip\i sucks, and I'll do what I like. Hrmmph.\"" 
		}
	case 2: 
		{
		SetQuip(4,2,0)
		SetQuip(4,3,0)
		"Pang looks at me strangely for a second. \"Watching videos, dummy. Why do you think I went to the store 
		with you?\"\n"
		"\"What, \Inow?\i I am having a date in a few moments!\"\n"
		"\"We have a pact, jerk. None of us can boot the others. Some of us may \Ichoose\i to avoid such situations,
		like Leary is doing... but it's not my problem.\"\n"
		"\"Oh, come on. Don't be such a squick. I don't bother you on your romantic adventures.\"\n"
		"\"That's because I wouldn't bring any women here to this shithole. Are you crazy? Man.\""
		}
	case 3:
		{
		SetQuip(4,2,0)
		SetQuip(4,3,0)
		"\"Not a chance,\" says Pang.\n"
		"\"I'm not kidding around. Audrey is coming by any minute now. Get lost.\"\n"
		"\"No! You know that house rules indicate that none of us can throw the others out.\"\n"
		"\"I'm not asking you to leave. I'm asking you to get lost for a couple hours.\"\n"
		"\"No. I refuse.\" Jerk."
		}

	case 4: {
		SetQuip(4,4,0)
		"\"What?\" asks Pang, with a 'what did I do?' expression on his face. \"Don't be such a killjoy. Jesus. We
		got her in your room for you, which is more than you'd have been able to do for yourself.\""
		}

	case 5: {
		SetQuip(4,4,0)
		SetQuip(4,5,0)

		ScoreArray[4] = 1

		"Pang doesn't say anything at first, a bit taken aback by my outburst.\n"
		"\"You two fucking pieces of shit really make me sick. I know neither one of you have the looks or personality
		to ever get a fucking girl to come over here more than once, but for me, you two acting like a bunch of
		immature little fucks just pisses me the hell right off. What the fuck is wrong with you? How fucking
		old are you?\"\n"

		"\"Hey, look -- \"\n"

		"\"Just shut the fuck up, Chunky. This is the last fucking time. If this shit ever happens again -- if you
		or your little sidekick are anywhere NEAR me when I have her over, I will fucking break both of you.\"\n"

		"Pang doesn't say anything. He just looks over towards Criswell."
		}
	}

   case 5
	{
	!Criswell
	select(line)
	case 1: 
		{
		SetQuip(5,1,0)
		"\"Not a thing, McDickle.\" Criswell holds up a copy of \IThe Truman Show.\i \"You seen this, though?\"\n"
		"\"No, I haven't. I've heard that it's supposed to be good, though.\"\n"
		"\"I dunno...\" he says. His mind wanders a bit. \"This guy is videotaped all the time? I don't know... who'd be up for
		that?\"\n"
		"\"Criswell, you've said that you've taken multiple nude photographs of every woman you've ever been with.\"\n"
		"\"Yeah, but only half of that has been willingly.\"\n"
		"I give him a very thin-lipped smile and desperately turn elsewhere to try to find someone who isn't a mediacentric 
		sexual predator to speak to."
		}  

	case 2: 
		{
		SetQuip(5,2,0)
		GameEvents[60] = 1 
		"\"It's just convenient. The neighbors moved out a couple of weeks ago and turned all their electric heat
		off. The pipes burst and flooded, and since they don't have a basement, things got nice and cold at
		ground level. It's not quite freezing out, so the water is great for bottling beer in. You want me to
		get you one?\"\n"
		"\"No, no thanks,\" I say. \"I have to drive in a couple hours.\""
		}
	case 3: 
		{
		SetQuip(5,3,0)
		SetQuip(5,4,0)
		SetQuip(5,5,0)
		"\"I'll take that as a vote for 'yes',\" says Criswell."
		}
	case 4:
		{
		SetQuip(5,3,0)
		SetQuip(5,4,0)
		SetQuip(5,5,0)

		"\"oooOOOOoo!\" says Criswell, \"Quit your fuckin' crying. You make me sick.\""
		}

	case 5: 
		{
		SetQuip(5,3,0)
		SetQuip(5,4,0)
		SetQuip(5,5,0)

		"\"Ha-haha, Panger! Even Duffy knows this flick stinks worse'n downtown Greeley!\" Criswell doesn't stop laughing for
		a while at his own comment."
		}
	case 6: 
		{
		SetQuip(5,6,0)

		ScoreArray[4] = 1

		"\"Aw, c'mon, Duffy,\" says Criswell. I am getting sick to death of these two loafers telling me to 'come on' and chill
		and the rest of this crap. \"We were just havin' some fun... didn't mean anything by it. Tell 'er to come back on out.\"\n"
		"\"Yeah, sure,\" Why am I wasting time with these cretins?\n"
		"\"Okay, well, then see if she'll at least take her top off.\"\n"

		"I throw him up against the wall. The back of his head knocks hard, and a bit of the drywall crumbles away.\n"

		"\"You want to start with me, you little shit? Bring it on! I don't care what you or this piece of human garbage do with
		the women you manage to trick into coming back here, but you'd better fucking never talk about my girl that way again!
		I'll rip your fucking face off, you fucking \Bnobody\b!\""
		}
	case 7:
		{
		SetQuip(5,7,0)
		SetQuip(5,6,0)
		SetQuip(4,4,0)
		SetQuip(4,5,0)

		GameEvents[70] = 1

		ScoreArray[4] = 1

		"\"Hey!\" says Criswell, but I shut him up before he continues.\n"
		"\"Yeah, fucking 'hey,' alright! Duffy's just being an ass! Duffy just needs to calm down! Fuck you! You're not even
		in your right mind half the time around here. I am sick to death of you two miserable pieces of crap!\"\n"
		"\"Get offa me!\" Criswell backs away a couple paces. \"Hey, I'm sorry that either your girl... or you... happen to
		be on the rag, but -- \"\n"
		"I push him against the wall. A year's worth of frustrations all get channeled into the shove, and Criswell's head
		knocks up against the wall. He goes down to the floor like somebody shot him.\n"

		"\"Hey... Jesus... \" says Pang.\n"
		"\"Shut up, Pang, or I'll do you next.\" To his credit, Pang doesn't say anything else."
		}

	}

   case 7
	{
	!Clerk
	select(line)
	case 1: 
		{
		SetQuip(7,1,0)
		"\"There are only fifteen movies worth seeing. Everything else comprises the disgusting, arched-over shoulders
		that those giants sit upon. These fifteen films are as follows: \ICasablanca,\i 1942. \ISchindler's List,\i 1993. 
		\ICitizen Kane,\i 1941. \IApocalypse Now,\i 1979. \IPhotopia,\i 2012. \IThe Godfather Part II,\i 1974. \IA 
		Clockwork Orange,\i 1971. \IBlue Velvet,\i 1986. \IThe Shawshank Redemption,\i 1994. \IThe Return of the King,\i 
		2003. \IShichinin No Samurai,\i 1954. \IDas Boot,\i 1981. \IFahrenheit 451,\i 2005. \IDouble Indemnity,\i 1944. 
		\IMortal Kombat: Annihilation,\i 1997.\"\n"
		
		"\"Er, what? What was that last one?\"\n"

		"\"\IMortal Kombat: Annihilation,\i\" says the clerk, with commanding authority.\n"

		"\"What are you, mentally handicapped or something? Or what?\"\n"

		"\"Bah! The list is as it can only be. That happens to be the finest video game-based film on the face of the planet. Do
		not argue with me on this!\"\n"

		"\"Are any of those flicks available for rent here?\"\n"

		"\"No. Though I own three copies of each on blue laser DVD -- one in a safety deposit bank, one in my cold
		room and one used for viewing -- it is the opinion of this chain of stores that the average consumer can not and
		will not appreciate any of those landmarks of cinema.\"\n"

		"\"In Mortal Kombat's sense, it's because it's a complete bucket of --\"\n"

		"\"Bah. Bah!!\" The clerk dismisses me with a wave of his hand."
		}
	}

   case 8
	{
	!Trott
	select(line)
	case 1: 
		{
		SetQuip(8,1,0)
		SetQuip(8,2,0)
		"\"Hi, Duffy,\" says Trott. \"Not much going on. Got a postcard from a friend of mine who used to work next door. Did you 
		ever meet him?\"\n"
		"\"The arcade guy? Met him once, briefly. He didn't seem to know who on earth I was when I'd see him passing through the
		mall after that, though.\"\n"
		"Trott chuckles. \"Yeah, that was him all right.\""
		}

	case 2: 
		{
		SetQuip(8,1,0)
		SetQuip(8,2,0)
		"\"Nah, pretty slow night actually. Benji waddled in around five or six and the usual bunch of backpack-wearing kids
		bought their \IMagic: The Gathering\i packs after classes let out. Other than that, nothing of note. Why's Benji even
		having two of us close the store these days?\"\n"
		"\"He still thinks that the bomb that was planted in the arcade a few weeks back had something to do with him. He's as
		paranoid as a dope-smoking Everquest player chilling in a Greek Net cafe.\""
		}
	
	case 3: 
		{
		SetQuip(8,3,0)
		SetQuip(8,1,0)
		"\"Ah, it's just the way my friend talks,\" says Trott. \"That he is living in a town called Rockville is kind of funny because 
		a game that he liked took place in a town called that, although spelled differently. He doesn't know that I got fired from the
		morgue, so he's still making jokes of how I used to feel up the female corpses.\"\n"
		"\"Oh,\" I say. I pause for a second. \"Wait, \Idid\i you?\"\n"
		"\"There were some extremely beautiful girls that showed up in that morgue...\" says Trott, wistfully, \"But no. Never. Well, okay,
		once, but it was a girl that got her limbs blown off in a shoot-out and I needed something to grab onto when she started to slide
		off the slab.\""
		}

	case 4: 
		{
		SetQuip(8,4,0)
		SetQuip(8,8,1)

		"\"What? No,\" says Trott. \"I've been here -- what do you mean, a 'testicle'? Cripes, I -- \"\n"
		"\"I'm just kidding around. Would you have preferred 'gonad'? What did you do when the lights went
		out?\"\n"
		"\"I was in the back room when the lights went out. I heard the auto-kick-in for the gate... kick in, so I
		went out and verified that the thing was locked and that it wouldn't open from the inside. What happened
		anyway?\"\n"
		"\"Duffy interrupted his girlfriend's seance,\" says Barnaby.\n"
		!seance
		"\"It wasn't a seance,\" I say.\n"
		"\"I know. I just wanted to see if you'd be able to resist anal-retentively correcting me.\"\n"
		"Trott waits a bit before he says anything further. He doesn't like Gibs much.\n"
		"\"Anyways,\" says Trott, \"The only way to get out is to get the mallcops to let me out. I made
		my way back through the first door when I saw that thing. It took a chunk out of my side, but I
		eventually got by it, ran in here and locked the door. What was that? It wasn't a bot. It was wearing 
		the clothes of one of the security guys who works at the Mall. But what happened to him?\""
		}

	case 5: 
		{
		SetQuip(8,5,0)

		"\"What do you mean, 'turned into a zombie?' That guy was a nobody. Just some schmuck who was as bad at
		his job as anyone else in this dump. We're all mindless zombies in here.\"\n"
		"\"No, not like that,\" I say. \"Whatever summoning Audrey was trying ended up working. Her friend
		Sydney is possessed by someone. That someone stated that we'd find the Mall governed by the undead rules.
		I guess it's turning the Mall denizens into the undead.\""
		}

	case 6: 
		{
		SetQuip(8,6,0)

		"\"Well, it took a chunk out of me.\" Trott lifts his shirt up to show some deep claw marks just below
		his rib cage. \"I first saw it when I went through the door to our back room. I was able to get back,
		and it started groping at the window every few seconds. I timed it, opened the door, and just bolted
		back here. I sure had no idea where it was or if it had followed me... looks like it was just on the other
		side of this freaking door!\""
		}

	case 7: 
		{
		SetQuip(8,7,0)

		"\"When?\"\n"
		"\"When we were fighting that freaking thing,\" I say.\n"
		"\"Oh. No,\" says Trott. \"I heard the fighting but I guessed that it was another creature or something. I
		was hoping that you'd all take each other out, like when imps start fighting each other in \BDoom\b.\"\n"
		"\"In what?\"\n"
		"\"\BDoom\b. The game, \BDoom\b? Don't tell me you don't know what \BDoom\b is. Oh dear. Ohhh, dear.\"\n"
		"\"Hey, I don't give you crap for not knowing what Man Down Defense is,\" I say, trying to use sports knowledge
		against Trott.\n"
		"Trott stops for a beat and calmly says, \"That probably didn't come off quite as scathing as you thought
		it would have.\" Unfortunately, he's right. Damn 'im."
		}

	case 8:
		{
		SetQuip(8,4,0)
		SetQuip(8,5,0)
		SetQuip(8,6,0)
		SetQuip(8,7,0)
		SetQuip(8,8,0)
		SetQuip(8,9,1)
		SetQuip(8,10,1)

		"\"I think so,\" he says. \"Much of it was damaged before I got here, but I can turn on power and raise
		the gates to some of the individual stores.\"\n"
		"\"Can you raise the gate to the Sporting Goods store?\"\n"
		"\"Ummm,\" Trott says, as he looks over the console, \"Yeah. That one I can turn on. Do you want it on 
		now or later?\""
		}

	case 9: 
		{
		SetQuip(8,9,0)
		SetQuip(8,10,0)

		move phone to Duffy

		GameEvents[48] = 1 

		move Audrey to Corridor1
		move Casey to Corridor1

		if security_blinds is not open
		{
			LocationState[13] = 1
		}

		"\"Okay. Hey, here, take this phone. They only let the mallcops use it as a CB radio, but when you get over there, just 
		give me a yell and I'll lift the gate.\"\n"

		"I take the phone from Trott."
		}
	
	case 10: 
		{
		SetQuip(8,9,0)
		SetQuip(8,10,0)

		move phone to Duffy

		GameEvents[48] = 1 

		move Audrey to Corridor1
		move Casey to Corridor1

		if security_blinds is not open
		{
			LocationState[13] = 1
		}

		"\"Okay... \" Trott flips a few switches on the console. \"It's up.\"\n"
		"\"Thanks.\"\n"
		"\"OK, before you go, why don't you take this phone? The Mall only pays for it to work as a CB radio for the mallcops, 
		but if you need more gates raised, just let me know through it.\"\n"
		"\"All right, sounds like a plan,\" I say. \"I'll try to keep you posted as to what is going on out there.\""

		choadgate is open

		}

	case 11:
		{
		SetQuip(8,11,0)

		BO_Hall3_door is not locked

			if Trott not in location
			{
				"\"Yeah, one sec,\" says Trott. I hear the lock release go on the door. \"Should be all set,\" he says."
			}

			else
			{
				BO_Hall3_door is open

				if GameEvents[48] = 1 
				{
					"\"You know, you can use the phone,\" says Trott. \"Just talk into it. Anyway,\" he says as he flips
					a switch in the console, \"You're all set.\""
				}
				else
				{
					"\"Yeah, one sec,\" says Trott. He makes flips a switch on the console. \"Should be all set,\" he says."
				}
			}
		}
	case 12: 
		{
		SetQuip(8,12,0)

		"\"Uhm, I think that one is broken, let me check...\" I hear Trott put down his cell. \"Nope, it's not broken.
		A lot of them in the area are, though.\" I hear the lock release to the gate, and the gate starts to slowly
		rise. \"OK, you should be all set.\"\n"

		"\"We are, man. Thanks.\"\n"

		choadgate is open

		"\"Look, this won't take me but a moment,\" says Gibs. \"I know just where they'd keep the shotguns. I'll
		be right back.\"\n"
		"\"I want to look for some equipment like pads or something,\" says Audrey.\n"
		"\"Oh!\" I say. This is good news. \"So, you finally, you know, got your 'visit' and everything?\"\n"
		"Audrey's expression turns to one of surprise and then revulsion. \"Jesus, Jarret! No! I meant pads like 
		shoulder pads or shinguards. For defense.\" She rolls her eyes. \"What's \Iwrong\i with you?\"\n"
		"\"Oh, right, right. I'll, ah, stay here with Casey and furiously guard the entrance, then.\" I look far and nigh for evil."


		LocationState[12] = 4

		move Audrey to Mallstore2
		move Barnaby to Mallstore2

		Audrey is not following
		Barnaby is not following
		Casey is not following

		SetQuip(11,1,1)
		SetQuip(11,2,1)

		}
	case 13: 
		{
		SetQuip(8,13,0)

		Activate(Zombiebot_Returns)

		LocationState[20] = 1

		"\"Uhm, yeah...\" Trott shifts uncomfortably.\n"
		"\"I think it's high time we talked about it.\" I look him dead in the eye, but Trott doesn't respond. \"C'mon! What
		the fuck went on that night?\" I start to get really agitated and animated. This is how you need to be to get through
		to Trott sometimes. \"All that undead? What \Iwas\i all that? How on earth have you rationalized that in your mind?\"\n"

		"Trott looks around for a cigarette. He finally finds one and takes a long drag on it.\n"

		"\"Truth to tell, Jarret... heh. I deal with it every day by remembering to completely forget about it. I put it all out of 
		my head. Let me tell you a story.\" Trott offers me a cigarette. I accept.\n"

		"Trott exhales a long stream of smoke. \"When I was in college, a few of my friends and I were playing with a ouija board. 
		 I had never done it before. And neither had my friend Raida. We were both put together on the board, on opposite sides, naturally.
		As first-timers, this was going to be of interest to the old pros.\"\n"

		"\"Naturally,\" I say.\n"

		"\"Well, the 'spirits' were asked a bunch of questions. We saw the planchette moved intelligently to the different letters.
		I know for a fact that I didn't move it. I am pretty sure that she didn't as well. What we saw and what we were told through
		the board spooked the hell out of us. The spirits knew our names and threatened us and told us that they were going to suck 
		down our souls and so forth. There was only one thing that bugged me, though.\"\n"

		"Trott frowns. \"Well, actually, the entire thing shocked the living Christ right out of me. But anyway. At one point
		\IHerr geistenhaus\i was asked which one of us they were going to get first, me or Raida. The ghost said that it was going
		to be me, and spelled my name out T-R-O-T-T. Three instances of the letter 'T.' Immediately after, a similar question
		was asked, and Raida's name came up. Her name was spelled -- by the spirits! -- with the letter 'I' and not 'Y.' So not
		only are those beasties in contact with us on the physical plane, but they also instinctively knew how to spell our names
		with all our crazy variants. Oh, and it referred to me by my last name rather than my first. Of course.\"\n"

		"\"What the hell is your first name, anyway?\" I ask.\n"

		"\"Sveinsgeirdttir,\" says Trott. I wouldn't have guessed that. I would have gone with 'John' if pressed. \"It's
		Norse,\" says Trott, helpfully.\n"

		"\"Anyway. I borrowed the board a couple nights later. I set it up on my bed. Raida and I put it backwards to us, and we 
		closed our eyes. I set up a webcam to record what happened on the board.\" Trott takes a thoughtful puff. \"And what happened 
		later, away from the board, too, as it turns out.\" He shakes his head to remove a quick smile based on old memories. 
		 \"We got back gibberish from what we asked. You'd think the banshees and demons could account for the board being oddly
		placed, but they couldn't, apparently. Ah! Ah! Ah! There is something called the ideomotor effect, I later learned. But
		the point is... there's plenty of standard explanations for remarkable things that happen that everyday. So Sydney was
		'levitating.' Sometimes magnetism looks like super powers. It got cold in the Mall. \IFuck.\i The power was out. And when
		is it ever not cold in the Mall? July? People turned into monsters...\"\n"

		"\"Admittedly, tougher to explain,\" continues Trott. \"Maybe the government tried out an ebola strain on people.\" He
		lowers his voice. \"People like Rudolph. Er, Randolph. Whoever.\" He looks around the store to make sure nobody
		else has wandered in. \"It's already legal to create a bot and just let it run loose around town. I don't know for
		certain. But I do know that I am not prepared to blindly believe in anything. I don't mind playing role playing games
		and being a dungeon master and whatever else, but I certainly won't baaa-baaaa my way around life and absorb every
		pseudo-supernatural event I encounter like a peanut-brained little sheep.\""
		}


	case 14:
		{
		SetQuip(8,14,0)
		"\"She's apparently been turned into a zombie, but I don't know how she got outside,\" muses Trott. \"I'm presuming
		that nobody outside the Mall was affected by any of this... I guess it's good, though, as it indicates that 
		there \Bis\b a way out.\"\n"

		"\"Well, that answers some questions, I guess,\" I say."

		CharExclaim(Barnaby, ExclaimArray[31])
		}

	case 15:
		{
		SetQuip(8,15,0)

		"\"Hmm,\" says Trott, \"Let me try... argh. I can't. I'm not getting anything to respond in that area.\""
		}



	}

   case 10
	{
	!Sydney
	select(line)
	case 1:
		{
		SetQuip(10,1,0)
		SetQuip(10,2,0)

		"\"Oh, I'm doing well,\" she says. \"You're certainly looking yummy.\" She gives me a wink to complete the round of
		flirting. During one of the countless times that Audrey broke up with me, I spent the night with Sydney and we've
		both enjoyed teasing Audrey about what just went on, as she doesn't completely know. I don't mean to turn into
		John Cusak after doing Lisa Bonet in \IHigh Fidelity\i or anything, so I'll say that we only screwed around for
		a little bit. Nothing particularly thrilling. I just kind of think that Sydney used to have a crush on me, so
		she went as far as she could go without completely betraying her girl friend."
		}

	case 2:
		{
		SetQuip(10,1,0)
		SetQuip(10,2,0)

		"\"Oh, you too, Jarret. You look healthier for some reason.\"\n"
		"\"I've quit smoking.\" I shrug thinking maybe that's it.\n"
		"\"Maybe you just need to be better tempted...\" Sydney gives me a wink to let me know she's just harmlessly
		flirting. It also drives Audrey up the wall, as Sydney and I spent a night together after one of the million
		times that Audrey broke up with me. Nothing scandalous went on, but Sydney still likes to tease her best
		friend over it."
		}
	
	case 3:
		{
		SetQuip(10,3,0)

		"She doesn't say anything in response.\n"

		DoCheckOnSydney()
		}

	case 4:
		{
		SetQuip(10,4,0)
		SetQuip(10,5,0)

		"\"Forgive me, Jarret, if they look a little lived-in. They've just seen so much, far more than this delectable little host. 
		What seems like thousands of years of Hell and suffering takes its toll, eventually...\"\n"

		"It seems as if Sydney has been possessed by something, something that engages in more dramatics than a Marxist student 
		film starring a bunch of teenage mimes with Livejournals." 
		}

	case 5:
		{
		SetQuip(10,5,0)
		SetQuip(10,4,0)

		"\"One finger,\" she says. \"Your middle finger, of course. That's not a very nice gesture, Jarret.\" There's something definitely
		off regarding her voice."
		}

	case 6:
		{
		SetQuip(10,6,0)

		"\"Oh, she's gone, now. Her tight little body is writhing about as she is now my possession. And you 
		should hear her plead, trapped within this little gem of mine, all tears and slick and naked and mine. Forced to her knees because 
		her long legs are too long for my little trap, banging on the ruby, jeweled walls that make up her prison. I'd better lock it 
		down before she knocks it off my mantle, don't you agree? I have an eternity to toy with her, and as my strength builds, I'll have 
		you all the same way.\""
		}

	case 7:
		{
		SetQuip(10,7,0)

		"The spirit gives me a very placid look through Sydney in response.
		She has temporarily quit with her act of smug arrogance. She rolls
		her eyes up in thought, though.\n"

		"\"It took so much energy and talent to enslave everyone outside
		the circle,\" it says. \"I didn't even get everyone present
		within this structure. Some escaped my touch through elemental means.
		But the net worth of everyone I consumed was very low. It took more
		energy to change them than I got back in tasting them. So I must
		recharge. I think you and your friends are held at bay for now,
		however. And I'll play with this little blonde I have in a bottle
		while you try to parse everything out.\" The spirit lowers its
		voice.\n"

		"\"This girl, this 'Sydney' -- she's a squealer, did you know that?
		She's promised a dozen times over to do what she could to sell all
		of you out if only I'd let her go free. But really... what could she
		even do to help me? I ripped that scrap of leather she was wearing off
		her and have been flicking a forked tongue all around her naked 
	 	little tits for a while now... I'm going to corrupt her soul nicely so that when you enter
		my realm she'll torture you because she wants to.\"\n"

		"The spirit sighs. \"I haven't had a toy blonde to play with for thirty
		thousand years. Never again will I allow such an eternity of a delay.\""
		}

	case 9:
		{
		SetQuip(10,9,0)

		"The spirit shrugs. \"I can't be expected to remember them all. They're
		nothing to me. I simply scanned your mind for monsters and turned them
		into what you came up with. I needed your mental help to do it, so 
		don't blame me that there are... what do you call them. 'Zombies' and
		'slinkers' and 'banshees' running around. If you had been raised correctly
		you would find yourself sliding down tasty, peppermint chutes and sliders
		because your only fears would be brought on by bad times playing 'Candyland.'\"\n"

		"That one takes a moment to settle in. \"What?\" It doesn't hurt
		to request some clarification.\n"

		"\"Never mind... forget it,\" says the spirit. \"I changed just about
		everyone. I missed one of your friends with the stench of death about
		him, but that could not be helped. Another girl that you worked with
		once almost made it out, but I got her good in the end. She's probably
		still a little cross about how it turned out, except that her soul is
		pleasuring a gaggle of horrors and every single hole she has in life
		is being viciously raped with ethereal flesh that burns at three thousand
		degrees.\""
		}

	}

   case 11
	{
	!Casey
	select(line)
	case 1:
		{
		SetQuip(11,1,0)
		SetQuip(11,3,1)
		"\"I broke up with my boyfriend not too long ago,\" says Casey. \"Other than that, nothing much.\"\n"
		"\"Hey, really? What brought that on?\"\n"
		"\"He never wanted to go do anything,\" she says, \"But you know what it was, really? He would always
		wear a baseball cap, and wear it so that the bill was always right over his eyes. Every time I would try
		to kiss him, I would have to navigate around the thing. Romance shouldn't be a frustrating puzzle
		in three-dimensionality, you know? Sometimes I just wanted to get intimate, not play a real-life game
		of \BKlax.\b\"\n"
		"I don't know what \BKlax\b is, so I just nod in agreement."
		}

	case 2: 
		{
		SetQuip(11,1,0)
		SetQuip(11,2,0)
		SetQuip(11,3,0)
		SetQuip(11,4,1)
		"\"I don't think she wants to, but...\"\n"
		"\"But I'm doomed, aren't I?\" This is something that I guess I have been preparing myself for all night.
		Hit with it, I guess I am a bit surprised to find that the effect isn't one of soul-crushing disappointment.
		Maybe because moments like this have happened to me so many times before. Actually, getting dumped by Audrey
		is starting to become one of the things in life that I am pretty good at.\n"
		"\"No, not doomed. Let's just say (how should I put this) that while you're not inside the Tomb of Horrors,
		per se, the party is definitely equipped, well-rested and approaching the hill.\"\n"
		"\"...OK.\" I don't know quite how to respond to that.\n"
		"\"Look, I want to see you two together, Duffy. You have to trust me on that.\""
		}

	case 3: 
		{
		SetQuip(11,3,0)
		SetQuip(11,2,0)
		SetQuip(11,4,1)
		"\"That's definitely a point in his favor. Make sure he gives me his number when we get out of here. I'm
		tired of being either cooped-in on the weekend or hanging out at the Bead Store like tonight.\"\n"
		"\"You seem awfully confident that we are going to get out of here.\"\n"
		"\"Shouldn't I be? From what Audrey tells me, whatever we resurrected... or, I guess, 'surrected' in this
		case, isn't any match for the geek encyclopedia you've got knocking about in that skull of yours.\" She 
		gives me a genuine smile of reassurance and I, to my discredit, don't have the heart to tell her that in 
		reality most of the thoughts knocking about in my head have to do with how I'm going to get back with her
		best friend."

		}

	case 4:
		{
		SetQuip(11,4,0)

		"\"You're going to have to ask her that, eventually, Jarret.\"\n"
		"\"Yes. I know. Eventually.\"\n"
		"\"What does she want? She wants to be with you, in my opinion, anyway. I've seen her with other guys in between
		the dozen or so times you two have broken up. She is always so much happier when she is together with you. She just
		lights up when you enter the room, you know that?\"\n"
		"\"I didn't know that.\" I try to think back the best I can, to try to get some sort of visual holographic proof
		of this, but I just can't. Maybe I've just never been paying attention.\n"
		"\"But she wants to see you take the next step, Jarret.\" Casey turns and looks right into my eyes. \"She's going
		to graduate soon. The future is coming and everything. I think, ultimately, what she wants to know is if you think
		you have one.\""

		Activate(Ghoul_Appears)

		}
	case 5: 
		{
		SetQuip(11,5,0)

		"\"Mister Duffy,\" she says. Casey's got this thing about referring to people by their last name. \"You still
		breaking my best friend's heart?\" She can't help a smile briefly crossing her face. She knows as well as I
		how crazy Audrey can get.\n"

		"\"Evidently. I'm not the best person to ask. I'm more a hapless bystander in all of this.\""
		}

	case 6: 
		{
		SetQuip(11,6,0)

		"\"What was it?\" asks Casey.\n"

		"\"It was a ghoul.\"\n"

		"\"So, so far, a skeleton, zombie and ghoul... \" Casey drifts off and leaves that bit hanging in the air.\n"

		"\"Yeah. So far, just as the demon that possessed Sydney claimed.\""
		}

	case 7:
		{
		SetQuip(11,7,0)
		SetQuip(11,8,0)

		"\"You coward!\" screams Casey, \"They need you in there! You have to help them!\" She turns and looks into the 
		store. \"What is that? It's blue and purple and \Ifull\i of fangs! Jarret, you have to get in there!\"\n"

		"I continue to balk at going in there.\n"

		"\"Jarret... please...\" She's one step away on the plead chain from calling me Mister Frodo and stating that she
		can't carry my fists but she can carry me."
		}

	case 8: 
		{
		SetQuip(11,7,0)
		SetQuip(11,8,0)

		"\"What are you looking for?\" asks Casey.\n"

		"\"I have an idea of what to expect in there. I've seen a skeleton and a zombie, and I'm afraid that a ghoul is the next
		thing shining a light at me from an oncoming pain train... and they paralyze people.\"\n"

		"Casey just sort of looks at me blankly, hoping I will go inside and help Gibs and Audrey.\n"

		"\"Look, Casey, I just have to make sure that the thing doesn't touch my skin. In addition to not clawing at me, 
		rending me apart, slashing me to and fro and basically eating me...\" She doesn't really care about the details."
		}

	}

   case 18:
   {
	!Spectre
	select(line)
	case 1: 
		{
		SetQuip(18,1,0)

		"\"...\"\n"
		"The spectre says nothing and just looks right through me."
		}

	case 2: 
		{
		"\"... Blood...\""
		}

	case 3: 
		{
		SetQuip(18,3,0)

		"\"... So thirsty...\""
		}
	case 4: 
		{
		SetQuip(18,4,0)

		"\"...\"\n"
		"The spectre says not a word and just looks sadly through me. I had more to say to it, so this particular brush-off is
		rather unfortunate."
		}
	}


   case 21:
   {
	!Vampire
	select(line)
	case 1:
		{
		SetQuip(21,1,0)
		SetQuip(21,2,0)
		SetQuip(21,3,0)
		SetQuip(21,5,1)
		SetQuip(21,6,1)



		LocationState[6] = 6 

		"\"Oh! You are referring to my toy?\" She laughs again. Her smiling face is enough to figuratively light up the room when she 
		does that. I know she's undead and probably evil incarnate but she's also ravenously gorgeous.\n"
		
		"\"She is mine now, Dzharret. You can not have her back. I bit her, unless you do not see? She is mine now. It is kind 
		how it works. She will fall in the next several moments when I test the lot of her remaining blood. But why greedily 
		devour her taste, no? Especially when there are others to a banquet in the evening, still.\"\n"

		"\"You're not going to get your filthy fangs anywhere near me.\"\n"

		"She doesn't seem to understand at first. \"Oh, no, of course not you, silly! I much prefer the taste of a girl. You
		can relate to this. To her, later, as well,\" she says, indicating Audrey. \"She will be mine like this one is.\"
		She turns towards Casey. \IShow him, my toy...\i"
		}
	case 2:
		{
		SetQuip(21,2,0)

		LocationState[6] = 2 

		"\"I bet you are just brimming with questions. I will help you if I can. Have no doubt, though, Dzharret. I am going
		to end your life. You may or may not be my slave in the afterlife. She certainly will,\" she says, pointing over
		to Audrey. \"You, probably not so much, even though your Alpha Male status I find intriguing. But by all means,
		ask your questions. I can wait. I have forever!\""
		}
	
	case 3:
		{
		SetQuip(21,3,0)

		LocationState[6] = 2 

		"She throws her head back and laughs. \"What could you do with her if you were to have her again, Dzharret? She is
		my prize already! Are you thinking of traveling to your, how do you say, apothecary and giving her one of your
		wonder drugs? She is vampirekin now. Forget her.\" Her lips turn to a smile. \"Think of me instead. We need not 
		be separated by these distances, you know. You're going to hurt me?\" She cocks her head to the side, like a 
		puppy attempting to discern the validity of what it suspects is its name.\n"
		
		"\"Your advice is to not do such a thing,\" she says. \"Come closer, instead. The ichor in my veins is not nearly 
		so cold as you suspect, you should know.\""
		}

	case 4
		{
		SetQuip(21,4,0)

		LocationState[6] = 2 

		"\"I cannot allow you to do that, Dzharret. But in the interests of sport, allowing you the first move. You
		fascinate me so, however, so I wish that you would talk to me. We have so much we could discuss!\""
		}

	case 5
		{
		SetQuip(21,4,0)
		SetQuip(21,5,0)

		LocationState[6] = 3 

		"\"I do not have that much more information, Dzharret, than yourself. You raised her possessor, did you not?\"\n"

		"\"I didn't have a goddamn thing to do with it. I was just outside their little circle -- \"\n"

		"\"Ah. Indeed. So it was imprinted upon you. I actually do not know more than you but to be free again... 
		it is exhilarating! The consumption of life... oh, Dzharret, you would not wish to see life this way? Truly? 
		You will look into my eyes, will fall in love, and say to me that you you feel this road is so within traverse...\""		
		}

	case 6
		{
		SetQuip(21,6,0)
		SetQuip(21,5,0)
		SetQuip(21,4,0)

		SetQuip(21,7,1)

		LocationState[6] = 3
		
		"\"Oh, no, dear Dzharret. I most certainly am not. Your Satanic belief system brought this all into being.\"\n"

		"\"It wasn't mine!\"\n"

		"\"No? Am I not here due to your obsession with all manner of 'undead' (ugh!) beings and such?\" She smiles. A horrible
		grin. \"It seems to be all you think about. Which I find so unfortunate and so vexing. You have really been taken prisoner
		by how you choose to spend on your times. How is your escaping?\" She cocks her head to the side.\n"
		
		"\"What does one do when confronted with a necrotic tether?\""
		}

	case 7
		{
		SetQuip(21,7,0)

		"Kali's eyes grow big. I see her worried for the first time. Then she 
		laughs. Her glee is so wholesome and infectious. I feel calm inside even as she mocked me.\n"

		"\"Always the right, Dzharret? Ha ha... Very well. So very well is excellent. You beat and war and 
		you avoid your displacement in proportion to most in the best way you you can, and I give to 
		you the largest successful circumstances that it it comes truly. Is so attractive in your ability for 
		yourself?\" Her smile lingers for a instance too long, but does finally fade away. Maybe I 
		imagined it to begin with. I just know I have little else to ever say to her."
		}


	}


   case 26: 
   {
   !Zombiebot2
   select(line)
	case 1: 
		{
		SetQuip(26,1,0)
		SetQuip(26,2,0)
		SetQuip(26,3,0)
		SetQuip(26,4,0)

		"The customer doesn't respond, and doesn't react as if it had heard me."
		}
	case 2:
		{
		SetQuip(26,1,0)
		SetQuip(26,2,0)
		SetQuip(26,3,0)
		SetQuip(26,4,0)

		"The swarthy customer doesn't say anything, but reacts slightly when it hears the word 'robot.' What
		a piece of junk. It knows what it is but can't respond."
		}

	case 3: {
		SetQuip(26,1,0)
		SetQuip(26,2,0)
		SetQuip(26,3,0)
		SetQuip(26,4,0)

		"The customer's day does not seem darkened by this wholly truthful revelation."
		}

	case 4: 
		{
		SetQuip(26,1,0)
		SetQuip(26,2,0)
		SetQuip(26,3,0)
		SetQuip(26,4,0)

		"This thing must be a non-human lifeform, as there isn't anyone I know that doesn't at least perk
		up a bit when the conversation switches to strippers."
		}
	}


   case 27: 
   {
   !Revenant
   select(line)
	   case 1:
		{
		SetQuip(27,1,0)
		SetQuip(27,3,1)
		SetQuip(27,4,1)
		SetQuip(27,5,1)

		Revenant.article #1 = "the"

		"\"How am I?\" asks the Revenant. He considers this for one moment, which quickly becomes two. And then an uncomfortably
		extended one. I have no idea what etiquette demands of someone inquiring as to the general health and well-being
		of the undead.\n"
		"The Revenant clears its throat. It sounds like he had about a pound of phlegm to juggle. \"I am deceased,\" he says,
		finally. \"...Yourself?\"\n"

		"\"Can't complain, I've got my health, yeah. Look, I -- \"\n"

		"\"Were you my killer?\"\n"

		"\"Huh?\"\n"

		"\"Were you my killer?\" he asks again.\n"

		"\"Me? No. But listen. There is a demon who has possessed one of my friends. Can you -- \" The Revenant interupts me
		once more.\n"

		"\"How sure are you that you are not my killer? Let me state again, lifeling. \BDid you end my mortal existence?\b\""


		   }
	case 2: 
		{
		SetQuip(27,1,0)
		SetQuip(27,2,0)
		SetQuip(27,3,1)
		SetQuip(27,4,1)
		SetQuip(27,5,1)

		Revenant.article #1 = "the"

		"\"My face,\" repeats the Revenant. \"My face was hideously scarred in the battle that ended my life.\"\n"
		"\"Well... at least it wasn't scarred for very long, then.\" Hell, I have no idea what to tell the guy. I am
		just happy he's not attacking.\n"
		"\"Were you my killer?\" asks the Revenant. \"Did you end my life?\""
		}

	case 3: 
		{
		SetQuip(27,1,0)
		SetQuip(27,2,0)
		SetQuip(27,3,0)
		SetQuip(27,4,0)
		SetQuip(27,5,0)

		Revenant.article #1 = "the"

		"The Revenant grumbles, and resumes its distant staring. He appears a bit unsatisfied at my answer, as he
		is unable to initiate combat with me based on my answer."
		}

	case 4: 
		{
		SetQuip(27,1,0)
		SetQuip(27,2,0)
		SetQuip(27,3,0)
		SetQuip(27,4,0)
		SetQuip(27,5,0)

		SetQuip(27,6,1)
		SetQuip(27,7,1)

		if Food_Court1 is visited
		{
			SetQuip(27,8,1)
		}

		Revenant.article #1 = "the"

		"\"Who!\" booms the revenant. \"Who was my killer? You must tell me all you know!\""
		}

	case 5: 
		{
		SetQuip(27,1,0)
		SetQuip(27,2,0)
		SetQuip(27,3,0)
		SetQuip(27,4,0)
		SetQuip(27,5,0)

		"The Revenant reaches within his robe and pulls out a dark, smoke-blasted sword. He swings it once in a mock
		salute and then quickly begins his attack."

		Revenant.peaceful = false
		Revenant is villain
		fight_active = 1 

		}

	case 6: 
		{
		SetQuip(27,6,0)
		SetQuip(27,7,0)
		SetQuip(27,8,0)

		"\"Then this spirit shall die!\" booms the Revenant. \"Off we are!\""

		Revenant_Script_1

		}

	case 7: 
		{
		SetQuip(27,6,0)
		SetQuip(27,7,0)
		SetQuip(27,8,0)

		"\"This spectre... he is not my killer. This I know,\" says the Revenant, quietly."
		}

	case 8: 
		{
		SetQuip(27,6,0)
		SetQuip(27,7,0)
		SetQuip(27,8,0)

		"\"Then this 'Kali' shall be boiled away into hell!\" booms the Revenant. \"Off we are!\""

		Revenant_Script_2
		}

	case 9:
		{

		SetQuip(27,9,0)

		"The Revenant silent stares ahead for an uncomfortable amount of time. Should I leave or something? Add more? 
		He's really difficult to gau--\n"

		"\"Mistakes are made,\" he says with infinite calm. \"No real harm has been done.\" Whatta guy."
		}

	case 10:
		{
		SetQuip(27,10,0)
		"\"REST!\" bellows the Revenant. I'm momentarily taken back by his outburst: there are absolutely no other
		sounds audible this far into the Mall. \"A sweet, everlasting relaxation that I so richly deserve. Many
		cultures have had many different names for it. Nirvana... Heaven... Ragnar\:ok...\"\n"

		"\"Actually, Ragnar\:ok wasn't a final state of bliss, like the Sanskrit Nirvana, but rather a foretelling of -- \" The
		Revenant cuts me off and continues his monologue. What a complete cock!\n"

		"\"A final resting place for a warrior such as I. It is as I deserve. I crave it, desperately... but first I must
		find the one that put me into this state and remove her from this world.\"\n"

		"I give the guy the fingerguns sign. \"Good luck with that,\" I tell him. Jerk."
		}

	case 11: 
		{
		SetQuip(27,11,0)

		"\"She was not,\" the Revenant says quickly. \"It is of little matter, however. Mistakes get made. She offered
		no real value to this world or any others. She will not be back for the foreseeable future.\" \n"
		
		"\"That's excellent,\" I reply. \"Thanks.\"\n"

		"\"There is no need for thanks. It was not a favor I did, but an attempt to uncover the truth about my death.\" 
		I give him a quick look of sympathy and understood pain, but it's totally fake. I'm hoping he can't determine
		my ruse, what with the flamb\'eed face and eyes and everything. But either way he seems pretty relaxed."
		}

	}
	
   case 29: 
   {
   !Magic Mouth
   select(line)
	case 1:{
		SetQuip(29,1,0)
		SetQuip(29,2,0)
		SetQuip(29,3,0)
		SetQuip(29,4,1)
		SetQuip(29,6,1)

		"\"What happened is, I'd like to say, just a misunderstanding! Why, my soul was a-flutter and a-fizz, there was
		one particularly hateful day, and then a terrible diversionary landing. But now it seems, hidden around, is
		the key to pick my lock... but I don't quite think you can do it, you miserable fucking cock.\""
		}

	case 2:{
		SetQuip(29,2,0)
		"The mouth says nothing in reply. I know that it 'heard' me, too, as it did not quiver
		even slightly while I was speaking to it."
		}

	case 3: 
		{
		SetQuip(29,1,0)
		SetQuip(29,2,0)
		SetQuip(29,3,0)
		SetQuip(29,4,1)
		SetQuip(29,6,1)
		"\"A story, you say? Why, I can do that, as you pause from your troubles before you step up to bat. Oh, might they be demons and 
		might they be bots? You'll never find out, you collection of twats. You -- \"\n"

		"\"Hey!\" I was totally not expecting to be insulted by the filthy thing, so blurting out an exclamation
		is all I can muster quickly.\n"

		"The mouth refuses to say anything else after being so rudely interrupted."		
		}

	case 4: 
		{
		SetQuip(29,4,0)
		SetQuip(29,6,0)

		SetQuip(29,7,1)
		SetQuip(29,8,1)

		"\"I think you heard me, Duffinkowski; heard me rather well. I'd sooner 
		wait for Ragnar\:ok than for your mind to gel. You're trapped 
		here, Doofernowski, drinkin', sleepin', eatin'... and I'll wink and 
		sneeze upon your release, you sniveling dumbfuck cretin.\""
		}

	case 6:
		{
		SetQuip(29,4,0)
		SetQuip(29,6,0)

		SetQuip(29,7,1)
		SetQuip(29,8,1)
	
		"\"I think you heard me, Duffinkowski; heard me rather well. I'd sooner wait for Ragnar\:ok than for your mind
		to gel. You're trapped here, Dooferpogski, drinkin', sleepin', eatin'...
 		and I'll wink and sneeze upon your release, you sniveling dumbfuck cretin.\""
		}


	case 7: 
		{
		SetQuip(29,7,0)
		SetQuip(29,8,0)
	
		SetQuip(29,10,1)
		SetQuip(29,11,1)
		SetQuip(29,12,1)
		SetQuip(29,13,1)

		"\"Oh, I'll have a go, just have no fear -- \"\n"

		"I'm fed up with the mouth's nonsense. I cut it off from going any further.\n"

		"\"Just shut that wretched little hole before I cover you with a custom balm milked from your 
		disgusting, available organs, bitchlips. I need help and answers and I'm wholly not
		interested in even remotely taking abuse from some matted, chudlike non-life hung up
		on a wall.\"\n"

		"A sudden unease creeps over me. What am I \Idoing\i with my life? This is a terrible 
		time for reflection, and I try to fight it off. Audrey starts to say something, like how lips 
		aren't officially organs or something equally helpful, but I ignore the interruption and 
		continue. \"You don't want to be in the Mall any more than I do. Help me out.\"\n"

		"Nothing happens for at least fifteen seconds. I get ready to leave before the lips purse. Finally.\n"

		"\"How?\" it says, at last."
		}

	case 8:
		{
		SetQuip(29,7,0)
		SetQuip(29,8,0)

		SetQuip(29,10,1)
		SetQuip(29,11,1)
		SetQuip(29,12,1)
		SetQuip(29,13,1)


		"The mouth smiles at my complete pussification.\n"

		"\"You know what?\" I say. \"Scratch that. I -- \"\n"

		"\"Oh! So sorry! So sorry I must say!\" The mouth's grin is borderline Chesire.\n"

		"\"Well, right,\" I continue. \"I -- \"\n"

		"\"Please! Do go. Do go on!\" exclaims the mouth.\n"

		"\"Fantastic,\" I say. \"Of all the creatures I have met so far tonight, you're easily the most annoying
		of them. Who just starts interrupting people? Is that wicked or something? Is there some sin I am not 
		picking up on? I don't even remember you from within the back of my mind or days spent crowded over some
		Dungeon Master's guide. You can't possibly enjoy this mockery of existence -- why don't you tell me
		how to get the hell out of here so we can both get some much needed rest?\""
		
		"The mouth considers it for a while and then finally breaks off into a single query.\n"

		"\"How?\" it asks."
		}	

	case 10:
		{
		SetQuip(29,10,0)
		"The mouth is suddenly all serious.\n"

		"\"'Tis a lich of the highest order. A demon burned and black. What was once ambition came to complete fruition and now
		it's looking for some souls to sack. A victim of a vicious murder. A devil with the ladies. Thirty thousand years to
		anoint some fears on those who let him out from Hades.\"\n"

		"The mouth's lips curl in just a bit of a smile. I guess it's pretty happy with itself. Having the advantage on someone
		has to be like the best thing ever if you're just a pair of lips, I guess."
		}

	case 11: 
		{
		SetQuip(29,11,0)

		"The mouth's expression turns to a frown.\n"

		"\"I won't be of any help with that, my dear. Just buck up, keep your chin up, try to avoid the ill-conceived
		fuck up and be sure to have no fear.\""
		}

	case 12
		{
		SetQuip(29,12,0)
		"\"North, then west then west again... and west until you can't. Eyes downcast at all who catch them, and ignore
		every rambling rant. North by west, squooshed and cramped together, like a thousand teeming beasts in flood, 
		regulate and improvise and don't neglect yon blood.\""
		}

	case 13
		{
		SetQuip(29,13,0)

		"The mouth frowns. \"Just play your part, flip through the art and keep being so fatalistic and wry, 
		while seeing if you can watch something other than your life so completely pass you by.\"\n"

		"\"Oh,\" I say. I scrunch up my face at it, trying to give him the non-verbal equivalent of '?????'"
		}


	}

}

!!!!!!!!!!!!!!!!!!!!!!!!

resource "mall"
{

! Graphics

	"c:\games\text\ndrift\jpg\picline01.jpg"
	"c:\games\text\ndrift\jpg\picline02.jpg"
	"c:\games\text\ndrift\jpg\picline03.jpg"
	"c:\games\text\ndrift\jpg\picline04.jpg"
	"c:\games\text\ndrift\jpg\picline05.jpg"
	"c:\games\text\ndrift\jpg\picline06.jpg"

	"c:\games\text\ndrift\jpg\pause01.jpg"
	
	"c:\games\text\ndrift\jpg\ndrift-title01.jpg"
	"c:\games\text\ndrift\jpg\ndrift-title02.jpg"
	"c:\games\text\ndrift\jpg\ndrift-title03.jpg"
	"c:\games\text\ndrift\jpg\ndrift-title04.jpg"
	"c:\games\text\ndrift\jpg\ndrift-title05.jpg"
	"c:\games\text\ndrift\jpg\ndrift-title06.jpg"

	"c:\games\text\ndrift\jpg\version.jpg"

	"c:\games\text\ndrift\jpg\king-gibs03.jpg"

! Characters

	"c:\games\text\ndrift\jpg\duffy01.jpg"
	"c:\games\text\ndrift\jpg\duffy02.jpg"
	"c:\games\text\ndrift\jpg\duffy06.jpg"
	"c:\games\text\ndrift\jpg\duffy08.jpg"

	"c:\games\text\ndrift\jpg\duffy_wraith01.jpg"


	"c:\games\text\ndrift\jpg\audrey04.jpg"
	"c:\games\text\ndrift\jpg\audrey05.jpg"
	"c:\games\text\ndrift\jpg\gibs04.jpg"
	"c:\games\text\ndrift\jpg\gibs05.jpg"
	"c:\games\text\ndrift\jpg\casey02.jpg"
	"c:\games\text\ndrift\jpg\casey03.jpg"


	"c:\games\text\ndrift\jpg\criswell01.jpg"
	"c:\games\text\ndrift\jpg\ben01.jpg"
	"c:\games\text\ndrift\jpg\ender02.jpg"
	"c:\games\text\ndrift\jpg\ghost01.jpg"
	"c:\games\text\ndrift\jpg\ghost02.jpg"
	"c:\games\text\ndrift\jpg\jeff01.jpg"
	"c:\games\text\ndrift\jpg\leary01.jpg"
	"c:\games\text\ndrift\jpg\pang01.jpg"
	"c:\games\text\ndrift\jpg\trott01.jpg"
	"c:\games\text\ndrift\jpg\trott02.jpg"

	"c:\games\text\ndrift\jpg\skeleton01.jpg"
	"c:\games\text\ndrift\jpg\ghoul03.jpg"
	"c:\games\text\ndrift\jpg\ghast01.jpg"
	"c:\games\text\ndrift\jpg\mummy01.jpg"
	"c:\games\text\ndrift\jpg\nurse01.jpg"
	"c:\games\text\ndrift\jpg\shadow01.jpg"
	"c:\games\text\ndrift\jpg\spectre01.jpg"
	"c:\games\text\ndrift\jpg\vision01.jpg"
	"c:\games\text\ndrift\jpg\vision02.jpg"
	"c:\games\text\ndrift\jpg\revenant.jpg"
!	"c:\games\text\ndrift\jpg\poltergeist01.jpg"
	"c:\games\text\ndrift\jpg\vampire01.jpg"
	"c:\games\text\ndrift\jpg\wraith01.jpg"
	"c:\games\text\ndrift\jpg\zombie01.jpg"

!	"c:\games\text\ndrift\jpg\recchi.jpg"


! Objects
	"c:\games\text\ndrift\jpg\blank_object01.jpg"



! Locations

	"c:\games\text\ndrift\jpg\academy_video01.jpg"
	"c:\games\text\ndrift\jpg\academy_video02.jpg"
	"c:\games\text\ndrift\jpg\academy_video03.jpg"
	"c:\games\text\ndrift\jpg\academy_video04.jpg"
	"c:\games\text\ndrift\jpg\ender04.jpg"
	"c:\games\text\ndrift\jpg\academy_video05.jpg"
	"c:\games\text\ndrift\jpg\academy_video06.jpg"

	
	"c:\games\text\ndrift\jpg\duffy_bedroom01.jpg"
	"c:\games\text\ndrift\jpg\duffy_bedroom02.jpg"
	"c:\games\text\ndrift\jpg\duffy_bedroom03.jpg"
	"c:\games\text\ndrift\jpg\duffy_bedroom04.jpg"
	"c:\games\text\ndrift\jpg\duffy_bedroom05.jpg"

	"c:\games\text\ndrift\jpg\mallstore01.jpg"

	"c:\games\text\ndrift\jpg\bead_store01.jpg"		! Default Bead Store graphic
!	"c:\games\text\ndrift\jpg\bead_store02.jpg"		! Sydney in the store
!	"c:\games\text\ndrift\jpg\bead_store03.jpg"		! Casey with her hands out
!	"c:\games\text\ndrift\jpg\bead_store04.jpg"		! Sydney with her hands out
!	"c:\games\text\ndrift\jpg\bead_store05.jpg"		! Covered in flash and smoke! 
	"c:\games\text\ndrift\jpg\bead_store06.jpg"		! Audrey, Duffy on ground? (That was incredible says Casey)
	"c:\games\text\ndrift\jpg\bead_store07.jpg"		! Sydney unconscious
	"c:\games\text\ndrift\jpg\bead_store08.jpg"		! Sydney, eyes open
	"c:\games\text\ndrift\jpg\bead_store09.jpg"		! Skeleton arrives
	"c:\games\text\ndrift\jpg\bead_store10.jpg"		! Sydney as the ghost #1
!	"c:\games\text\ndrift\jpg\bead_store11.jpg"		! Sydney as the ghost #2 (when Duffy returns for rest of game)



	"c:\games\text\ndrift\jpg\backoffice01.jpg"		
	"c:\games\text\ndrift\jpg\backoffice02.jpg"		
	"c:\games\text\ndrift\jpg\backoffice_hall1.jpg"		
	"c:\games\text\ndrift\jpg\backoffice_hall2.jpg"		

	"c:\games\text\ndrift\jpg\backoffice_hall3_01.jpg"	
	"c:\games\text\ndrift\jpg\backoffice_hall3_02.jpg"	
	"c:\games\text\ndrift\jpg\backoffice_hall3_03.jpg"	
	"c:\games\text\ndrift\jpg\backoffice_hall3_04.jpg"	

	"c:\games\text\ndrift\jpg\dayna02.jpg"			! Not her, but a flashback scene to her			

	"c:\games\text\ndrift\jpg\academy_outside01.jpg"

	"c:\games\text\ndrift\jpg\tv_room01.jpg"
	"c:\games\text\ndrift\jpg\tv_room02.jpg"
	"c:\games\text\ndrift\jpg\tv_room03.jpg"
	"c:\games\text\ndrift\jpg\movie_night_02.jpg"
	"c:\games\text\ndrift\jpg\movie_night_03.jpg"
	"c:\games\text\ndrift\jpg\movie_night_04.jpg"
	"c:\games\text\ndrift\jpg\movie_night_05.jpg"
	"c:\games\text\ndrift\jpg\movie_night_06.jpg"

	"c:\games\text\ndrift\jpg\parking_lot01.jpg"
	"c:\games\text\ndrift\jpg\parking_lot02.jpg"

	"c:\games\text\ndrift\jpg\jewelry_store01.jpg"
	"c:\games\text\ndrift\jpg\jewelry_store02.jpg"
	"c:\games\text\ndrift\jpg\jewelry_store03.jpg"
	"c:\games\text\ndrift\jpg\jewelry_store04.jpg"
	"c:\games\text\ndrift\jpg\jewelry_store_wraith.jpg"

	"c:\games\text\ndrift\jpg\corridor0401.jpg"
	"c:\games\text\ndrift\jpg\corridor0502.jpg"
	"c:\games\text\ndrift\jpg\corridor0601.jpg"
	"c:\games\text\ndrift\jpg\corridor0701.jpg"

	"c:\games\text\ndrift\jpg\ghast_attack01.jpg"
	"c:\games\text\ndrift\jpg\ghast_attack02.jpg"
	"c:\games\text\ndrift\jpg\novelshop01.jpg"
	"c:\games\text\ndrift\jpg\crucify02.jpg"
	"c:\games\text\ndrift\jpg\crucify03.jpg"


	"c:\games\text\ndrift\jpg\food_court2_01.jpg"
	"c:\games\text\ndrift\jpg\food_court2_02.jpg"
	"c:\games\text\ndrift\jpg\food_court2_03.jpg"
	"c:\games\text\ndrift\jpg\food_court2_04.jpg"
	"c:\games\text\ndrift\jpg\food_court2_05.jpg"
	"c:\games\text\ndrift\jpg\food_court_casey01.jpg"


	"c:\games\text\ndrift\jpg\nutrition_basement01.jpg"
	"c:\games\text\ndrift\jpg\nutrition_basement02.jpg"
	"c:\games\text\ndrift\jpg\nutrition_basement0201.jpg"
	"c:\games\text\ndrift\jpg\nutrition_basement03.jpg"
	"c:\games\text\ndrift\jpg\nutrition_basement04.jpg"
	"c:\games\text\ndrift\jpg\nutrition_basement05.jpg"

	"c:\games\text\ndrift\jpg\partystore01.jpg"

	"c:\games\text\ndrift\jpg\securityroom01.jpg"
	"c:\games\text\ndrift\jpg\security_nurse01.jpg"
	"c:\games\text\ndrift\jpg\security_nurse02.jpg"

	"c:\games\text\ndrift\jpg\corridor0101.jpg"
	"c:\games\text\ndrift\jpg\corridor0102.jpg"
	"c:\games\text\ndrift\jpg\corridor0103.jpg"

	"c:\games\text\ndrift\jpg\corridor0201.jpg"
	"c:\games\text\ndrift\jpg\corridor0202.jpg"
	"c:\games\text\ndrift\jpg\corridor0203.jpg"
	"c:\games\text\ndrift\jpg\corridor0204.jpg"

	"c:\games\text\ndrift\jpg\corridor0301.jpg"
	"c:\games\text\ndrift\jpg\corridor0302.jpg"
	"c:\games\text\ndrift\jpg\corridor0303.jpg"
	"c:\games\text\ndrift\jpg\corridor0304.jpg"

	"c:\games\text\ndrift\jpg\poster_store01.jpg"
	"c:\games\text\ndrift\jpg\magicmouth01.jpg"
	"c:\games\text\ndrift\jpg\sunglasses01.jpg"

	"c:\games\text\ndrift\jpg\food_court01.jpg"
	"c:\games\text\ndrift\jpg\food_court02.jpg"


	"c:\games\text\ndrift\jpg\sporting01.jpg"
	"c:\games\text\ndrift\jpg\sporting02.jpg"
 

	"c:\games\text\ndrift\jpg\outside_benji_daylight02.jpg"
	"c:\games\text\ndrift\jpg\misc_corridor01.jpg"

	"c:\games\text\ndrift\jpg\lastscene01.jpg"
	"c:\games\text\ndrift\jpg\lastscene02.jpg"

	"c:\games\text\ndrift\jpg\credits-audrey01.jpg"
	"c:\games\text\ndrift\jpg\credits-duffy01.jpg"
	"c:\games\text\ndrift\jpg\credits-gibs01.jpg"
	"c:\games\text\ndrift\jpg\credits-casey01.jpg"
	"c:\games\text\ndrift\jpg\credits-trott01.jpg"
	"c:\games\text\ndrift\jpg\credits-sydney01.jpg"
	"c:\games\text\ndrift\jpg\credits-robb01.jpg"
	"c:\games\text\ndrift\jpg\credits-endgame01.jpg"






!Movies

}



resource "ndmusic"
{

! SoundAnchor
! Chapter One Intro:	Track01
! Chapter Two Intro:	Casio
! Chapter Three Intro:	Morose Encounters
! Chapter Four Intro:	Mother Plucker
! Chapter Five Intro:   Amber Tide (maybe)

! Fix the computer:	Stoli
! Jewelry Store:	LikeThis--Wooooo.mp3
! Corridor6:		Zombie Crap 2
! Final Fight with Syd: Blued
! Last bit of text:	Funeral of Filth





	"c:\games\text\ndrift\mp3\Pseudo_Band_-_Track_01.mp3"
	"c:\games\text\ndrift\mp3\casio.mp3"
	"c:\games\text\ndrift\mp3\MoroseEncounters.mp3"
	"c:\games\text\ndrift\mp3\motherplucker.mp3"
	"c:\games\text\ndrift\mp3\ambertide.mp3"


	"c:\games\text\ndrift\mp3\Stoli.mp3"
	"c:\games\text\ndrift\mp3\LikeThis--Wooooo.mp3"
	"c:\games\text\ndrift\mp3\zombiecrap2.mp3"
	"c:\games\text\ndrift\mp3\blued.mp3"
	"c:\games\text\ndrift\mp3\funeral.mp3"


	"c:\games\text\ndrift\mp3\castlethunder.wav"
	"c:\games\text\ndrift\mp3\yeargh.wav"	
	"c:\games\text\ndrift\mp3\knocking.wav"	
	"c:\games\text\ndrift\mp3\explosion.wav"	
	"c:\games\text\ndrift\mp3\crash.wav"	


}



#include "epilogue.hug"			! Story's Epilogue 

